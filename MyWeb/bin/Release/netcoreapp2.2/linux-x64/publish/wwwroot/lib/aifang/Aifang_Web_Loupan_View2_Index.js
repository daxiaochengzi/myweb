var APF={log:function(a){}};APF.Namespace={register:function(d){var c=d.split(".");var a=window;for(var b=0;b<c.length;b++){if(typeof a[c[b]]=="undefined"){a[c[b]]=new Object()}a=a[c[b]]}}};APF.Utils={getWindowSize:function(){var b=0,a=0;if(typeof(window.innerWidth)=="number"){b=window.innerWidth;a=window.innerHeight}else{if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){b=document.documentElement.clientWidth;a=document.documentElement.clientHeight}else{if(document.body&&(document.body.clientWidth||document.body.clientHeight)){b=document.body.clientWidth;a=document.body.clientHeight}}}return{width:b,height:a}},getScroll:function(){var b=0,a=0;if(typeof(window.pageYOffset)=="number"){a=window.pageYOffset;b=window.pageXOffset}else{if(document.body&&(document.body.scrollLeft||document.body.scrollTop)){a=document.body.scrollTop;b=document.body.scrollLeft}else{if(document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)){a=document.documentElement.scrollTop;b=document.documentElement.scrollLeft}}}return{left:b,top:a}},setCookie:function(c,e,a,h,d,g){var b=new Date();b.setTime(b.getTime());if(a){a=a*1000*60*60*24}var f=new Date(b.getTime()+(a));document.cookie=c+"="+escape(e)+((a)?";expires="+f.toGMTString():"")+((h)?";path="+h:"")+((d)?";domain="+d:"")+((g)?";secure":"")},getCookie:function(a){var f=document.cookie.split(";");var b="";var d="";var e="";var c=false;for(i=0;i<f.length;i++){b=f[i].split("=");d=b[0].replace(/^\s+|\s+$/g,"");if(d==a){c=true;if(b.length>1){e=unescape(b[1].replace(/^\s+|\s+$/g,""))}return e;break}b=null;d=""}if(!c){return null}},deleteCookie:function(a,c,b){if(this.getCookie(a)){document.cookie=a+"="+((c)?";path="+c:"")+((b)?";domain="+b:"")+";expires=Thu, 01-Jan-1970 00:00:01 GMT"}},setScrollTop:function(a){if(document.body){document.body.scrollTop=a;if(document.body.scrollTop==0){if(document.documentElement){document.documentElement.scrollTop=a}}}else{if(document.documentElement){document.documentElement.scrollTop=a}}},getScrollTop:function(){return document.body?document.body.scrollTop||document.documentElement.scrollTop:document.documentElement.scrollTop},gotoScrollTop:function(f,d){var b=APF.Utils.getScrollTop(),h=0,g=0;var d=d||1;var f=f||0;var a=b>f?1:0;(function(){b=APF.Utils.getScrollTop();h=a?b-f:f-b;g=a?b-h/15*d:b+1+h/15*d;APF.Utils.setScrollTop(g);if(h<=0||b==APF.Utils.getScrollTop()){return}setTimeout(arguments.callee,10)})()}};(function($){var _aui={};_aui.nameSpace=function(ns){var nsParts=ns.split(".");var root=window;for(var i=0;i<nsParts.length;i++){if(typeof root[nsParts[i]]=="undefined"){root[nsParts[i]]={}}root=root[nsParts[i]]}};_aui.Config={devLogURL:"http://www.fang.anjuke.test/ts.html?",logURL:"http://www.fang.anjuke.com/ts.html?",isDev:/dev|test/.test(document.domain),blackList:["BdPlayer","baiduboxapphomepagetag"]};function isblack(str){var i,reg,length,blackList=_aui.Config.blackList;if(typeof str!=="string"){return true}for(i=0,length=blackList.length;i<length;i++){reg=new RegExp(blackList[i],"g");if(reg.test(str)){return true}}}function log(params){var errorinfo="tp=error&site=kfs&msg=",key,url,arr=[],image,msg;if(typeof params==="string"){msg=params}if(typeof params==="object"){for(key in params){if(params.hasOwnProperty(key)){arr.push(key+":"+encodeURIComponent(params[key]))}}msg=arr.join(",")}if(isblack(msg)){return false}image=new Image();if(_aui.Config.isDev){url=_aui.Config.devLogURL+errorinfo+msg}else{url=_aui.Config.logURL+errorinfo+msg}image.src=url}window.onerror=function(msg,url,line){log({message:msg,url:url,line:line})};_aui.inherit=function(my,classParent,args){classParent.apply(my,args||[]);$.extend(my.constructor.prototype,classParent.prototype)};_aui.Observer=function(){this._ob={}};_aui.Observer.prototype.on=function(eventNames,callback){var _events=eventNames.split(" ");var _eventKeys={};for(var i=0;i<_events.length;i++){if(!this._ob[_events[i]]){this._ob[_events[i]]=[]}var _key=this._ob[_events[i]].push(callback);_eventKeys[_events[i]]=_key-1}return _eventKeys};_aui.Observer.prototype.off=function(eventName,keys){if(!!keys&&!$.isArray(keys)){keys=[keys]}if(this._ob[eventName]){for(var i=0;i<this._ob[eventName].length;i++){if(!keys||$.inArray(i,keys)){this._ob[eventName][i]=undefined}}}};_aui.Observer.prototype.trigger=function(eventName,args){var r;if(!this._ob[eventName]){return r}var _arg=args||[];for(var i=0;this._ob[eventName]&&i<this._ob[eventName].length;i++){if(!this._ob[eventName][i]){continue}var _r=this._ob[eventName][i].apply(this,_arg);r=(r===false)?r:_r}return r};_aui.Observer.prototype.one=function(eventName,callback){var self=this;var key=self.on(eventName,function(){callback.apply(this,arguments);self.off(eventName,key)})};_aui.render=function(tpl,data,op){var daName=[],daVal=[],efn=[],_fnBuf,_op=$.extend({},_aui.render._options,op||{});for(var i in data){daName.push(i);daVal.push("data."+i)}var _tp=tpl.replace(new RegExp(_op.open,"g"),_op.open+_op.val);_fnBuf=_tp.split(new RegExp(_op.open+"|"+_op.close,"g"));for(var i=0;i<_fnBuf.length;i++){if(new RegExp("^"+_op.val+_op.exp).test(_fnBuf[i])){_fnBuf[i]=_fnBuf[i].replace(new RegExp("^"+_op.val+_op.exp),"")}else{if(_fnBuf[i].length>0){if(new RegExp("^"+_op.val).test(_fnBuf[i])){_fnBuf[i]="_buf.push("+_fnBuf[i].replace(new RegExp("^"+_op.val),"")+");"}else{_fnBuf[i]="_buf.push('"+_fnBuf[i]+"');"}}}}efn.push("(function(");efn.push(daName.join(","));efn.push("){");efn.push("var _buf = [];");efn.push(_fnBuf.join(""));efn.push('return _buf.join("")');efn.push("})(");efn.push(daVal.join(","));efn.push(")");return eval(efn.join(""))};_aui.render._options={open:"{%",close:"%}",exp:">",val:"="};_aui.nameSpace("XF");window.XF=_aui})(jQuery);(function($){XF.nameSpace("XF.Vars");XF.nameSpace("XF.Validate");XF.nameSpace("XF.WindowsOpen");XF.Validate.phoneMobile=function(data){return/^1[3|4|5|7|8]\d{9}$/.test(data)};XF.Validate.phoneArea=function(data){return/^0\d{2,3}$/.test(data)};XF.Validate.phonePlane=function(data){return/^[2-9]\d{6,7}$/.test(data)};XF.Validate.email=function(data){return/^(\w)+(\.\w+)*@(\w)+((\.\w{2,3}){1,3})$/.test(data)};XF.Validate.smsCode=function(data){return/^\d{4}$/.test(data)};XF.WindowsOpen.redirect=function(url){if(!
/*@cc_on!@*/
0){window.open(url,"_blank")}else{var a=document.createElement("a");a.href=url;a.target="_blank";document.body.appendChild(a);a.click()}}})(jQuery);XF.nameSpace("XF.Soj.send");XF.nameSpace("XF.Soj.param");(function(a){XF.Soj.send=function(f,h,b){var e=a.extend({},{Site:"anjuke-npv"},h||{});var c=new SiteTracker();for(var d in e){c["set"+d](e[d])}var g=function(){var j="";try{j=window.top.document.referrer}catch(l){if(window.parent){try{j=window.parent.document.referrer}catch(k){j=""}}}if(j===""){j=document.referrer}return j};c.setReferer(g());c.setCustomParam(f);c.track(b)};a("a[soj]").each(function(g,d){var f=a(d),b=f.attr("href")||"",c=encodeURIComponent(f.attr("soj"));if(/from=/.test(b)){return}b=b.split("#");var e=(/\?/.test(b[0]))?"&from="+c:"?from="+c;if(b.length>1){e+="#";f.attr("href",b.join(e))}else{f.attr("href",b[0]+e)}})})(jQuery);function init_data_sojcommon(a){if(typeof a!=="undefined"){jQuery("*[data-sojcommon]").on("click.sendsoj",function(){var b="{from:"+jQuery(this).data("sojcommon")+"}";XF.Soj.send(b,a)})}}(function(a){XF.nameSpace("XF.Login");XF.Login=function(c){var b=this;b.op=a.extend({loginST:"",baseUrl:""},c);b._init()};XF.Login.prototype._init=function(){var b=this,f=b.op,d=a(f.loginST);f.unLogin=d.find(".site-user");f.afLogin=d.find(".site-user-login");var e=f.unLogin.find(".drop-user"),c=f.unLogin.find(".site-userlist");e.on({"mouseenter.login":function(){c.show()},"mouseleave.login":function(){c.hide()}});b.updateLogin()};XF.Login.prototype.updateLogin=function(){var b=this,d=b.op,c;a.ajax({type:"get",url:d.baseUrl+"ajax/checklogin/?r="+Math.random(),dataType:"jsonp",jsonp:"callback",success:function(h){XF.Vars.userid=h.common.userid;c=APF.Utils.getCookie("aQQ_ajkauthinfos");if(!c){return false}var k=h.common.usertype,j=h.common.totalUnreadCount||false,e;if(k==1||k==2||k==4||k==8){e={userName:h.common.usernamestr.slice(0,8)||"",exit:h.lefturl.logouturl||"javascript:",msgUrl:h.lefturl.pmurl||"javascript:",msgNum:j>99?"99+":j,myanjuke:false,developUrl:false};e.userName.length==8&&(e.userName+="...");if(k==2){e=a.extend(e,{myanjuke:h.righturl.myanjuke||false,developUrl:h.common.developUrl||false})}if(k==1){e=a.extend(e,{my_favorite:h.righturl.links.my_favorite||"javascript:",view_history:h.righturl.links.view_history||"javascript:",subscription_management:h.righturl.links.subscription_management||"javascript:",my_ask:h.righturl.links.my_ask||"javascript:",my_ugc:h.righturl.links.my_ugc||"javascript:",publish_rent:h.righturl.links.publish_sell?h.righturl.links.publish_sell+"?from=i_dhfa":"javascript:",publish_sell:h.righturl.links.publish_sell?h.righturl.links.publish_sell+"?from=i_dhfa":"javascript:"});d.afLogin.html(b._loginUserTpl(e));var f=d.afLogin.find(".drop-myajk"),g=d.afLogin.find(".site-myajk-list");f.off("mouseenter.login mouseleave.login").on({"mouseenter.login":function(){g.show()},"mouseleave.login":function(){g.hide()}})}else{d.afLogin.html(b._loginTpl(e))}d.unLogin.remove()}}})};XF.Login.prototype._loginTpl=function(c){var b="";b+='<li><span class="user-name">您好，{% userName %}</span><a href="{% exit %}" class="user-out"><em>[</em>&nbsp;退出&nbsp;<em>]</em></a>';b+='{%> if(msgNum){ %}<a href="{% msgUrl %}" target="_blank">消息<i class="user-mail">{% msgNum %}</i></a></li>{%> } %}';b+='{%> if(myanjuke){ %}<li><span class="line">|</span><a href="{% myanjuke %}?from=loupan_index_head" class="u" target="_blank">中国网络经纪人</a></li>{%> } %}';b+='{%> if(developUrl){ %}<li><span class="line">|</span><a href="{% developUrl %}?from=loupan_index_head" class="u" target="_blank">新房分销平台</a></li>{%> } %}';return XF.render(b,c)};XF.Login.prototype._loginUserTpl=function(c){var b="";b+='<li><i class="hicon hicon-user"></i>&nbsp;<span class="user-name">您好，{% userName %}</span><span class="line">|</span></li>';b+='<li class="drop-myajk"><a href="javascript:"><span>我的安居客</span>&nbsp;<i class="hicon hicon-trig"></i></a>';b+='<div class="site-myajk-list" style="display: none;">';b+='<a target="_blank" href="{% my_favorite %}">我的收藏</a>';b+='<a target="_blank" href="{% view_history %}">浏览历史</a>';b+='<a target="_blank" href="{% subscription_management %}">订阅管理</a>';b+='<a target="_blank" href="{% my_ask %}">我的问答</a>';b+='<a target="_blank" href="{% msgUrl %}">我的消息{%> if(msgNum){ %}<i class="user-mail">{% msgNum %}</i>{%> } %}</a>';b+='<a target="_blank" href="{% my_ugc %}">我的点评<i class="user-mail">new</i></a>';b+='<i class="hline"></i>';b+='<a target="_blank" href="{% publish_rent %}">发布出租</a>';b+='<a target="_blank" href="{% publish_sell %}">发布出售</a>';b+='<i class="hline"></i>';b+='<a target="_blank" href="{% exit %}">退出</a></div></li>';b+='<li><span class="line">|</span><span></span></li>';return XF.render(b,c)}})(jQuery);(function(a){XF.nameSpace("XF.Search");XF.Search=function(c){var b=this;XF.inherit(b,XF.Observer);b.op=a.extend({},XF.Search._default,c);b._init()};XF.Search._default={searchST:"",formST:"",inputST:"",listST:"",hoverClass:"hover",initVal:"",url:"",t:null,c:null,n:8};XF.Search.prototype._init=function(){var b=this,c=b.op;c.search=a(c.searchST);c.form=c.search.find(c.formST);c.input=c.search.find(c.inputST);c.list=c.search.find(c.listST);c.hideTimer;c.input.attr("placeholder",c.initVal);!a.trim(c.input.val())&&c.input.attr("value",c.initVal);c.input.on({"focus.search.init":function(){a.trim(a(this).val())==c.initVal&&a(this).val("")},"blur.search.init":function(){a.trim(a(this).val())==""&&a(this).val(c.initVal)}});b.start()};XF.Search.prototype.start=function(){var b=this,c=b.op;c.input.off("keyup.search.start focus.search.start blur.search.start");c.input.on({"keyup.search.start":function(f){var e=a.trim(c.input.val()),d=f.which;if(d==38){c.item&&b.updown(c.item.index(c.item.filter("."+c.hoverClass)),true)}else{if(d==40){c.item&&b.updown(c.item.index(c.item.filter("."+c.hoverClass)),false)}else{if(e!=""){c.timer&&clearTimeout(c.timer);c.timer=setTimeout(function(){b.change(e)},200)}else{b.hide();c.list.html("")}}}},"focus.search.start":function(){var d=a.trim(c.input.val());d&&d!=c.initVal&&b.change(d)},"blur.search.start":function(){b.hide()}})};XF.Search.prototype.change=function(c){var b=this,d=b.op;a.ajax({type:"get",dataType:"jsonp",jsonp:"callback",url:d.url,data:{t:d.t,c:d.c,n:d.n,kw:c},success:function(g){var f="";if(g.length>2){g=g.replace(/["\[\]]/g,"").split(",");for(var e=0;e<g.length;e++){f+="<li>"+g[e]+"</li>"}d.list.html(f);d.item=d.list.find("li");d.item.on({mouseenter:function(){a(this).addClass(d.hoverClass).siblings().removeClass(d.hoverClass)},mouseleave:function(){a(this).removeClass(d.hoverClass)},click:function(){d.input.val(a(this).text());b.submit()}});b.show();clearTimeout(d.hideTimer)}else{b.hide()}}})};XF.Search.prototype.updown=function(d,f){var c=this,e=c.op,b=e.item.length;if(f){d=d<=0?b-1:d-1}else{d=d<0||d==b-1?0:d+1}e.item.eq(d).addClass(e.hoverClass).siblings().removeClass(e.hoverClass);e.input.val(e.item.eq(d).text())};XF.Search.prototype.stop=function(){var b=this,c=b.op;c.input.off("keyup.search.start focus.search.start blur.search.start");b.hide()};XF.Search.prototype.submit=function(){var b=this,c=b.op;c.form.submit()};XF.Search.prototype.show=function(){var b=this,c=b.op;c.list.fadeIn(100)};XF.Search.prototype.hide=function(){var b=this,c=b.op;c.timer&&clearTimeout(c.timer);c.hideTimer=setTimeout(function(){c.list.hide()},200)}})(jQuery);(function(a){XF.nameSpace("XF.HotSearch");XF.HotSearch=function(c){var b=this;XF.inherit(b,XF.Observer);b.op=a.extend({},XF.HotSearch._default,c);b._init()};XF.HotSearch._default={gSearch:null,hSearchST:"",hoverClass:""};XF.HotSearch.prototype._init=function(){var c=this,d=c.op,b=d.gSearch.op.input;d.hideTimer;d.hSearch=a(d.hSearchST);d.item=d.hSearch.find("li");d.hSearch.appendTo(d.gSearch.op.search);d.gSearch.stop();b.on({"keyup.hotsearch":function(g){var f=a.trim(b.val()),e=g.which;if(e==38){d.item&&c.updown(d.item.index(d.item.filter("."+d.hoverClass)),true)}else{if(e==40){d.item&&c.updown(d.item.index(d.item.filter("."+d.hoverClass)),false)}else{if(f!=""){c.hide();b.trigger("focus.search.start")}else{clearTimeout(d.hideTimer);c.show()}}}},"focus.hotsearch":function(){a.trim(b.val())==""&&c.show()},"blur.hotsearch":function(){c.hide()}});d.item.on({"mouseenter.hotsearch":function(){a(this).addClass(d.hoverClass).siblings().removeClass(d.hoverClass)},"mouseleave.hotsearch":function(){a(this).removeClass(d.hoverClass)},"click.hotsearch":function(){b.val(a(this).find(".lp-name").text());d.gSearch.submit()}})};XF.HotSearch.prototype.show=function(){var b=this,c=b.op;c.hSearch.fadeIn(100);c.gSearch.stop()};XF.HotSearch.prototype.hide=function(){var b=this,c=b.op;c.hideTimer=setTimeout(function(){c.hSearch.hide()},200);c.item.removeClass(c.hoverClass);c.gSearch.start()};XF.HotSearch.prototype.updown=function(e,g){var d=this,f=d.op,b=f.item.length;var c=f.gSearch.op.input;if(g){e=e<=0?b-1:e-1}else{e=e<0||e==b-1?0:e+1}f.item.eq(e).addClass(f.hoverClass).siblings().removeClass(f.hoverClass);c.val(f.item.eq(e).find(".lp-name").text())}})(jQuery);XF.nameSpace("XF.ImgLazyLoad");(function(b,a){a.DelayModular=function(d){var c=this;c.op={imgContainer:"",duration:200,attrName:"imglazyload-src"};b.extend(c.op,d||{});c.init();c.handleScroll()};a.DelayModular.prototype.init=function(){var c=this;c.imgs=b(c.op.imgContainer).find("img["+c.op.attrName+"]");c.timer=null;if(c.imgs.length){c.isDelayImages()}};a.DelayModular.prototype.handleScroll=function(){var c=this;if(c.imgs.length){b(window).on("scroll.allSite",function(){c.isDelayImages()})}};a.DelayModular.prototype.isDelayImages=function(){var c=this;if(c.timer){clearTimeout(c.timer)}c.timer=setTimeout(function(){c.imgs.each(function(f){var d=b(this);var l=b(window);var k=l.scrollTop();var j=l.height();var h=d.offset().top;var g=d.outerHeight();if((j>h-k)&&(k<h+g)){var e=d.attr("imglazyload-src");d.attr("src",e);d.removeAttr("imglazyload-src")}})},c.duration)}})(jQuery,XF.ImgLazyLoad);(function(a){XF.nameSpace("XF.CountDown");XF.CountDown=function(c){var b=this;b.op=a.extend({},XF.CountDown._default,c);b._init()};XF.CountDown._default={timerST:"",dayST:".time-day",hourST:".time-hour",minuteST:".time-minute",secondST:".time-second",endTime:null};XF.CountDown.prototype._init=function(){var c=this,h=c.op;var f=a(h.timerST),d=f.find(h.dayST),g=f.find(h.hourST),b=f.find(h.minuteST),e=f.find(h.secondST);h.interval=setInterval(function(){var o=h.endTime.getTime()-new Date().getTime();if(o>0){var k=parseInt(o/1000),l=Math.floor(k/(60*60*24)),j=Math.floor((k-l*24*60*60)/3600),n=Math.floor((k-l*24*60*60-j*3600)/60),m=Math.floor(k-l*24*60*60-j*3600-n*60);d.text(l<10?"0"+l:l);g.text(j<10?"0"+j:j);b.text(n<10?"0"+n:n);e.text(m<10?"0"+m:m)}else{clearInterval(h.interval);a(c).trigger("over")}},1000)}})(jQuery);(function(a){XF.nameSpace("XF.Modal");XF.Modal=function(c){var b=this;XF.inherit(b,XF.Observer);b.op=a.extend({},XF.Modal._default,c);b.op.ie6=/MSIE 6/.test(navigator.userAgent)};XF.Modal._default={modalClass:"",con:"",hd:"",title:"",bd:"",ft:"",width:560,height:"",pos:{top:undefined,left:undefined},mask:true,duration:200};XF.Modal.prototype._create=function(){var j=this,e=j.op;e.modal=a('<div class="xf-modal"></div>');e.modalMask=a('<div class="modal-mask"></div>');e.modalIfr=a('<iframe class="modal-ifr"></iframe>');e.modalCover=a('<div class="modal-cover"></div>');var g=a('<div class="shadow"></div>'),h=a('<a href="javascript:" class="close"></a>'),b=a('<div class="con"></div>').append(a(e.con).show()),d=a('<div class="hd"></div>').append(a(e.hd).show()),f=a('<div class="bd"></div>').append(a(e.bd).show()),c=a('<div class="ft"></div>').append(a(e.ft).show());!e.hd&&e.title&&d.html('<h3 class="title">'+e.title+"</h3>");e.con||a().add((e.hd||e.title)&&d).add(e.bd&&f).add(e.ft&&c).appendTo(b);b.add(h).appendTo(e.modal);e.modalClass&&e.modal.addClass(e.modalClass);b.css({width:e.width,height:e.height});e.modalCover.append(e.modal).appendTo("body");h.on("click.modal",function(){j.close()});var k=a(document).height();e.mask&&e.modalMask.css({height:k}).appendTo("body");e.ie6&&e.modalIfr.css({height:k}).appendTo("body")};XF.Modal.prototype.center=function(c,d){var j=this,f=j.op,g=c.outerWidth(),b=c.outerHeight(),e=a(window).height();if(f.ie6||b>e){a("html").css({overflow:"hidden"});f.modalCover.css({overflow:"auto"})}else{a("html").css({overflow:""});f.modalCover.css({overflow:"hidden"})}if(f.pos.top===undefined||f.pos.left===undefined){var k=-parseInt(g/2,10),h=-parseInt(b/2,10);if(b>e){h=-parseInt(e/2,10)}c.animate({"margin-top":h,"margin-left":k},d)}else{c.animate(f.pos,d)}};XF.Modal.prototype.open=function(){var b=this,e=b.op,d=window.undefined;function c(f){e.ie6&&e.modalCover.css({top:a(window).scrollTop()});b.center(e.modal,f)}if(a(b).trigger("openBefore")!==false){(e.modal===d)&&b._create();c(0);e.modalCover.add(e.modalMask).add(e.modalIfr).css({visibility:"visible"});a(window).off("resize.modal").on("resize.modal",function(){e.timer&&clearTimeout(e.timer);e.timer=setTimeout(function(){c(e.duration)},200)});a(b).trigger("openAfter")}};XF.Modal.prototype.close=function(){var b=this,c=b.op;if(a(b).trigger("closeBefore")!==false){if(c.modal!==undefined){c.modalCover.css({overflow:"hidden"}).add(c.modalMask).add(c.modalIfr).css({visibility:"hidden"});a("html").css({overflow:""});a(window).off("resize.modal");a(b).trigger("closeAfter")}}}})(jQuery);XF.nameSpace("XF.Tuan.SignUp");(function(a,b,c){c(document).ready(function(){if(window.is_show_signv2==0){return}c(".int-text").each(function(){var C=c.trim(c(this).attr("placeholder"));c(this).on({"focus.inttext":function(){var D=c.trim(c(this).val());D==C&&c(this).val("");c(this).addClass("int-focus")},"blur.inttext":function(){var D=c.trim(c(this).val());D==""&&c(this).val(C);c(this).removeClass("int-focus")}})});var e=c(".modal-group-bd-v2"),B=e.find(".purchase-info dt"),s=e.find(".check-box"),q=s.find("em");var d=new XF.Modal({modalClass:"modal-custom",title:"优惠报名",bd:e,width:"560"});var u=c(".modal-group-status");var h=new XF.Modal({modalClass:"modal-custom",title:"优惠报名",bd:u,width:"560",height:"400"});var f=c("[tuan-btn]"),v,w,x;var t=e.find(".tel-box .int-text"),g=e.find(".tel-box .com-msg"),j=g.find("span"),r=e.find(".btn-box .btn");var m={phone:c(".modal-group-bd-v2 .c-phone"),imgCode:c(".modal-group-bd-v2 .img-code-int"),smsCode:c(".modal-group-bd-v2 .sms-code-int"),msgBox:c(".modal-group-bd-v2 .msg-box"),msgText:c(".modal-group-bd-v2 .msg-box span"),isShow:c(".modal-group-bd-v2 .j-is-show"),refreshBtn:c(".modal-group-bd-v2 .refresh-btn"),verfiyBtn:c(".modal-group-bd-v2 .send-sms-btn")};var l=[],z={phone:{defaults:"请输入您的手机号码",empty:"手机号码不能为空！",format:"请正确输入手机号！"},code:{defaults:"请输入图片码",empty:"图片码不能为空",format:"图片码错误"},smscode:{defaults:"请输入短信验证码",empty:"短信验证码不能为空",format:"短信验证码错误"}};f.each(function(C){c(this).on("click",function(G){G.stopPropagation();x=c(this);var I=x.attr("data-soj");a.initSoj(I);a.sendSoj();if(b.tuanData.length==1){v=b.tuanData[0];var F=0}else{v=b.tuanData[C];var F=C}w=v.data;var H=w.fanli?'<span class="purchase-tuan-icon"><i>享</i><span>'+w.fanli_title+"</span></span>":"";B.html(w.loupan_name+"&nbsp;-&nbsp;<em>"+w.discount+"</em>"+H);var D=b.kftData[F];if(w.has_kft){s.show();s.find("input").prop("checked",true);s.find("input[name=kft_type]").val(D.kft_type);s.find("input[name=kft_id]").val(D.bind_id)}else{s.hide()}t.removeClass("int-err");g.hide();d.open();var E={guid:XF.Vars.guid};c.post("/vcode/image/",E,function(J){if(J.status==1){m.isShow.show()}else{m.isShow.hide()}},"json");p();m.phone.removeClass("int-err");m.imgCode.attr("placeholder",z.code.defaults);m.imgCode.val("");m.imgCode.removeClass("int-err");m.smsCode.attr("placeholder",z.smscode.defaults);m.smsCode.val("");m.smsCode.removeClass("int-err");m.msgBox.hide()})});l.phone=function(){var F=m.phone,E=c.trim(F.val()),C=m.msgBox.eq(0),D=m.msgText.eq(0);E=E==z.phone.defaults?"":E;if(E!=""&&!XF.Validate.phoneMobile(E)){C.show();F.addClass("int-err");D.html(z.phone.format);return false}else{if(E==""){C.show();F.addClass("int-err");D.html(z.phone.empty);return false}else{F.removeClass("int-err");C.hide();return true}}};l.imgCode=function(){var F=m.imgCode,E=c.trim(F.val()),C=m.msgBox.eq(1),D=m.msgText.eq(1);E=E==z.code.defaults?"":E;if(E!=""&&E.length!=4){C.show();F.addClass("int-err");D.html(z.code.format);return false}else{if(E==""){C.show();F.addClass("int-err");D.html(z.code.empty);return false}else{F.removeClass("int-err");C.hide();return true}}};l.smsCode=function(){var F=m.smsCode,E=c.trim(F.val()),C=m.msgBox.eq(2),D=m.msgText.eq(2);E=E==z.smscode.defaults?"":E;if(E!=""&&!XF.Validate.smsCode(E)){C.show();F.addClass("int-err");D.html(z.smscode.format);return false}else{if(E==""){C.show();F.addClass("int-err");D.html(z.smscode.empty);return false}else{F.removeClass("int-err");C.hide();return true}}};l.isShowCode=function(){if(m.isShow.is(":visible")){return l.imgCode()}else{return true}};function p(){var E=c.now(),C,D=m.refreshBtn.prev();C=D.attr("src").substr(0,D.attr("src").length-13)+E;D.attr("src",C)}function n(F,C,E){var D={phone:C,guid:XF.Vars.guid,type:2};if(m.isShow.is(":visible")){D.imagecode=c.trim(m.imgCode.val())}c.ajax({url:"/vcode/mobilecode/",type:"post",dataType:"json",data:D,success:function(H){var G,J,I,K;G=m.msgBox.eq(0),J=m.msgText.eq(0),I=m.msgBox.eq(1),K=m.msgText.eq(1);if(H.rst>0){k(F,E);G.hide();I.hide()}else{if(H.rst==-3){m.isShow.show();I.show();m.imgCode.addClass("int-err");K.html(H.msg)}else{if(m.isShow.is(":visible")){I.show();m.imgCode.addClass("int-err");K.html(H.msg)}else{G.show();msg.html(H.msg)}}}}})}function k(E,D){if(D==0){E.removeAttr("disabled");E.removeClass("f-getcode-dis");E.text("发送短信验证码");D=D;y()}else{E.attr("disabled","disabled");E.addClass("f-getcode-dis");E.text(D+"秒后重新发送");E.off("click.xfsend");D--;var C=setTimeout(function(){k(E,D)},1000)}}m.refreshBtn.on("click.xfrefresh",function(){p()});function y(){m.verfiyBtn.on("click.xfsend",function(){var C=c.trim(m.phone.val());if(l.phone()&&l.isShowCode()){n(c(this),C,60)}})}y();r.on("click",function(){a.getCurrentSoj().setPage(b.sojData.p+"_confirm_discount");a.getCurrentSoj().setPageName(b.sojData.pn+"_confirm_discount");a.sendSoj();var C=c.trim(m.phone.val());var M=c.trim(m.smsCode.val());var K=s.find("input").is(":visible")&&s.find("input").eq(0).is(":checked");var D=s.find("input[name=kft_type]").val();var F=s.find("input[name=kft_id]").val();var I=u.find(".purchase-tips").hide();if(l.phone()&&l.isShowCode()&&l.smsCode()){g.hide();var H=K?I.eq(0):I.eq(1);var J=K?1:0;var L=x.data("from");var G=c.trim(m.imgCode.val());var E={tid:v.tid,uphone:C,tuangou:(L?L:0),join_kft:J,line_id:0,kft_join_id:0,kft_type:D,bind_id:F,code:M,img_code:G};c.post("/aifang/web/loupan/ajax/tuangouV2/",E,function(O){var N,P;N=m.msgBox.eq(2),P=m.msgText.eq(2);if(O.status==0){H.show();a.getCurrentSoj().setPage(b.sojData.p+"_confirm_discount_ok");a.getCurrentSoj().setPageName(b.sojData.np+"_confirm_discount_ok");a.getCurrentSoj().setCustomParam(a.getCustomParam()+"tuangou_member_id="+O.tuangou_member_id);a.sendSoj()}else{if(O.error_code==b.joinErrCode.has){I.eq(2).show()}else{if(O.error_code==b.joinErrCode.over){I.eq(4).show()}else{I.eq(3).show()}}}if(O.error_code==b.joinErrCode.vcodeError){N.show();m.smsCode.addClass("int-err");P.text("短信验证码错误")}else{if(O.error_code==b.joinErrCode.vcodeExpired){N.show();m.smsCode.addClass("int-err");P.text("短信验证码过期")}else{d.close();h.open()}}},"json")}});a.sendSoj=function(){try{var C=a.getCurrentSoj();var E=function(){var F="";try{F=window.top.document.referrer}catch(H){if(window.parent){try{F=window.parent.document.referrer}catch(G){F=""}}}if(F===""){F=document.referrer}return F};C.setReferer(E());C.setNGuid("aQQ_ajkguid");C.track()}catch(D){}};var o,A;a.initSoj=function(C){o=new SiteTracker("anjuke-npv");o.setPage(b.sojData.p);o.setPageName(b.sojData.pn);var D='{"from": "'+C+'"}';o.setCustomParam(D);a.storeCustomParam(D)};a.getCurrentSoj=function(){return o};a.storeCustomParam=function(C){A=C};a.getCustomParam=function(){return A}})})(XF.Tuan.SignUp,XF.Vars,jQuery);XF.nameSpace("XF.Tuan.SignUp");(function(a,b,c){c(document).ready(function(){if(window.is_show_signv2==1){return}c(".int-text").each(function(){var A=c.trim(c(this).attr("placeholder"));c(this).on({"focus.inttext":function(){var B=c.trim(c(this).val());B==A&&c(this).val("");c(this).addClass("int-focus")},"blur.inttext":function(){var B=c.trim(c(this).val());B==""&&c(this).val(A);c(this).removeClass("int-focus")}})});function x(A){return/^\d{6}$/.test(A)}var e=c(".modal-group-bd"),z=e.find(".purchase-info dt"),p=e.find(".check-box"),n=p.find("em");var d=new XF.Modal({modalClass:"modal-custom",title:"优惠报名",bd:e,width:"560"});var s=c(".modal-group-status");var h=new XF.Modal({modalClass:"modal-custom",title:"优惠报名",bd:s,width:"560",height:"400"});var f=c("[tuan-btn]"),t,u,v;var q=e.find(".tel-box .int-text"),g=e.find(".tel-box .com-msg"),j=g.find("span"),o=e.find(".btn-box .btn"),r=e.find(".verify-box .int-text"),l=e.find(".verify-code");verfiyMsg=e.find(".verify-info .com-msg"),verfiyMsgCon=verfiyMsg.find("span"),f.each(function(A){c(this).on("click",function(D){D.stopPropagation();v=c(this);var F=v.attr("data-soj");a.initSoj(F);a.sendSoj();if(b.tuanData.length==1){t=b.tuanData[0];var C=0}else{t=b.tuanData[A];var C=A}u=t.data;var E=u.fanli?'<span class="purchase-tuan-icon"><i>享</i><span>'+u.fanli_title+"</span></span>":"";z.html(u.loupan_name+"&nbsp;-&nbsp;<em>"+u.discount+"</em>"+E);var B=b.kftData[C];if(u.has_kft){p.show();p.find("input").prop("checked",true);p.find("input[name=kft_type]").val(B.kft_type);p.find("input[name=kft_id]").val(B.bind_id)}else{p.hide()}q.removeClass("int-err");g.hide();d.open();l.hide()})});function k(D,C){if(C==0){D.removeClass("disabled");D.text("重新获取验证码");C=C;w()}else{D.addClass("disabled");D.off("click.getverfiy");D.text(C+"秒后重新获取");C--;var B=setTimeout(function(){k(D,C)},1000);if(!l.is(":visible")){var A=c.trim(r.val());clearTimeout(B);D.text("获取验证码");r.val("输入短信验证码");D.removeClass("disabled");w();verfiyMsg.hide()}}}function w(){c(".get-code-btn").on("click.getverfiy",function(){var C=c.trim(q.val());C=C=="请输入您的手机号码"?"":C;var D=p.find("input").is(":visible")&&p.find("input").is(":checked");var A=s.find(".purchase-tips").hide();C?j.text("手机格式错误!"):j.text("手机号码不能为空!");var B=c(this);if(XF.Validate.phoneMobile(C)){g.hide();c.post("/a/tuangou/code/",{phone:C},function(E){if(E.rst==-1){verfiyMsg.show();verfiyMsgCon.text(E.msg)}else{if(E.rst==-2){verfiyMsg.show();verfiyMsgCon.text(E.msg)}else{if(E.rst>0){k(B,30)}}}},"json")}})}w();o.on("click",function(){a.getCurrentSoj().setPage(b.sojData.p+"_confirm_discount");a.getCurrentSoj().setPageName(b.sojData.pn+"_confirm_discount");a.sendSoj();if(l.is(":visible")){var J=c.trim(r.val());J=J=="输入短信验证码"?"":J;verfiyMsg.hide();if(J&&!x(J)){verfiyMsg.show();verfiyMsgCon.text("验证码错误，请重新输入");return false}else{if(J==""){verfiyMsg.show();verfiyMsgCon.text("请输入验证码");return false}}}var A=c.trim(q.val());A=A=="请输入您的手机号码"?"":A;var H=p.find("input").is(":visible")&&p.find("input").eq(0).is(":checked");var B=p.find("input[name=kft_type]").val();var D=p.find("input[name=kft_id]").val();var F=s.find(".purchase-tips").hide();A?j.text("手机格式错误!"):j.text("手机号码不能为空!");if(XF.Validate.phoneMobile(A)){q.removeClass("int-err");g.hide();var E=H?F.eq(0):F.eq(1);var G=H?1:0;var I=v.data("from");var C={tid:t.tid,uphone:A,tuangou:(I?I:0),join_kft:G,line_id:0,kft_join_id:0,kft_type:B,bind_id:D};if(l.is(":visible")){C.code=J}c.post("/aifang/web/loupan/ajax/tuangou/",C,function(K){if(K.status==0){E.show();a.getCurrentSoj().setPage(b.sojData.p+"_confirm_discount_ok");a.getCurrentSoj().setPageName(b.sojData.np+"_confirm_discount_ok");a.getCurrentSoj().setCustomParam(a.getCustomParam()+"tuangou_member_id="+K.tuangou_member_id);a.sendSoj()}else{if(K.error_code==b.joinErrCode.has){F.eq(2).show()}else{if(K.error_code==b.joinErrCode.over){F.eq(4).show()}else{F.eq(3).show()}}}if(K.error_code==b.joinErrCode.vcode){l.show()}else{if(K.error_code==b.joinErrCode.vcodeError){verfiyMsg.show();verfiyMsgCon.text("验证码错误")}else{if(K.error_code==b.joinErrCode.vcodeExpired){verfiyMsg.show();verfiyMsgCon.text("验证码过期")}else{d.close();h.open()}}}},"json")}else{q.addClass("int-err");g.show()}});a.sendSoj=function(){try{var A=a.getCurrentSoj();var C=function(){var D="";try{D=window.top.document.referrer}catch(F){if(window.parent){try{D=window.parent.document.referrer}catch(E){D=""}}}if(D===""){D=document.referrer}return D};A.setReferer(C());A.setNGuid("aQQ_ajkguid");A.track()}catch(B){}};var m,y;a.initSoj=function(A){m=new SiteTracker("anjuke-npv");m.setPage(b.sojData.p);m.setPageName(b.sojData.pn);var B='{"from": "'+A+'"}';m.setCustomParam(B);a.storeCustomParam(B)};a.getCurrentSoj=function(){return m};a.storeCustomParam=function(A){y=A};a.getCustomParam=function(){return y}})})(XF.Tuan.SignUp,XF.Vars,jQuery);(function(b){var c=b(".lp-tuan-figure .lp-tuan-center");if(c.length){c.on("click.textop",function(){var d=b.trim(b(this).data("src"));d&&XF.WindowsOpen.redirect(d)})}var a=b(".lp-newtuan-v2");if(a.length){a.on("click.textop2",function(){var d=b.trim(b(this).data("src"));d&&XF.WindowsOpen.redirect(d)})}b(".lp-newtuan-v2").on("click",".btn-pop-icon",function(d){d.stopPropagation()})})(jQuery);(function(a){a(".limit-time").each(function(){var e=new Date().getTime();var c=new Date(a(this).attr("endtime")).getTime();if(c<=e){a(this).html('<span class="time-day">0</span>&nbsp;天&nbsp;<span class="time-hour">0</span>&nbsp;时&nbsp;<span class="time-minute">0</span>&nbsp;分&nbsp;<span class="time-second">0</span>&nbsp;秒');return}var d=a(this);var b=new XF.CountDown({timerST:d,endTime:new Date(a(this).attr("endtime"))});a(b).on("over",function(){a(this).html('<span class="time-day">0</span>&nbsp;天&nbsp;<span class="time-hour">0</span>&nbsp;时&nbsp;<span class="time-minute">0</span>&nbsp;分&nbsp;<span class="time-second">0</span>&nbsp;秒')})})})(jQuery);(function(a){APF.Namespace.register("aifang.loupan.view.ConsultantPhoneNumber");aifang.loupan.view.ConsultantPhoneNumber=function(c){var b=this;b.input=c.input_class_name;b.loupan_id=c.loupan_id;b.ajax_url="/aifang/web/loupan/ajax/PhoneConsultant/";if(b.input){b.replace_ids=b.get_replace_ids(b.input);b.replace_phone(b.replace_ids)}};aifang.loupan.view.ConsultantPhoneNumber.prototype.get_replace_ids=function(d){var c=[];var e=a("."+d);if(e.length>0){for(var b=0;b<e.length;b++){c[b]=e.eq(b).val()}}return c};aifang.loupan.view.ConsultantPhoneNumber.prototype.replace_phone=function(d){var b=this;var c={r:Math.random(),loupan_id:b.loupan_id};a.ajax({type:"POST",url:b.ajax_url,cache:false,data:c,dataType:"json",success:function(f){if(f.switch_status=="on"&&f.number){for(var e=0;e<b.replace_ids.length;e++){a(b.replace_ids[e]).html(f.number)}}}})}})(jQuery);(function(a){XF.nameSpace("XF.footer");XF.footer.foldedLayer=function(d,b,c){var d=a(d);var c=a(c);var b=a(b);d.on("click",function(){c.show()});b.on("mouseleave",function(){setTimeout(function(){c.hide()},1000)})}})(jQuery);(function(a){XF.nameSpace("XF.Select");XF.Select=function(c){var b=this;b.op=a.extend({},XF.Select._default,c);b.op.ie6=/MSIE 6/.test(navigator.userAgent);b._init()};XF.Select._default={selectST:".xf-select",focusClass:"xf-select-fo",hoverClass:"option-hv",disableClass:"option-dis",adaptive:true};XF.Select.prototype._init=function(){var b=this,c=b.op;c.$select=a(c.selectST);c.$select.each(function(){var j=a(this),n=j.find(".text"),m=n.find("input"),k=n.find("span"),e=j.find("ul"),h=e.find("li").not("."+c.disableClass),d=h.filter("."+c.hoverClass).removeClass(c.hoverClass).eq(0);d.length&&l(d.text(),d.data("code"));if(c.ie6&&c.adaptive){var p=parseInt(e.css("height")),g=e.css("height","auto").outerHeight()-2,o=n.outerWidth()-parseInt(h.css("padding-left"))-2;if(g>p){e.css("height",p);h.css("width",o-17)}else{h.css("width",o)}e.css("width",n.outerWidth())}n.on("click.select",function(r){r.stopPropagation();j.hasClass(c.focusClass)?q():f()});a(document).on("click.select",function(){q()});e.on({mouseenter:function(){a(this).addClass(c.hoverClass)},mouseleave:function(){a(this).removeClass(c.hoverClass)},click:function(){if(!a(this).hasClass(c.disableClass)){l(a(this).text(),a(this).data("code"))}}},"li");function f(){c.$select.not(j.addClass(c.focusClass)).removeClass(c.focusClass)}function q(){j.removeClass(c.focusClass)}function l(s,r){if(m.val()!=(r||s)){m.val(r||s);k.text(s);a(b).trigger("change",[m])}}})}})(jQuery);(function(a){if(window.need_mobile_code){return}XF.nameSpace("XF.Subscribe");XF.Subscribe=function(b){this.options=b;this.subSuccess=a("#subscribe-success");this.subFail=a("#subscribe-fail")};XF.Subscribe.prototype.subAjax=function(){var c=this,b=this.options;var d={source_id:XF.Vars.loupan_id,phone:b.inputVal,sub_from:101,category:b.category};a.post("/list/subscribe/",d,function(e){if(e==0||e==3){b.type=="show"?c.showSuccess():c.toSuccess()}else{b.type=="show"?c.showFail():c.toFail()}},"text")};XF.Subscribe.prototype.showSuccess=function(){var b=this;var c=new XF.Modal({modalClass:"modal-custom modal-subscribe",title:"订阅信息",bd:b.subSuccess,width:"560",height:"397"});c.open()};XF.Subscribe.prototype.showFail=function(){var b=this;var c=new XF.Modal({modalClass:"modal-custom modal-subscribe",title:"订阅信息",bd:b.subFail,width:"560",height:"397"});c.open()};XF.Subscribe.prototype.toSuccess=function(){var b=this;a(".modal-subscribe .bd").empty().append(b.subSuccess.show())};XF.Subscribe.prototype.toFail=function(){var b=this;a(".modal-subscribe .bd").empty().append(b.subFail.show())}})(jQuery);(function(f){if(window.need_mobile_code){return}var d=f(".subscribe-mix");var n=f("#subscribe-success");var g=f("#subscribe-fail");var m=f(".collect-result");var p=f(".collect-result");var h=d.find(":checkbox");var l=d.find(".cell-phone");var c=d.find(".btn");var a=d.find(".com-msg");var k=d.find(".com-msg").children("span");var j=p.find(".btn");var b=p.find(".cell-phone");var o=p.find(".com-msg");var e=p.find(".com-msg").children("span");f(".unfavor").on("click",function(){var q=new XF.Modal({modalClass:"modal-custom modal-subscribe",title:"收藏信息",bd:p,width:"560",height:"397"});q.open()});f(".subscribe-link").on("click",function(){var r=new XF.Modal({modalClass:"modal-custom modal-subscribe",title:"订阅信息",bd:d,width:"560",height:"397"});var q=f(this).attr("sub-data");h.prop("checked",false).filter("[sub-data="+q+"]").prop("checked",true);r.open()});l.one("focus",function(){f(this).val("")});b.one("focus",function(){f(this).val("")});f(document).on("click",".subscribe-mix .btn",function(){var s="";var q=true;var r=f.trim(l.val());if(!h.filter(":checked").length){k.html("请选择需要订阅的内容！");q=false}else{if(!r||r=="请输入您的手机号码"){k.html("手机号码不能为空！");q=false}else{if(!XF.Validate.phoneMobile(r)){k.html("请正确输入手机号！");q=false}}}if(!q){l.addClass("int-err");a.show()}else{h.filter(":checked").each(function(){s+=f(this).val()+"|"});l.removeClass("int-err");a.hide();var t=new XF.Subscribe({type:"to",inputVal:r,category:s.substring(0,s.length-1)});t.subAjax()}});f(document).on("click",".collect-result .btn",function(){var s="3";var q=true;var r=f.trim(b.val());if(!r||r=="请输入您的手机号码"){e.html("手机号码不能为空！");q=false}else{if(!XF.Validate.phoneMobile(r)){e.html("请正确输入手机号！");q=false}}if(!q){b.addClass("int-err");o.show()}else{b.removeClass("int-err");o.hide();var t=new XF.Subscribe({type:"to",inputVal:r,category:s});t.subAjax()}})})(jQuery);(function(a){if(!window.need_mobile_code){return}XF.nameSpace("XF.Subscribe");XF.Subscribe=function(b){this.options=b;this.subSuccess=a("#subscribe-success");this.subFail=a("#subscribe-fail")};XF.Subscribe.prototype.subAjax=function(){var c=this,b=this.options;var d={source_id:XF.Vars.loupan_id,phone:b.inputVal,sub_from:101,category:b.category,type:10,code:b.codePara.val};a.post("/list/subscribe/",d,function(e){if(e==0||e==3){b.type=="show"?c.showSuccess():c.toSuccess();b.codePara.dom.removeClass("int-err");b.codePara.msgSms.hide()}else{if(e==-1){b.codePara.dom.addClass("int-err");b.codePara.msgSms.show();b.codePara.msg.text("验证码已过期")}else{if(e==-2){b.codePara.dom.addClass("int-err");b.codePara.msgSms.show();b.codePara.msg.text("验证码错误")}else{b.codePara.dom.removeClass("int-err");b.codePara.msgSms.hide();b.type=="show"?c.showFail():c.toFail()}}}},"text")};XF.Subscribe.prototype.showSuccess=function(){var b=this;var c=new XF.Modal({modalClass:"modal-custom modal-subscribe",title:"订阅信息",bd:b.subSuccess,width:"560",height:"397"});c.open()};XF.Subscribe.prototype.showFail=function(){var b=this;var c=new XF.Modal({modalClass:"modal-custom modal-subscribe",title:"订阅信息",bd:b.subFail,width:"560",height:"397"});c.open()};XF.Subscribe.prototype.toSuccess=function(){var b=this;a(".modal-subscribe .bd").empty().append(b.subSuccess.show())};XF.Subscribe.prototype.toFail=function(){var b=this;a(".modal-subscribe .bd").empty().append(b.subFail.show())}})(jQuery);(function(v){if(!window.need_mobile_code){return}var n=v(".subscribe-mix");var G=v("#subscribe-basic").find(".notice-list");var e=v("#subscribe-success");var J=v("#subscribe-fail");var E=v(".collect-result");var l=v(".subscribe-code-1").find(".c-phone");var A=v(".subscribe-code-1").find(".img-code-int");var c=v(".subscribe-code-1").find(".sms-code-int");var H=v(".subscribe-code-1").find(".msg-box");var j=v(".subscribe-code-1").find(".msg-box").children("span");var m=v(".subscribe-code-1 .j-is-show");var f=v(".subscribe-code-2").find(".c-phone");var q=v(".subscribe-code-2").find(".img-code-int");var x=v(".subscribe-code-2").find(".sms-code-int");var D=v(".subscribe-code-2").find(".msg-box");var b=v(".subscribe-code-2").find(".msg-box").children("span");var s=v(".subscribe-code-2 .j-is-show");var K;v(".unfavor").on("click",function(){var M=new XF.Modal({modalClass:"modal-custom modal-subscribe",title:"收藏信息",bd:E,width:"560"});M.open()});function I(){var O=0;if(v(".subscribe-open-a .sub-list").length){var N=v(".subscribe-open-a .sub-list li"),M=N.find("input");M.each(function(P,Q){v(Q).attr("sub-data",P+1)});M.filter(":checked").prop("checked",true);G.empty().append(N.clone())}else{O=1}}function w(N,M,P){var R=v.trim(N.val()),O=M,Q=P;R=R=="请输入您的手机号码"?"":R;O.show();if(R!=""&&!XF.Validate.phoneMobile(R)){N.addClass("int-err");Q.html("请正确输入手机号！");return false}else{if(R==""){N.addClass("int-err");Q.html("手机号码不能为空！");return false}else{K=R;N.removeClass("int-err");O.hide();return true}}}function o(O,M,N){if(!O.length){M.show();N.html("请选择需要订阅的内容！");return false}else{M.hide();return true}}function p(){var Q=v(".subscribe-open-a .acti-group"),M=Q.next(),P=M.find("span"),O=Q.parent().prev(),N=O.find("input").filter(":checked");if(O.length){return o(N,M,P)}else{return true}}function u(){v.post("/vcode/image/",{},function(M){if(M.status==1){s.show()}else{s.hide()}},"json")}function h(){v.post("/vcode/image/",{},function(M){if(M.status==1){m.show()}else{m.hide()}},"json")}function d(){var P=v(".xf-verify-module").find(".c-phone");var N=v(".xf-verify-module").find(".img-code-int");var O=v(".xf-verify-module").find(".sms-code-int");var M=v(".xf-verify-module").find(".msg-box");P.removeClass("int-err");N.attr("placeholder",g.code.defaults);N.val("");N.removeClass("int-err");O.attr("placeholder",g.smscode.defaults);O.val("");O.removeClass("int-err");M.hide()}v(".subscribe-link,.subscribe-open-a .acti-group,.subscribe-open-btn").on("click",function(){var Q=new XF.Modal({modalClass:"modal-custom modal-subscribe",title:"订阅信息",bd:n,width:"560"});var M=v(this).attr("sub-data");if(M){var R=G.find(":checkbox");R.prop("checked",false).filter("[sub-data="+M+"]").prop("checked",true)}if(v(this).prev().attr("data-subscribe")=="open"){var S=v(this).prev(),N=v(this).next(),P=N.find("span"),O=v(this).parent().prev().find("input").filter(":checked");I();if(w(S,N,P)&&p()){Q.open();l.val(K)}}else{Q.open()}h();k();d()});v(".subscribe-mod .cell-phone").one("focus",function(){v(this).val("")});l.one("focus",function(){v(this).val("")});f.one("focus",function(){v(this).val("")});v(".int-text").each(function(){v(this).on({"focus.inttext":function(){v(this).addClass("int-focus")},"blur.inttext":function(){v(this).removeClass("int-focus")}})});var y=[],g={subscribe:{contents:"请选择需要订阅的内容！"},phone:{defaults:"请输入您的手机号码",empty:"手机号码不能为空！",format:"请正确输入手机号！"},code:{defaults:"请输入图片码",empty:"图片码不能为空",format:"图片码错误"},smscode:{defaults:"请输入短信验证码",empty:"短信验证不能为空",format:"短信验证码错误"}};y.subscribe=function(){var N=n.find(":checkbox");var M=H.eq(0);msg=j.eq(0);M.show();if(!N.filter(":checked").length){msg.html(g.subscribe.contents);return false}else{M.hide();return true}};y.phone=function(){var O=v.trim(l.val()),M=H.eq(0),N=j.eq(0);O=O==g.phone.defaults?"":O;if(O!=""&&!XF.Validate.phoneMobile(O)){M.show();l.addClass("int-err");N.html(g.phone.format);return false}else{if(O==""){M.show();l.addClass("int-err");N.html(g.phone.empty);return false}else{l.removeClass("int-err");M.hide();return true}}};y.imgCode=function(){var N=v.trim(A.val()),M=H.eq(1);msg=j.eq(1);N=N==g.code.defaults?"":N;if(N!=""&&N.length!=4){M.show();A.addClass("int-err");msg.html(g.code.format);return false}else{if(N==""){M.show();A.addClass("int-err");msg.html(g.code.empty);return false}else{A.removeClass("int-err");M.hide();return true}}};y.smsCode=function(){var O=v.trim(c.val()),M=H.eq(2),N=j.eq(2);O=O==g.smscode.defaults?"":O;M.show();if(O!=""&&!XF.Validate.smsCode(O)){c.addClass("int-err");N.html(g.smscode.format);return false}else{if(O==""){c.addClass("int-err");N.html(g.smscode.empty);return false}else{c.removeClass("int-err");M.hide();return true}}};y.isShowCode=function(){if(v(".subscribe-code-1 .j-is-show").is(":visible")){return y.imgCode()}else{return true}};function k(){var O=v.now(),M,N=v(".subscribe-code-1 .refresh-btn").prev();M=N.attr("src").substr(0,N.attr("src").length-13)+O;N.attr("src",M)}function B(P,M,O){var N={phone:M,type:10};if(m.is(":visible")){N.imagecode=v.trim(A.val())}v.ajax({url:"/vcode/mobilecode/",type:"post",dataType:"json",data:N,success:function(R){var Q,T,S,U;Q=H.eq(0),T=j.eq(0),S=H.eq(1),U=j.eq(1);if(R.rst>0){t(P,O);Q.hide();S.hide()}else{if(R.rst==-3){m.show();S.show();A.addClass("int-err");U.html(R.msg)}else{if(m.is(":visible")){S.show();A.addClass("int-err");U.html(R.msg)}else{A.removeClass("int-err");Q.show();msg.html(R.msg)}}}}})}function t(O,N){if(N==0){O.removeAttr("disabled");O.removeClass("f-getcode-dis");O.text("发送短信验证码");N=N;a()}else{O.attr("disabled","disabled");O.addClass("f-getcode-dis");O.text(N+"秒后重新发送");O.off("click.send");N--;var M=setTimeout(function(){t(O,N)},1000)}}v(".subscribe-code-1 .refresh-btn").on("click.refresh",function(){k()});function a(){v(".subscribe-code-1 .send-sms-btn").on("click.send",function(){var M=v.trim(l.val());if(y.phone()&&y.isShowCode()){B(v(this),M,60)}})}a();v(document).on("click",".subscribe-mix .btn",function(){var Q="";var O=v.trim(l.val());var N=v.trim(c.val());var M=H.eq(2);var R=j.eq(2);if(y.subscribe()&&y.phone()&&y.isShowCode()&&y.smsCode()){var P=n.find(":checkbox");P.filter(":checked").each(function(){Q+=v(this).val()+"|"});l.removeClass("int-err");H.hide();var S=new XF.Subscribe({type:"to",inputVal:O,category:Q.substring(0,Q.length-1),codePara:{val:N,msgSms:M,msg:R,dom:c}});S.subAjax()}});var F=[];F.phone=function(){var O=v.trim(f.val()),M=D.eq(0),N=b.eq(0);O=O==g.phone.defaults?"":O;M.show();if(O!=""&&!XF.Validate.phoneMobile(O)){f.addClass("int-err");N.html(g.phone.format);return false}else{if(O==""){f.addClass("int-err");N.html(g.phone.empty);return false}else{f.removeClass("int-err");M.hide();return true}}};F.imgCode=function(){var N=v.trim(q.val()),M=D.eq(1);msg=b.eq(1);N=N==g.code.defaults?"":N;if(N!=""&&N.length!=4){M.show();q.addClass("int-err");msg.html(g.code.format);return false}else{if(N==""){M.show();q.addClass("int-err");msg.html(g.code.empty);return false}else{q.removeClass("int-err");M.hide();return true}}};F.smsCode=function(){var O=v.trim(x.val()),M=D.eq(2),N=b.eq(2);O=O==g.smscode.defaults?"":O;if(O!=""&&!XF.Validate.smsCode(O)){M.show();x.addClass("int-err");N.html(g.smscode.format);return false}else{if(O==""){M.show();x.addClass("int-err");N.html(g.smscode.empty);return false}else{x.removeClass("int-err");M.hide();return true}}};F.isShowCode=function(){if(s.is(":visible")){return F.imgCode()}else{return true}};function z(){var O=v.now(),M,N=v(".subscribe-code-2 .refresh-btn").prev();M=N.attr("src").substr(0,N.attr("src").length-13)+O;N.attr("src",M)}function C(P,M,O){var N={phone:M,type:10};if(s.is(":visible")){N.imagecode=v.trim(q.val())}v.ajax({url:"/vcode/mobilecode/",type:"post",dataType:"json",data:N,success:function(R){var Q,T,S,U;Q=D.eq(0),T=b.eq(0),S=D.eq(1),U=b.eq(1);if(R.rst>0){t(P,O);Q.hide();S.hide();q.removeClass("int-err")}else{if(R.rst==-3){m.show()}else{if(s.is(":visible")){S.show();q.addClass("int-err");U.html(R.msg)}else{q.removeClass("int-err");Q.show();msg.html(R.msg)}}}}})}function r(O,N){if(N==0){O.removeAttr("disabled");O.removeClass("f-getcode-dis");O.text("发送短信验证码");N=N;L()}else{O.attr("disabled","disabled");O.addClass("f-getcode-dis");O.text(N+"秒后重新发送");O.off("click.favSend");N--;var M=setTimeout(function(){r(O,N)},1000)}}v(".subscribe-code-2 .refresh-btn").on("click.refresh",function(){z()});function L(){v(".subscribe-code-2 .send-sms-btn").on("click.favSend",function(){var M=v.trim(f.val());if(F.phone()&&F.isShowCode()){C(v(this),M,60)}})}L();v("#z-addFav").on("click",function(){u()});v(document).on("click",".collect-result .btn",function(){var P="3";var O=v.trim(f.val());var N=v.trim(x.val());var M=D.eq(2);var Q=b.eq(2);z();if(F.phone()&&F.isShowCode()&&F.smsCode()){f.removeClass("int-err");var R=new XF.Subscribe({type:"to",inputVal:O,category:P,codePara:{val:N,msgSms:M,msg:Q,dom:x}});R.subAjax()}})})(jQuery);(function(a){XF.nameSpace("XF.Favorite");XF.Favorite=function(c){var b=this;b.op=a.extend({favST:"",favUrl:null},c);b._init()};XF.Favorite.prototype._init=function(){var b=this,c=b.op;c.fav=a("#z-addFav");c.favText=c.fav.find(".fav-text");b.checkFav();c.fav.on("click.fav",function(){c.fav.hasClass("fav-dis")||b.addFav()})};XF.Favorite.prototype.addFav=function(){var b=this,c=b.op;a.ajax({type:"get",url:c.favUrl.add,dataType:"jsonp",jsonp:"callback",success:function(d){b.checkFav()}})};XF.Favorite.prototype.checkFav=function(){var b=this,c=b.op;a.ajax({type:"get",url:c.favUrl.chk,dataType:"jsonp",jsonp:"callback",success:function(d){if(d.code==1){c.fav.removeClass("unfavor").addClass("favored").off("mouseenter mouseleave click");c.fav.text("已经收藏")}else{c.fav.removeClass("favored").addClass("unfavor");c.fav.text("收藏本盘")}}})};XF.Favorite.prototype.deleteFav=function(){var b=this,c=b.op;a.ajax({type:"get",url:c.favUrl.del,dataType:"jsonp",jsonp:"callback",success:function(){b.checkFav()}})}})(jQuery);(function(f){var r=f(".modal-intention-bd");var e=new XF.Modal({modalClass:"modal-custom",title:"看房意向",bd:r,width:"560"});var g=f(".modal-intention-status");var s=new XF.Modal({modalClass:"modal-custom",title:"看房意向",bd:g,width:"560",height:"400"});var b=f(".modal-intention-status-err");var o=new XF.Modal({modalClass:"modal-custom",title:"看房意向",bd:b,width:"560",height:"400"});var t=f(".modal-intention-bd .intention-info textarea"),a=f(".modal-intention-bd .btn-box .btn"),v=f(".modal-intention-bd .area-info .text input"),d=f(".modal-intention-bd .phone-box .int-text"),h=f(".modal-intention-bd .phone-box .com-msg"),l=h.find("span"),k=false,m=f.trim(d.val()),n=f.trim(t.val());f("#j-intention").on("click",function(){e.open()});var u=new XF.Select({selectST:".modal-intention-bd .xf-select"});d.on({focus:function(){var w=f(this);var x=f.trim(w.val());x==m&&w.val("");w.addClass("int-focus")},blur:function(){var w=f(this);var x=f.trim(w.val());x==""&&w.removeClass("int-focus")}});t.on({focus:function(){var w=f(this);var x=f.trim(w.val());x==n&&w.val("");w.addClass("int-focus")},blur:function(){var w=f(this);var x=f.trim(w.val());x==""&&w.val(n);w.removeClass("int-focus")},keydown:function(){var w=f(this);if(w.val().length>100){w.val(w.val().substring(0,100))}}});function q(w){w=w=="请输入您的手机号码"?"":w;w?l.text("手机格式错误！"):l.text("手机号码不能为空！");if(XF.Validate.phoneMobile(w)){d.removeClass("int-err");h.hide();k=true}else{d.addClass("int-err");h.show();k=false}}a.on("click",function(){var z=v.val(),A=f.trim(d.val()),y=f.trim(t.val()),w=f.trim(f("input[name=way]").val());q(A);if(k){var x={region_id:(z?z:0),phone:A,content:(y=="请输入您想去的楼盘或其它信息")?"":y,kft_type:w};f.post("/aifang/web/kft/ajax/feedback/",x,function(B){e.close();if(B.status==0){s.open()}else{o.open()}},"json")}});var p=f("#j-site-gotop"),j=p.find(".btn-gotop");j.on("click.gotop",function(){f("html,body").animate({scrollTop:0},400)});function c(){var w=f(window).scrollTop();w>400?j.css({visibility:"visible"}):j.css({visibility:"hidden"})}c();f(window).on("scroll.gotop",function(){c()})})(jQuery);(function(a){XF.nameSpace("XF.Switch");XF.Switch=function(c){var b=this;b.op=a.extend({},XF.Switch._default,c);b._init()};XF.Switch._default={switchST:"",clipST:".clip",conST:".con",itemST:".item",prevST:".prev",nextST:".next",pnavST:".pnav",effect:"slide",event:"click",current:"cur",circle:false,vertical:false,auto:false,start:0,duration:400,interval:5000,switchNum:1,clipNum:1};XF.Switch.prototype._init=function(){var c=this,e=c.op;e.sw=a(e.switchST);e.clip=e.sw.find(e.clipST);e.con=e.clip.find(e.conST).css({position:"relative"});e.item=e.con.find(e.itemST);e.prev=e.prevST==".prev"?e.sw.find(e.prevST):a(e.prevST);e.next=e.nextST==".next"?e.sw.find(e.nextST):a(e.nextST);e.pnav=e.pnavST==".pnav"?e.sw.find(e.pnavST):a(e.pnavST);e.itemLen=e.item.length;e.switchNum>e.clipNum&&(e.switchNum=e.clipNum);e.itemLen<e.clipNum&&(e.itemLen=e.clipNum);if(e.effect!="slide"){e.switchNum=1;e.clipNum=1}e.prevDisClass=a.trim(e.prevST).match(/\w\S*$/)+"-dis";e.nextDisClass=a.trim(e.nextST).match(/\w\S*$/)+"-dis";e.start=parseInt(e.start,10);e.start=(e.start>=0&&e.start<e.itemLen)?e.start:0;if(e.effect=="slide"){e.vertical||e.item.css({"float":"left"});e.leftOrTop=e.vertical?"top":"left";e.widthOrHeight=e.vertical?e.item.outerHeight(true):e.item.outerWidth(true);e.conSize=e.widthOrHeight*e.itemLen;e.vertical?e.con.css({height:e.conSize}):e.con.css({width:e.conSize})}else{if(e.effect=="fade"){e.item.not(e.item.eq(e.start).show()).hide().css({position:"absolute"})}else{e.item.not(e.item.eq(e.start).show()).hide();e.effect="none";e.duration=0}}function b(){e.timer=setInterval(function(){e.showpage>=e.itemLen-e.clipNum?c.switchTo(0):c.next()},e.interval)}function d(){clearInterval(e.timer)}d();if(e.itemLen<=e.clipNum){e.stopRun=true;c.switchTo(0);return}c.switchTo(e.start);e.prev.off("click.switch").on("click.switch",function(){a(this).hasClass(e.prevDisClass)||c.prev()});e.next.off("click.switch").on("click.switch",function(){a(this).hasClass(e.nextDisClass)||c.next()});e.pnav.each(function(f){a(this).off(e.event+".switch").on(e.event+".switch",function(){c.switchTo(f)})});if(e.auto){b();e.sw.off("mouseenter.switch mouseleave.switch").on({"mouseenter.switch":function(){d()},"mouseleave.switch":function(){b()}})}};XF.Switch.prototype._play=function(d,j,g){var c=this,h=c.op,f=null,e={},b=0;if(a(c).trigger("playBefore")!==false){if(d===null){d=j?h.showpage-h.switchNum:h.showpage+h.switchNum}else{d=isNaN(d)?0:d;if(d==h.showpage){return}}if(h.circle){d<0&&(d=h.itemLen-h.clipNum);d>h.itemLen-h.clipNum&&(d=0)}else{d<0&&(d=0);d>h.itemLen-h.clipNum&&(d=h.itemLen-h.clipNum);d==0?h.prev.addClass(h.prevDisClass):h.prev.removeClass(h.prevDisClass);d==h.itemLen-h.clipNum?h.next.addClass(h.nextDisClass):h.next.removeClass(h.nextDisClass)}for(;b<h.clipNum+h.switchNum;b++){if(d+b>=h.itemLen){break}c._changeSrc(d+b)}if(h.effect=="slide"){e[h.leftOrTop]=-h.widthOrHeight*d;h.con.stop().animate(e,h.duration)}else{if(h.effect=="fade"||h.effect=="none"){f=h.item.eq(d);h.item.not(f).stop().fadeOut(h.duration);f.fadeIn(h.duration)}}h.pnav.removeClass(h.current);h.pnav.eq(Math.ceil(d/h.switchNum)).addClass(h.current);h.showpage=d;a(c).trigger("playAfter")}};XF.Switch.prototype._changeSrc=function(d){var b=this,f=b.op,c=f.item.eq(d).find("img"),e=0;for(;e<c.length;e++){c.eq(e).attr("src")||c.eq(e).attr("src",c.eq(e).data("src"))}};XF.Switch.prototype.switchTo=function(b){this._play(b,false,false)};XF.Switch.prototype.prev=function(){this._play(null,true,false)};XF.Switch.prototype.next=function(){this._play(null,false,true)}})(jQuery);(function(a){XF.nameSpace("XF.AlbumTab");XF.AlbumTab=function(c){var b=this;b.ops=a.extend({},XF.AlbumTab._default,c);b._init()};XF.AlbumTab._default={swBigOp:null,swSmallOp:null,tabST:"",tabIndex:0,tabCurClass:"cur",autoHeight:true,imgSrc:null,imgDes:null};XF.AlbumTab.prototype._init=function(){var b=this,c=b.ops;c.ie6=/MSIE 6/.test(navigator.userAgent);c.swBig=new XF.Switch(c.swBigOp);c.swSmall=new XF.Switch(c.swSmallOp);c.initHeight=c.swBig.op.clip.height();if(c.tabST){c.tab=a(c.tabST);c.tab.each(function(d){a(this).on("click.album",function(){c.tab.not(a(this)).removeClass(c.tabCurClass);a(this).addClass(c.tabCurClass);b.create(d)})});c.tab.eq(c.tabIndex).trigger("click.album")}else{b.create(0)}};XF.AlbumTab.prototype.create=function(d){var c=this,h=c.ops;var g=h.imgSrc[d],e=0,b="",f="";for(;e<g.big.length;e++){if(!(h.imgDes&&g.image_des)){b+='<div class="item"><img data-src="'+g.big[e]+'" /></div>'}else{b+='<div class="item"><img data-src="'+g.big[e]+'" /><span class="tit-bg"></span><div class="photo-des"><!-- -->'+g.image_des[e]+"</div></div>"}f+='<div class="item"><a href="javascript:void(0);"><img data-src="'+g.small[e]+'" /></a></div>'}h.swBig.op.con.html(b);h.swSmall.op.con.html(f);h.swBig=new XF.Switch(h.swBigOp);h.swSmall=new XF.Switch(h.swSmallOp);h.autoHeight&&c.changeHeight();h.imgDes&&c.changeDesHeight();a(h.swBig).on("playAfter",function(){h.autoHeight&&c.changeHeight();h.imgDes&&c.changeDesHeight();var k=h.swBig.op.showpage,l=h.swSmall.op.showpage,j=h.swSmall.op.clipNum;if(k>=l+j){h.swSmall.switchTo(k)}else{if(k<l){h.swSmall.switchTo(k)}}})};XF.AlbumTab.prototype.changeHeight=function(){var k=this,b=k.ops,c=b.swBig.op.item.eq(b.swBig.op.showpage).find("img"),d=b.swBig.op.clip,h=d.width(),e=b.swBig.op.prev,f=b.swBig.op.next;var j=setInterval(function(){if(c.height()>50){clearInterval(j);b.ie6&&c.width("auto")&&c.width()>h&&c.width(h);g(c.height())}},200);function g(l){if(l>b.initHeight){d.add(e).add(f).height(c.height())}else{d.add(e).add(f).height(b.initHeight)}a(window).trigger("resize.modal")}};XF.AlbumTab.prototype.changeDesHeight=function(){var c=this,e=c.ops,f=e.swBig.op.item.eq(e.swBig.op.showpage).find(".photo-des"),d=e.swBig.op.item.eq(e.swBig.op.showpage).find(".tit-bg");var b=setInterval(function(){clearInterval(b);if(f.height()>0){d.height(f.height()+9)}},200)}})(jQuery);(function(d){d("#j-switch-basic").find(".item").on("click.sendsoj",function(){XF.Soj.send("{from:click_loupan_index_big_pic}",XF.Soj.param)});var e=new XF.Switch({switchST:"#j-switch-basic",effect:"fade",event:"mouseenter",prevST:"#j-switch-basic .arrow-pre",nextST:"#j-switch-basic .arrow-next"});var a=d("#j-switch-basic .arrow");d("#j-switch-basic .switch-box").on({"mouseenter.swbasic":function(){e.op.stopRun||a.show()},"mouseleave.swbasic":function(){a.hide()}});var c=e.op.item.find("img");d(window).on("load.swbasic",function(){c.each(function(){b(d(this))})});d(e).on("playAfter",function(){var f=c.eq(e.op.showpage);b(f)});function b(f){f.attr("src")||f.attr("src",f.data("src"))}})(jQuery);(function(f){var k=f(".discount-notice-bd"),d=f(".discount-result-bd"),c=d.find(".apply-tips"),a=k.find(".int-text"),b=k.find(".btn"),j=k.find(".com-msg");var g=new XF.Modal({modalClass:"modal-custom apply-modal discout-notice-me",title:"优惠通知我",bd:k,width:"600",height:"313"});var h=new XF.Modal({modalClass:"modal-custom apply-modal discout-notice-me",title:"优惠通知我",bd:d,width:"600",height:"313"});a.one("focus",function(){f(this).val("")});b.on("click.discount",function(){var l=f.trim(a.val());(!l||l=="请输入您的手机号码")?j.html('<i class="lp-icons error-icon"></i> 手机号码不能为空！'):j.html('<i class="lp-icons error-icon"></i> 手机格式错误！');if(!XF.Validate.phoneMobile(l)){a.addClass("int-err");j.show()}else{a.removeClass("int-err");j.hide();post_params={name:"",lp_id:XF.Vars.loupan_id,lp_name:XF.Vars.loupan_name,phone:l,code:"999999",num:"1",differ:"yhtz"};f.post("/aifang/web/loupan/ajax/kanfang/",post_params,function(m){g.close();if(m.status==0){h.open();c.eq(0).show();window.setTimeout(function(){h.close()},10000)}else{h.open();c.eq(1).show()}},"json")}});f("#chengjiao-trend").on("click",function(){var l=f(".trend-mod").offset().top-100;f("html,body").animate({scrollTop:l},400);XF.Soj.send("{from:loupan_frist_chengjiao}",XF.Soj.param)});var e=f(".basic-details").find(".deal-exist");f(document).ready(function(){if(e.length){XF.Soj.send("{from:index_chengjiao_baoguang}",XF.Soj.param)}})})(jQuery);(function(g){var h=g(".open-notice-bd"),c=g(".open-result-bd"),f=c.find(".notice-tips"),d=h.find(".int-text"),e=h.find(".btn"),j=h.find(".com-msg");var b=new XF.Modal({modalClass:"modal-custom open-modal open-notice-me",title:"开盘通知我",bd:h,width:"560",height:"400"});var a=new XF.Modal({modalClass:"modal-custom open-modal open-notice-me",title:"开盘通知我",bd:c,width:"560",height:"400"});d.one("focus",function(){g(this).val("")});e.on("click.open",function(){var k=g.trim(d.val());(!k||k=="请输入您的手机号码")?j.html('<i class="lp-icons error-icon"></i> 手机号码不能为空！'):j.html('<i class="lp-icons error-icon"></i> 手机格式错误！');if(!XF.Validate.phoneMobile(k)){d.addClass("int-err");j.show()}else{d.removeClass("int-err");j.hide();post_params={source_id:XF.Vars.loupan_id,phone:k,sub_from:101,category:1};g.post("/list/subscribe/",post_params,function(l){b.close();if(l==0||l==3){a.open();f.eq(0).show();window.setTimeout(function(){a.close()},10000)}else{a.open();f.eq(1).show()}},"json")}})})(jQuery);(function(a){a("#j-bianjia-note").on("click",function(){XF.Soj.send("{from:loupan_index_bianjia}",XF.Soj.param)});a("#l-price-change").on("click",function(){XF.Soj.send("{from:loupan_index_bianjia_bottom}",XF.Soj.param)});a("#j-discount-notice").on("click.discount",function(){XF.Soj.send("{from:loupan_index_discount}",XF.Soj.param)});a("#j-open-showlink").on("click.open",function(){XF.Soj.send("{from:loupan_index_kaipan}",XF.Soj.param)});a("#j-open-to8to").on("click.open",function(){XF.Soj.send("{from:loupan_index_guanggao_t8t}",XF.Soj.param)})})(jQuery);(function(a){a(".discount-recomm-mod .hui-contents-mod").on({mouseenter:function(){a(this).addClass("item-hover")},mouseleave:function(){a(this).removeClass("item-hover")},click:function(){var b=a.trim(a(this).data("link"));b&&XF.WindowsOpen.redirect(b)}});a(".discount-recomm-mod .hui-contents-mod .btn").on("click",function(b){b.stopPropagation()})})(jQuery);XF.nameSpace("XF.Kft.CarPoper");(function(C,v,l){var A=l(".modal-car-bd-v2"),s=A.find(".theme-hd");var q=new XF.Modal({modalClass:"modal-custom",title:"专车看房",bd:A,width:"560"});var x=l(".modal-car-status");var D=new XF.Modal({modalClass:"modal-custom",title:"专车看房",bd:x,width:"560",height:"500"});var B=l("[kft-car-btn]"),d=A.find(".inp-text"),r=d.eq(0),w=d.eq(1),g=l(".valid-btn").find("input"),f=x.find(".apply-tips"),z=f.eq(0),a=f.eq(1),j={},k,t,c=A.find(".valid-btn .btn"),b={name:{defaults:"例如：王先生",empty:"姓名不能为空",format:"姓名填写有误"},phone:{defaults:"请输入您的手机号码",empty:"手机号码不能为空",format:"手机号码填写有误"}};var m={phone:l(".modal-car-bd-v2 .c-phone"),imgCode:l(".modal-car-bd-v2 .img-code-int"),smsCode:l(".modal-car-bd-v2 .sms-code-int"),msgBox:l(".modal-car-bd-v2 .msg-box"),msgText:l(".modal-car-bd-v2 .msg-box span"),isShow:l(".modal-car-bd-v2 .j-is-show"),refreshBtn:l(".modal-car-bd-v2 .refresh-btn"),verfiyBtn:l(".modal-car-bd-v2 .send-sms-btn"),is_send_sms:"fail"};var j=[],y={phone:{defaults:"请输入您的手机号码",empty:"手机号码不能为空！",format:"请正确输入手机号！"},code:{defaults:"请输入图片码",empty:"图片码不能为空",format:"图片码错误",expired:"图片码过期"},smscode:{defaults:"请输入短信验证",empty:"短信验证码不能为空",format:"短信验证码错误",expired:"短信验证码过期"}};j.phone=function(){var H=m.phone,G=l.trim(H.val()),E=m.msgBox.eq(1),F=m.msgText.eq(1);G=G==y.phone.defaults?"":G;E.show();if(G!=""&&!XF.Validate.phoneMobile(G)){H.addClass("int-err");F.html(y.phone.format);return false}else{if(G==""){H.addClass("int-err");F.html(y.phone.empty);return false}else{H.removeClass("int-err");E.hide();return true}}};j.imgCode=function(){var H=m.imgCode,G=l.trim(H.val()),E=m.msgBox.eq(2),F=m.msgText.eq(2);G=G==y.code.defaults?"":G;E.show();if(G!=""&&G.length!=4){H.addClass("int-err");F.html(y.code.format);return false}else{if(G==""){H.addClass("int-err");F.html(y.code.empty);return false}else{H.removeClass("int-err");E.hide();return true}}};j.smsCode=function(){var H,E,G,F=m.smsCode,H=l.trim(F.val());if(m.isShow.length){E=m.msgBox.eq(3),G=m.msgText.eq(3)}else{E=m.msgBox.eq(2),G=m.msgText.eq(2)}H=H==y.smscode.defaults?"":H;E.show();if(H!=""&&!XF.Validate.smsCode(H)){F.addClass("int-err");G.html(y.smscode.format);return false}else{if(H==""){F.addClass("int-err");G.html(y.smscode.empty);return false}else{F.removeClass("int-err");E.hide();return true}}};j.isShowCode=function(){if(m.isShow.is(":visible")){return j.imgCode()}else{return true}};function o(){var G=l.now(),E,F=m.refreshBtn.prev();E=F.attr("src").substr(0,F.attr("src").length-13)+G;F.attr("src",E)}function n(H,E,G){var F={phone:E,guid:XF.Vars.guid,type:1};if(m.isShow.is(":visible")){F.imagecode=l.trim(m.imgCode.val())}l.ajax({url:"/vcode/mobilecode/",type:"post",dataType:"json",data:F,success:function(J){var I,L,K,M;I=m.msgBox.eq(1),L=m.msgText.eq(1),K=m.msgBox.eq(2),M=m.msgText.eq(2);if(J.rst>0){e(H,G);I.hide();K.hide()}else{if(J.rst==-3){m.isShow.show();K.show();m.imgCode.addClass("int-err");M.html(J.msg)}else{if(m.isShow.is(":visible")){K.show();m.imgCode.addClass("int-err");M.html(J.msg)}else{I.show();msg.html(J.msg)}}}}})}function e(G,F){if(F==0){G.removeAttr("disabled");G.removeClass("f-getcode-dis");G.text("发送短信验证码");F=F;u()}else{G.attr("disabled","disabled");G.addClass("f-getcode-dis");G.text(F+"秒后重新发送");G.off("click.xfsend");F--;var E=setTimeout(function(){e(G,F)},1000)}}m.refreshBtn.on("click.xfrefresh",function(){o()});function u(){m.verfiyBtn.on("click.xfsend",function(){var E=l.trim(m.phone.val());if(j.phone()&&j.isShowCode()){n(l(this),E,60)}})}u();B.each(function(E){l(this).on("click.car",function(G){var H;t=l(this);G.stopPropagation();H=t.attr("data-soj");C.sendSoj('{"from": "'+H+'"}');if(v.kftCarData.length==1){k=v.kftCarData[0]}else{k=v.kftCarData[E]}s.html(k.loupan_name);l("input[name=from_module]").val(k.from_module);l("input[name=zhuanche_id]").val(k.zhuanche_id);q.open();var F={guid:XF.Vars.guid};l.post("/vcode/image/",F,function(I){if(I.status==1){m.isShow.show()}else{m.isShow.hide()}},"json");o();m.phone.removeClass("int-err");m.imgCode.attr("placeholder",y.code.defaults);m.imgCode.val("");m.imgCode.removeClass("int-err");m.smsCode.attr("placeholder",y.smscode.defaults);m.smsCode.val("");m.smsCode.removeClass("int-err");m.msgBox.hide()})});var p=(function(){l(".inp-text").each(function(){var E=l.trim(l(this).attr("placeholder"));l(this).on({"focus.inttext":function(){var F=l.trim(l(this).val());F==E&&l(this).val("");l(this).addClass("int-focus")},"blur.inttext":function(){var F=l.trim(l(this).val());F==""&&l(this).val(E);l(this).removeClass("int-focus")}})})})();j.name=function(){var H=l.trim(r.val()),E=r.next().find("p"),G=H.length>8?false:true;H=H==b.name.defaults?"":H;var F=/^[\u4E00-\u9FA5]+$/;if(!F.test(H)){G=false}if(!G&&H!=""){E.show();r.addClass("int-err");E.html('<i class="lp-icons error-icon"></i><em>'+b.name.format+"</em>");return false}else{r.removeClass("int-err");E.hide();return true}};r.on("blur.name",function(){j.name()});c.on("click.car",function(){var G=l(this),L=l.trim(m.phone.val()),K=l.trim(r.val()),F=l.trim(m.smsCode.val()),H=l.trim(m.imgCode.val()),I=l.trim(l("input[name=from_module]").val()),E=l.trim(l("input[name=zhuanche_id]").val());if(j.phone()&&j.isShowCode()&&j.smsCode()){var J={phone:L,name:K,from_module:I,zhuanche_id:E,channel:1,code:F,img_code:H};f.hide();l.post("/aifang/web/kft/ajax/applycar/",J,function(N){var M,O;M=m.msgBox.eq(3),O=m.msgText.eq(3);if(N.status==0){q.close();D.open();z.show()}else{if(N.error_code==v.kftErrCode.vcodeError){M.show();m.smsCode.addClass("int-err");O.text("短信验证码错误")}else{if(N.error_code==v.kftErrCode.vcodeExpired){M.show();m.smsCode.addClass("int-err");O.text("短信验证码过期")}else{M.hide();q.close();D.open();a.show()}}}},"json")}});var h=x.find(".apply_retry");h.on("click.try",function(){q.open();D.close()});C.sendSoj=function(G){try{var E=new SiteTracker("anjuke-npv");E.setPage(v.sojData.p);E.setPageName(v.sojData.pn);var H=function(){var I="";try{I=window.top.document.referrer}catch(K){if(window.parent){try{I=window.parent.document.referrer}catch(J){I=""}}}if(I===""){I=document.referrer}return I};E.setReferer(H());E.setNGuid("aQQ_ajkguid");E.setCustomParam(G);E.track()}catch(F){}}})(XF.Kft.CarPoper,XF.Vars,jQuery);XF.nameSpace("XF.Kft.SignUp");(function(v,E,j){var x=j(".modal-line-bd-v2"),J=x.find(".apply-info dt");var u=new XF.Modal({modalClass:"modal-custom",title:"看房团报名",bd:x,width:"560"});var l=j(".modal-line-status");var r=new XF.Modal({modalClass:"modal-custom",title:"看房团报名",bd:l,width:"560",height:"400"});var I=j("[kft-sign]"),k,B,C;var b=x.find(".btn-box .btn"),n=x.find(".tel-box .int-text"),F=x.find(".tel-box .com-msg"),A=F.find("span"),w=x.find(".name-box .int-text"),d=x.find(".name-box .com-msg"),z=d.find("span"),y=x.find(".verify-box .int-text"),p=x.find(".verify-info"),e=p.find(".com-msg"),c=e.find("span"),t=x.find(".btn-box .int-text-from"),a=l.find(".apply-tips"),h=l.find(".err_msg"),H;var m={phone:j(".modal-line-bd-v2 .c-phone"),imgCode:j(".modal-line-bd-v2 .img-code-int"),smsCode:j(".modal-line-bd-v2 .sms-code-int"),msgBox:j(".modal-line-bd-v2 .msg-box"),msgText:j(".modal-line-bd-v2 .msg-box span"),isShow:j(".modal-line-bd-v2 .j-is-show"),refreshBtn:j(".modal-line-bd-v2 .refresh-btn"),verfiyBtn:j(".modal-line-bd-v2 .send-sms-btn"),is_send_sms:"fail"};var g=[],G={phone:{defaults:"请输入您的手机号码",empty:"手机号码不能为空！",format:"请正确输入手机号！"},code:{defaults:"请输入图片码",empty:"图片码不能为空",format:"图片码错误",expired:"图片码过期"},smscode:{defaults:"请输入短信验证码",empty:"短信验证码不能为空",format:"短信验证码错误",expired:"短信验证码过期"}};I.each(function(K){j(this).on("click.line",function(M){M.stopPropagation();C=j(this);var N=C.attr("data-soj");v.sendSoj('{"from": "'+N+'"}');if(E.kftData.length==1){k=E.kftData[0]}else{k=E.kftData[K]}B=k.data;J.html("["+B.time+"]"+B.line_name);n.removeClass("int-err");F.hide();w.removeClass("int-err");d.hide();y.removeClass("int-err");e.hide();u.open();var L={guid:XF.Vars.guid};j.post("/vcode/image/",L,function(O){if(O.status==1){m.isShow.show()}else{m.isShow.hide()}},"json");s();m.phone.removeClass("int-err");m.imgCode.attr("placeholder",G.code.defaults);m.imgCode.val("");m.imgCode.removeClass("int-err");m.smsCode.attr("placeholder",G.smscode.defaults);m.smsCode.val("");m.smsCode.removeClass("int-err");m.msgBox.hide()})});function q(K){K=K=="请输入您的姓名"?"":K;K?z.text("姓名格式错误！"):z.text("姓名不能为空！");var L=K.length>15?false:true;if(L){w.removeClass("int-err");d.hide();H=true}else{w.addClass("int-err");d.show();H=false}}g.phone=function(){var N=m.phone,M=j.trim(N.val()),K=m.msgBox.eq(0),L=m.msgText.eq(0);M=M==G.phone.defaults?"":M;K.show();if(M!=""&&!XF.Validate.phoneMobile(M)){N.addClass("int-err");L.html(G.phone.format);return false}else{if(M==""){N.addClass("int-err");L.html(G.phone.empty);return false}else{N.removeClass("int-err");K.hide();return true}}};g.imgCode=function(){var N=m.imgCode,M=j.trim(N.val()),K=m.msgBox.eq(1),L=m.msgText.eq(1);M=M==G.code.defaults?"":M;K.show();if(M!=""&&M.length!=4){N.addClass("int-err");L.html(G.code.format);return false}else{if(M==""){N.addClass("int-err");L.html(G.code.empty);return false}else{N.removeClass("int-err");K.hide();return true}}};g.smsCode=function(){var N=m.smsCode,M=j.trim(N.val()),K=m.msgBox.eq(2),L=m.msgText.eq(2);M=M==G.smscode.defaults?"":M;K.show();if(M!=""&&!XF.Validate.smsCode(M)){N.addClass("int-err");L.html(G.smscode.format);return false}else{if(M==""){N.addClass("int-err");L.html(G.smscode.empty);return false}else{N.removeClass("int-err");K.hide();return true}}};g.isShowCode=function(){if(m.isShow.is(":visible")){return g.imgCode()}else{return true}};function s(){var M=j.now(),K,L=m.refreshBtn.prev();K=L.attr("src").substr(0,L.attr("src").length-13)+M;L.attr("src",K)}function o(N,K,M){var L={phone:K,guid:XF.Vars.guid,type:1};if(m.isShow.is(":visible")){L.imagecode=j.trim(m.imgCode.val())}j.ajax({url:"/vcode/mobilecode/",type:"post",dataType:"json",data:L,success:function(P){var O,R,Q,S;O=m.msgBox.eq(0),R=m.msgText.eq(0),Q=m.msgBox.eq(1),S=m.msgText.eq(1);if(P.rst>0){f(N,M);O.hide();Q.hide()}else{if(P.rst==-3){m.isShow.show();Q.show();m.imgCode.addClass("int-err");S.html(P.msg)}else{if(m.isShow.is(":visible")){Q.show();m.imgCode.addClass("int-err");S.html(P.msg)}else{O.show();msg.html(P.msg)}}}}})}function f(M,L){if(L==0){M.removeAttr("disabled");M.removeClass("f-getcode-dis");M.text("发送短信验证码");L=L;D()}else{M.attr("disabled","disabled");M.addClass("f-getcode-dis");M.text(L+"秒后重新发送");M.off("click.xfsend");L--;var K=setTimeout(function(){f(M,L)},1000)}}m.refreshBtn.on("click.xfrefresh",function(){s()});function D(){m.verfiyBtn.on("click.xfsend",function(){var K=j.trim(m.phone.val());if(g.phone()&&g.isShowCode()){o(j(this),K,60)}})}D();b.on("click.line",function(){var O=j(this);var Q=O.attr("data-soj");Q&&v.sendSoj('{"from": "'+Q+'"}');var N=j.trim(m.phone.val()),R=j.trim(w.val()),K=j.trim(m.smsCode.val()),M=j.trim(m.imgCode.val()),L=t.val();a.hide();if(g.phone()&&g.isShowCode()&&g.smsCode()){var P={num:1,name:R,line_id:k.lid,tel:N,apply_source:L,tuangou_id:k.data.tuangou_id,code:K,imgCode:M};j.post("/aifang/web/kft/ajax/applycheck/",P,function(T){var S,U;S=m.msgBox.eq(2),U=m.msgText.eq(2);if(T.status==0){a.hide();S.hide();a.eq(0).show()}else{a.hide();h.text(T.msg);a.eq(1).show()}if(T.error_code==E.kftErrCode.vcodeError){S.show();m.smsCode.addClass("int-err");U.text("短信验证码错误")}else{if(T.error_code==E.kftErrCode.vcodeExpired){S.show();m.smsCode.addClass("int-err");U.text("短信验证码过期")}else{u.close();r.open()}}},"json")}});v.sendSoj=function(M){try{var K=new SiteTracker("anjuke-npv");K.setPage(E.sojData.p);K.setPageName(E.sojData.pn);var N=function(){var O="";try{O=window.top.document.referrer}catch(Q){if(window.parent){try{O=window.parent.document.referrer}catch(P){O=""}}}if(O===""){O=document.referrer}return O};K.setReferer(N());K.setNGuid("aQQ_ajkguid");K.setCustomParam(M);K.track()}catch(L){}}})(XF.Kft.SignUp,XF.Vars,jQuery);(function(j){var x=j(".activity-mod"),r=x.find(".acti-special"),B=x.find(".acti-line");var t=j(".modal-special-bd");var w=new XF.Modal({modalClass:"modal-custom apply-modal kanfang-modal",title:"专场看房报名",bd:t,width:"560"});r.on("click.special",function(){w.open()});var g=j(".modal-special-status");var m=new XF.Modal({modalClass:"modal-custom apply-modal kanfang-modal",title:"专场看房报名",bd:g,width:"560",height:"400"});var l=t.find(".tel-box input"),y=t.find(".tel-box .com-msg"),u=y.find("span"),A=t.find(".btn"),k=j("#tuangou_id").val();l.one("focus.special",function(){l.val("")});A.on("click.special",function(){var E=j.trim(l.val()),F=t.find(".check-box input").is(":checked"),D=g.find(".apply-tips").hide();(!E||E=="请输入您的手机号码")?u.text("手机号码不能为空!"):u.text("手机格式错误!");if(XF.Validate.phoneMobile(E)){l.removeClass("int-err");y.hide();j.post("/aifang/web/loupan/ajax/tuangou/",{tid:k,uphone:E},function(G){if(G.status==0){w.close();m.open();F?D.eq(0).show():D.eq(1).show()}else{w.close();m.open();D.eq(2).show()}},"json")}else{l.addClass("int-err");y.show()}});r.on("click.zsendsoj",function(){XF.Soj.send("{from:click_loupan_index_activity_zhuan}",XF.Soj.param)});var c=j(".loan_box");var v=new XF.Modal({modalClass:"modal-custom loan_dialog",title:"新房首付贷申请",bd:c,width:"600",height:"592"});var C=j(".loan_success");var o=new XF.Modal({modalClass:"modal-custom loan_dialog",title:"新房首付贷申请",bd:C,width:"600",height:"552"});var p=j(".loan_fail");var q=new XF.Modal({modalClass:"modal-custom loan_dialog",title:"新房首付贷申请",bd:p,width:"600",height:"552"});j("#do-loan-entrance").click(function(){v.open()});j("#do-loan-entrance_link").click(function(){v.open()});var f={dataBox:j(".loan_box"),dataInputs:j(".loan_box .loanInput"),checkboxes:j(".loan_box [name=repayment_period]"),money:j(".loan_box [name=loan_amount]"),name:j(".loan_box [name=name]"),phone:j(".loan_box [name=phone]"),vcode:j(".loan_box [name=vcode]"),code:j(".loan_box [name=code]"),imgCode:j(".loan_box .vimg"),imgBtn:j(".loan_box .lp-refresh"),loupan_id:j(".loan_box #j-loupan-id"),corp_id:j(".loan_box #j-corp-id"),city_id:j(".loan_box #j-city-id"),codeBtn:j(".loan_box #yzmbtn"),smtBtn:j(".loan_box .data_confirm>a")};var h={};var b={money:{defaults:"请输入金额",empty:"借款金额不能为空",format:"借款金额为数字",min:"借款金额不能小于30000元",max:"借款金额不能大于500000元"},uname:{defaults:"请输入姓名",empty:"姓名不能为空",format:"姓名填写有误"},phone:{defaults:"请输入您的手机号码",empty:"手机号码不能为空",format:"手机号码填写有误"},vcode:{defaults:"请输入验证码",empty:"验证码不能为空",format:"验证码错误"},code:{defaults:"请输入手机验证码",empty:"动态密码不能为空",format:"手机验证码错误"}};f.dataInputs.on({"focus.input":function(){var D=j(this),E=D.val();if(j.trim(E)==D.prop("placeholder")){D.val("")}D.addClass("in-focus")},"blur.input":function(){var D=j(this);D.removeClass("in-focus").val(j.trim(D.val()))}});f.checkboxes.on("click",function(){var D=j(this);if(D.is(":checked")){f.checkboxes.prop("checked",false)}D.prop("checked",true)});f.money.on({"blur.ckmoney":function(){h.money()}});h.money=function(){var E=f.money;var G=j.trim(E.val()),D;function F(K){if(K.length<3){return K}if(!/^(\+|-)?(\d+)(\.\d+)?$/.test(K)){return K}var I=RegExp.$1,H=RegExp.$2,L=RegExp.$3;var J=new RegExp();J.compile("(\\d)(\\d{3})(,|$)");while(J.test(H)){H=H.replace(J,"$1,$2$3")}return I+""+H+""+L}G=F(G);G=G==b.money.defaults?"":G;E.val(G);D=G.replace(/[,'"]/g,"");if(isNaN(D)&&D!=""){s(E,b.money.format);return false}else{if(D==""){s(E,b.money.empty);return false}else{if(D<30000){s(E,b.money.min);return false}else{if(D>500000){s(E,b.money.max);return false}else{z(E);return true}}}}};f.name.on({"blur.ckname":function(){h.name()}});h.name=function(){var D=f.name;var F=j.trim(D.val());function E(H){var G=/^[\u4E00-\u9FA5]{2,18}$/;return G.test(H)}F=F==b.uname.defaults?"":F;D.val(F);if(F!=""&&!E(F)){s(D,b.uname.format);return false}else{if(F==""){s(D,b.uname.empty);return false}else{z(D);return true}}};f.phone.on({"blur.ckname":function(){h.phone()}});h.phone=function(){var D=f.phone;var E=j.trim(D.val());E=E==b.phone.defaults?"":E;D.val(E);if(E!=""&&!XF.Validate.phoneMobile(E)){s(D,b.phone.format);return false}else{if(E==""){s(D,b.phone.empty);return false}else{z(D);return true}}};var d=function(){f.codeBtn.on({"click.code":function(){var D=j.trim(f.phone.val()),E=j.trim(f.vcode.val());if(h.phone()){j.ajax({url:"/ajkfinance/ajax/mobilecode",type:"post",dataType:"json",data:{phone:D,imagecode:E},success:function(F){if(F.rst>0){e(j(f.codeBtn),60)}else{if(F.rst==-1){j(f.code).addClass("f-int-err");s(f.code,"获取动态密码失败")}else{if(F.rst==-2){j(f.code).addClass("f-int-err");s(f.code,"获取动态密码失败")}else{if(F.rst==-3){j(f.vcode).addClass("f-int-err");s(f.vcode,"验证码不能为空")}else{if(F.rst==-4){j(f.vcode).addClass("f-int-err");s(f.vcode,"验证码错误")}else{if(F.rst==-5){j(f.vcode).addClass("f-int-err");s(f.vcode,"验证码已过期，请刷新后再输入")}}}}}}}})}}})};d();function e(F,E){if(E==0){F.removeClass("f-getcode-dis");F.text("重新获取");d();E=E}else{F.addClass("f-getcode-dis");F.text("("+E+")");F.off("click.code");E--;var D=setTimeout(function(){e(F,E)},1000)}}j(f.imgBtn).on({"click.vcodebtn":function(){n()}});f.vcode.on({"blur.ckvcode":function(){h.vcode()}});h.vcode=function(){var D=f.vcode,F=j.trim(D.val());F=F==b.vcode.defaults?"":F;function E(G){return G.length==4}if(F!=""&&!E(F)){s(D,b.vcode.format);return false}else{if(F==""){s(D,b.vcode.empty);return false}else{z(D);return true}}};f.code.on({"blur.ckcode":function(){h.code()}});h.code=function(){var D=f.code,F=j.trim(D.val());F=F==b.code.defaults?"":F;function E(G){return/^\d{6}$/.test(G)}if(F!=""&&!E(F)){s(D,b.code.format);return false}else{if(F==""){s(D,b.code.empty);return false}else{z(D);return true}}};f.smtBtn.on({"click.submit":function(){if(a()){var D={city_id:f.city_id.val(),loupan_id:f.loupan_id.val(),corp_id:f.corp_id.val(),loan_amount:f.money.val().replace(/[,'"]/g,""),repayment_period:f.checkboxes.filter(":checked").val(),name:f.name.val(),phone:f.phone.val(),code:f.code.val()};j.ajax({url:"/ajkfinance/ajax/loanapply",type:"post",dataType:"json",data:D,success:function(E){if(E.status==0){v.close();o.open()}else{if(E.status==-201){s(f.code,E.msg)}else{console.log(E.status+"::"+E.msg);v.close();q.open()}}}})}}});function a(){var D=true;for(var F in h){var E=h[F]();if(!E){D=false}}return D}function n(){var F=j.now(),D,E=j(f.imgCode);D=E.attr("src").substr(0,E.attr("src").length-13)+F;E.attr("src",D)}var s=function(E,F){var D=E.parent().find(".com-msg");E.addClass("in-err");D.show().find("span").text(F)};var z=function(E,F){var D=E.parent().find(".com-msg");E.removeClass("in-err");D.hide().find("span").html(F||"")}})(jQuery);(function(c){var f=c(".j-huxing-mfth"),b=c(".j-huxing-ljth"),e=c(".j-huxing-yyhd");var a=APF.Utils.getCookie("xf_400_free");var d=new Date().getHours();if(d>=8&&d<19){if(a){b.addClass("make-call2").show()}else{f.addClass("make-freecall2").show()}}else{e.addClass("order-callback2").show()}c(".j-huxing-dy").on("click",function(){XF.Soj.send("{from:loupan_index_huxing_dy}",XF.Soj.param)});c(".j-huxing-mfth").on("click",function(){XF.Soj.send("{from:loupan_index_huxing_th}",XF.Soj.param)});c(".j-huxing-ljth").on("click",function(){XF.Soj.send("{from:loupan_index_huxing_th}",XF.Soj.param)});c(".j-huxing-yyhd").on("click",function(){XF.Soj.send("{from:loupan_index_huxing_th}",XF.Soj.param)})})(jQuery);(function(d){var f=new XF.Switch({switchST:"#j-switch-district",effect:"none"});var e=d("#j-switch-district").find(".map-mark");var c=d("#j-switch-district").find(".pnav");var b=c.length;if(b==1){c.css({border:"none"})}c.on("click.empty",function(){a()});function a(){e.each(function(){d(this).on({"mouseenter.district":function(){d(this).addClass("map-mark-hover")},"mouseleave.district":function(){d(this).removeClass("map-mark-hover")}});d(this).css({"margin-left":-d(this).outerWidth()/2,"margin-top":-d(this).outerHeight()-8}).show()})}a()})(jQuery);$(function(){window.switchDistinfo=new XF.Switch({switchST:"#j-switch-distinfo",clipST:".dist-clip",conST:"ul",itemST:"li",prevST:"#j-switch-distinfo .prev",nextST:"#j-switch-distinfo .next",switchNum:5,clipNum:5});var c=$("#j-switch-distinfo .dist-clip").find("li"),a=$("#j-dist-content .dist-items"),e=$(".dis-con .dist-map").find(".map-mark");function b(){$(c).eq(0).addClass("active").siblings().removeClass("active");$(a).eq(0).show().siblings().hide();$(e).eq(0).addClass("map-mark-active").siblings().removeClass("map-mark-active");$(c).on("click",function(){var f=$(c).index($(this));$(this).addClass("active").siblings().removeClass("active");$(a).eq(f).show().siblings().hide();$(e).eq(f).addClass("map-mark-active").siblings().removeClass("map-mark-active");XF.Soj.send("{from:loupan_index_lpnum}",XF.Soj.param)});$(e).on("click",function(){var f=$(e).index($(this)),g=Math.floor(f/5);switchDistinfo.switchTo(g*5)+1;$(c).eq(f).addClass("active").siblings().removeClass("active");$(a).eq(f).show().siblings().hide();$(this).addClass("map-mark-active").siblings().removeClass("map-mark-active");XF.Soj.send("{from:loupan_index_detail}",XF.Soj.param)})}function d(){e.each(function(){$(this).on({"mouseenter.district":function(){$(this).addClass("map-mark-hover")},"mouseleave.district":function(){$(this).removeClass("map-mark-hover")}});$(this).css({"margin-left":-$(this).outerWidth()/2,"margin-top":-$(this).outerHeight()-8}).show()})}d();b()});APF.Namespace.register("life.map");(function(j,c){var a=j;var g={list:'<li id="{% id %}"><i class="map-icon icon  {% icon %} "></i><p class="text"> {% title %} <span class="gray"> （{% detail %}） </span></p><span class="distance gray"> {% distance %} 米</span></li>',icon:'<div id="{% id %}" class="mark-icon-box"><i class="map-icon mark-icon {% icon %}"></i></div>',detail:'<div id="{% id %}" class="mark-tip" style="display:none"><i class="mark-tip-sign"></i><div class="title"><span>{% title %}</span><b>{% distance %}米</b></div>{%detail%}<i class="map-icon icon"></i></div>',pan:'<div class="life-mark"><div class="text yahei">{% panName %}</div><i class="map-icon icon"></i></div>'};var d={bus:{icon:"bus"},subway:{icon:"met"},bank:{icon:"bank"},market:{icon:"buy"},restaurant:{icon:"bin"},hospital:{icon:"hos"},school:{icon:"sch"}};var e={tra:["subway","bus"],biz:["market","bank","restaurant"],hos:["hospital"],edu:["school"]};var h={tra:{soj:"{from:loupan_index_traffic}",type:"2公里内的交通设施",subway:"{%num%}条地铁",bus:"{%num%}个公交站"},biz:{soj:"{from:loupan_index_commeric}",type:"2公里内的商业设施",market:"购物{%num%}处",bank:"银行{%num%}处",restaurant:"餐饮{%num%}处"},edu:{soj:"{from:loupan_index_education}",type:"2公里内的教育设施",school:"学校{%num%}处"},hos:{soj:"{from:loupan_index_hospital}",type:"2公里内的医院设施",hospital:"医院{%num%}处"}};function f(l,n){var k={tab:"tra",type:"subway",shift:{x:14,y:36},marker:"",done:function(){}};var m=c.extend({},k,n);this._point=l;this.tab=m.tab;this.type=m.type;this.shift=m.shift;this.marker=m.marker;this.done=m.done}f.prototype=new BMap.Overlay();f.prototype.initialize=function(k){this.map=k;this.marker=c(this.marker);k.getPanes().markerPane.appendChild(this.marker[0]);return this.marker[0]};f.prototype.draw=function(){var k=this.map.pointToOverlayPixel(this._point);this.marker.css({left:k.x-this.shift.x+"px",top:k.y-this.shift.y+"px"});this.done()};function b(q,m,p,n){var l={distance:2000,keywords:[{key:"地铁",property:"subway"},{key:"公交",property:"bus"},{key:"购物",property:"market"},{key:"银行",property:"bank"},{key:"餐饮",property:"restaurant"},{key:"学校",property:"school"},{key:"医院",property:"hospital"}],success:q.success};var o=c.extend({},l,p);function k(r,y,x){var u={},w=[],v=[];for(var s=0;s<x.keywords.length;s++){w[s]=x.keywords[s].key;v[s]=x.keywords[s].property}var z={onSearchComplete:function(D){if(t.getStatus()==BMAP_STATUS_SUCCESS){for(var B=0;B<D.length;B++){var A=D[B].keyword;var E=[];for(var C=0;C<D[B].getCurrentNumPois();C++){E.push({title:D[B].getPoi(C).title,address:D[B].getPoi(C).address,distance:q.getDistance(D[B].getPoi(C).point,y).toFixed(0),point:D[B].getPoi(C).point,type:v[B]})}u[v[B]]=E}}else{u={bank:[],bus:[],subway:[],market:[],restaurant:[],school:[],hospital:[]}}n.nearbyData=u;x.success(u)},pageCapacity:25};var t=new BMap.LocalSearch(q,z);t.searchNearby(w,m,o.distance)}return k(q,m,o)}a.Bmap=function(n){var k={panName:"远洋7号",lng:121.35344347526,lat:31.410946548636,mapId:"map-box",initList:{type:"tra",include:["subway","bus"]}};var m=c.extend({},k,n);var l=this;l.op=m;l.point=new BMap.Point(m.lng,m.lat);l.map=new BMap.Map("map-box");l.map.centerAndZoom(l.point,14);l.map.addControl(new BMap.NavigationControl());l.success=function(){l.drawPan();l.drawList(l.nearbyData,l.op.initList);l.drawDetail();l.drawPoint();l.addHover();l.addControl();XF.Soj.send(h[l.op.initList.type].soj,XF.Soj.param)};b(l.map,l.point,{success:l.success},l)};a.Bmap.prototype.drawPan=function(){var m=XF.render(g.pan,{panName:this.op.panName});var n={shift:{x:0,y:38},marker:m,done:function(){var o=this;var p=o.marker.outerWidth();o.marker.css("marginLeft",Math.floor(0-p/2)+"px")}};var k=new f(this.point,n);var l=new BMap.Circle(this.point,2000,{strokeColor:"#62ab00",strokeWeight:1,strokeOpacity:0.4});this.map.addOverlay(k);this.map.addOverlay(l)};a.Bmap.prototype.drawPoint=function(){for(var l=0;l<this.listData.length;l++){var m=this.listData[l].point;var o="icon-"+l;var n={tab:this.tab,type:this.listData[l].type,shift:{x:14,y:36},marker:XF.render(g.icon,{icon:d[this.listData[l].type].icon,id:o}),done:function(){}};var k=new f(m,n);this.map.addOverlay(k)}};a.Bmap.prototype.drawList=function(l,m){var n=[];var q="";var r=c("#life-list");var p=c("#life-list-count");var u=c("#life-list-type");var t=[];this.tab=m.type;for(var k=0;k<m.include.length;k++){n=n.concat(l[m.include[k]]);var o=l[m.include[k]].length;var s=h[m.type][m.include[k]];if(o>0){t.push(XF.render(s,{num:o}))}}this.listData=n.sort(function(w,x){return w.distance-x.distance});if(n.length==0){u.html(h[m.type].type);p.html("暂无数据")}else{if(n.length>0){u.html(h[m.type].type);p.html(t.join("、"))}}for(var k=0;k<n.length;k++){var v={id:"list-"+k,icon:d[n[k].type].icon,title:n[k].title,detail:n[k].address,distance:n[k].distance};q+=XF.render(g.list,v)}r.html(q)};a.Bmap.prototype.drawDetail=function(){for(var l=0;l<this.listData.length;l++){var m=this.listData[l].point;var n={tab:this.tab,type:this.listData[l].type,shift:{x:-120,y:49},marker:XF.render(g.detail,{id:"detail-"+l,title:this.listData[l].title,distance:this.listData[l].distance,detail:this.tab=="tra"?'<div class="content">'+this.listData[l].address+"</div>":""}),done:function(){var o=this;var p=o.marker.outerWidth();var q=o.marker.outerHeight();o.marker.css({marginLeft:0-p/2,marginTop:0-q})}};var k=new f(m,n);this.map.addOverlay(k)}};a.Bmap.prototype.addHover=function(){var k=this;c("#map-box").off("mouseover mouseout",".mark-icon-box");c("#life-list").off("mouseover mouseout","li");c("#map-box").on("mouseover mouseout",".mark-icon-box",function(n){var l=c("#"+c(this).attr("id").replace(/icon/,"detail"));var m=c("#"+c(this).attr("id").replace(/icon/,"list"));if(n.type=="mouseover"){l.show();m.addClass("active");m.find(".text").css("color","#ff6500")}else{l.hide();m.removeClass("active");m.find(".text").css("color","#333")}});c("#life-list").on("mouseover mouseout","li",function(n){var m=c("#"+c(this).attr("id").replace(/list/,"detail"));var l=c("#"+c(this).attr("id").replace(/list/,"icon"));if(n.type=="mouseover"){c(this).find(".text").css("color","#ff6500");c(this).addClass("active");l.addClass("life-map-active");m.show()}else{c(this).find(".text").css("color","#333");c(this).removeClass("active");l.removeClass("life-map-active");m.hide()}})};a.Bmap.prototype.addControl=function(){var k=this;c("#life-tab").on("click","li",function(m){if(!c(this).hasClass("active")){var l=c(this).attr("id").replace(/life-tab-/,"");var n=c("#life-tab li.active");n.removeClass("active");c(this).addClass("active");k.map.clearOverlays();k.drawPan();k.drawList(k.nearbyData,{type:l,include:e[l]});k.drawDetail();k.drawPoint();k.addHover();XF.Soj.send(h[l].soj,XF.Soj.param)}})}})(life.map,jQuery);(function(a){XF.nameSpace("Loupan.Map");Loupan.Map=function(c){var b=new life.map.Bmap(c)}})(jQuery);(function(a){a.fn.extend({drawLine:function(f){var f,g;f=a.extend({colors:["#44a1f7","#F8CE5D","#339966"],ydata:[],xdata:null,formatterFn:function(){}},f||{});function b(){var m,l,n=[],k=[];l=arguments.length;for(m=0;m<l;m++){n.push(arguments[m])}if(k.length===0){k=n[0]}for(m=1;m<l;m++){k=h(k,n[m])}return k}function h(t,r){var n,m,l,p,o,q,s=[];p=t.length;o=r.length;q=p+o;for(n=0,m=0,l=0;l<q;l++){if(n<p&&(m>=o||t[n]<r[m])){s.push(t[n++])}else{s.push(r[m++])}}return s}function c(){var l=f.ydata[0].data;var m=f.ydata[1].data;var o=f.ydata[2].data;var n=b(l,m,o);var k;k=a.inArray(0,n);if(k==-1){f.setMin=null}else{f.setMin=0}}c();var j=f.ydata[2].data.reverse();for(var d in j){if(j[d]==null){continue}j[d]={y:j[d],marker:{symbol:"url(http://pages.aifcdn.com/img/house/view/self-flat.png)"}};break}f.ydata[2].data=j.reverse();var e=new Highcharts.Chart({colors:f.colors,chart:{renderTo:this.attr("id"),type:"line"},title:{text:""},subtitle:{text:""},xAxis:{categories:f.xdata,tickmarkPlacement:"on",labels:{style:{fontSize:"14px",fontFamily:"Microsoft YaHei"},y:25}},yAxis:{title:"",gridLineColor:"#D9D9D9",opposite:true,labels:f.labels,min:f.setMin},tooltip:{crosshairs:true,useHTML:true,borderWidth:2,borderColor:"#999999",borderRadius:0,backgroundColor:"#FFFFFF",style:{padding:"8px"},shared:true,formatter:f.formatterFn},legend:{enabled:false},plotOptions:{line:{fillOpacity:f.Opacity,marker:{symbol:"circle",radius:5,lineWidth:1}}},series:f.ydata})}})})(jQuery);(function(b){XF.nameSpace("XF.Pricecurve");var a=null;XF.Pricecurve.drawPriceCurve=function(f,e){var c=b("#price-charts");var d=b(window).scrollTop()+b(window).height()-c.offset().top;if(c.length){if(d>=0){a||c.drawLine({colors:["#5689D6","#BF5A2F","#62AB00"],ydata:f.ydata,xdata:f.xdata,labels:{formatter:function(){if(this.value==0){return"待定"}else{return this.value+"元"}},style:{fontSize:"14px",fontFamily:"Microsoft YaHei"},y:3},formatterFn:function(){var g=f.years[this.x]+this.x+"<table>";b.each(this.points,function(k,h){var l='<tr><td class="tooltip-title"><i class="{% className %}">●</i>{% tipName %}</td><td class="tooltip-price">';l+="{%> if(valY== 0){ %}";l+='<em class="undete">待定</em>';l+="{%> } %}";l+="{%> else{ %}";l+='<em class="price">{% valY %}</em>元/m²';l+="{%> } %}";l+="</td></tr>";if(this.series.name=="本楼盘"){var j=XF.render(l,{tipName:this.series.name,valY:h.y,className:"tooltip-dot dot-a"})}else{if(this.series.name==e+"新房"){var j=XF.render(l,{tipName:this.series.name,valY:h.y,className:"tooltip-dot dot-b"})}else{var j=XF.render(l,{tipName:this.series.name,valY:h.y,className:"tooltip-dot dot-c"})}}g+=j});g+="</table>";return g}});a=true;b(window).off("scroll.charts.price")}}}})(jQuery);$.fn.extend({drawPie:function(b){var b=$.extend({colors:["#23A0E2","#FC6300"],Suffix:"",databox:[]},b||{});var a=new Highcharts.Chart({colors:b.colors,chart:{renderTo:this.attr("id"),type:"pie",height:b.height,backgroundColor:"#f9f9f9"},title:{text:""},credits:{enabled:false},yAxis:{title:""},tooltip:{enabled:false},plotOptions:{pie:{allowPointSelect:true,cursor:"pointer",dataLabels:{enabled:false},shadow:false}},series:b.databox})}});(function($){XF.nameSpace("XF.View.Calculator");XF.nameSpace("XF.Soj.Calculator.param");XF.View.Calculator=function(op){var self=this;self.totalPrice=0;self.loanPrice=0;self.op=$.extend({},XF.View.Calculator._default_settings,op);self.initialize()};XF.View.Calculator._default_settings={valHouseType:"",lblTotalPrice:"",valLoanRatio:"",valLoanType:"",valLoanMonth:"",valLoanFund:"",valLoanBussness:"",lblScaleTotalPrice:"",subContentSclae:"",subContentChart:"",intUnitPrice:0,btnStartup:"",intCalType:1};XF.View.Calculator.prototype.initialize=function(){var self=this,op=self.op;self.init_form(op)};XF.View.Calculator.prototype.init_form=function(option){var self=this;var objSelect=new XF.Select({selectST:".calculator-mod .xf-select"});$(objSelect).on("change",function(evt,input){switch("#"+input.attr("id")){case option.valHouseType:case option.valLoanRatio:self.update_totalprice();break;case option.valLoanType:if(input.val()==3){$(option.subContentSclae).show()}else{$(option.subContentSclae).hide()}break;default:}});self.update_totalprice();$(option.btnStartup).click(function(){if(self.check_data()==true){self.calculate();var data="{from:calculator}";var op=XF.Soj.Calculator.param;XF.Soj.send(data,op)}});if(self.check_data()==true){self.calculate()}};XF.View.Calculator.prototype.isNumber=function(s){var regu=/^(\d*\.)?\d+$/;var re=new RegExp(regu);return re.test(s)};XF.View.Calculator.prototype.update_totalprice=function(){var self=this;var houseTypeData=$(self.op.valHouseType).val().split("_");switch(houseTypeData[0]){case"1":self.op.intUnitPrice=self.op.intUnitPrice1;break;case"2":self.op.intUnitPrice=self.op.intUnitPrice2;break;case"3":self.op.intUnitPrice=self.op.intUnitPrice3;break;default:self.op.intUnitPrice=0;break}self.area=houseTypeData[1];self.totalPrice=Math.round(self.area*self.op.intUnitPrice/10000);self.loanPrice=Math.round(self.totalPrice*$(self.op.valLoanRatio).val()/100);var strTotalPrice="<p><strong>"+self.totalPrice+"</strong>万元<span>（均价<em>"+self.op.intUnitPrice+"</em>元/m² × 面积"+self.area+"m²）</span></p>";var strLoanPrice="（贷款总额"+self.loanPrice+"万）";$(self.op.lblTotalPrice).html(strTotalPrice);$(self.op.lblScaleTotalPrice).html(strLoanPrice)};XF.View.Calculator.prototype.check_data=function(bolDispErr){var self=this,intResult=true;if($(self.op.valHouseType).val()<=0){intResult=false}if($(self.op.valLoanType).val()==3){var FunVal=$(self.op.valLoanFund).val().replace(/(^\s*)|(\s*$)/g,"");var BussnessVal=$(self.op.valLoanBussness).val().replace(/(^\s*)|(\s*$)/g,"");if(FunVal!=""&&!self.isNumber(FunVal)){$(self.op.valLoanFund).addClass("int-err");$(self.op.valLoanFund).parent().find(".com-msg").css("display","inline-block").find("span").text("金额错误!");$(self.op.valLoanBussness).removeClass("int-err");$(self.op.valLoanBussness).parent().find(".com-msg").css("display","none");return false}if(BussnessVal!=""&&!self.isNumber(BussnessVal)){$(self.op.valLoanBussness).addClass("int-err");$(self.op.valLoanBussness).parent().find(".com-msg").css("display","inline-block").text("金额错误!");$(self.op.valLoanFund).removeClass("int-err");$(self.op.valLoanFund).parent().find(".com-msg").css("display","none");return false}if(FunVal==""&&BussnessVal==""){$(self.op.valLoanFund).addClass("int-err");$(self.op.valLoanFund).parent().find(".com-msg").css("display","inline-block").find("span").text("不能为空！");$(self.op.valLoanBussness).addClass("int-err");$(self.op.valLoanBussness).parent().find(".com-msg").css("display","inline-block").find("span").text("不能为空！");intResult=false}else{if(FunVal!=""&&BussnessVal!=""){if(parseFloat(FunVal)+parseFloat(BussnessVal)!=self.loanPrice){$(self.op.valLoanFund).addClass("int-err");$(self.op.valLoanFund).parent().find(".com-msg").css("display","inline-block").find("span").text("总额错误！");$(self.op.valLoanBussness).addClass("int-err");intResult=false}else{$(self.op.valLoanFund).removeClass("int-err");$(self.op.valLoanFund).parent().find(".com-msg").css("display","none");$(self.op.valLoanBussness).removeClass("int-err");$(self.op.valLoanBussness).parent().find(".com-msg").css("display","none")}}else{if(FunVal!=""&&BussnessVal==""){if(self.loanPrice-parseFloat(FunVal)<0){$(self.op.valLoanFund).addClass("int-err");$(self.op.valLoanFund).parent().find(".com-msg").css("display","inline-block").find("span").text("金额错误!");$(self.op.valLoanBussness).addClass("int-err");intResult=false}else{$(self.op.valLoanFund).val(parseFloat(FunVal).toFixed(0));$(self.op.valLoanBussness).val((self.loanPrice-parseFloat(FunVal)).toFixed(0));$(self.op.valLoanFund).removeClass("int-err");$(self.op.valLoanFund).parent().find(".com-msg").css("display","none");$(self.op.valLoanBussness).removeClass("int-err");$(self.op.valLoanBussness).parent().find(".com-msg").css("display","none")}}else{if(BussnessVal!=""&&FunVal==""){if(self.loanPrice-parseFloat(BussnessVal)<0){$(self.op.valLoanBussness).addClass("int-err");$(self.op.valLoanBussness).parent().find(".com-msg").css("display","inline-block").text("金额错误!");$(self.op.valLoanFund).addClass("int-err");intResult=false}else{$(self.op.valLoanBussness).val(parseFloat(BussnessVal).toFixed(0));$(self.op.valLoanFund).val((self.loanPrice-parseFloat(BussnessVal).toFixed(0)).toFixed(0));$(self.op.valLoanFund).removeClass("int-err");$(self.op.valLoanFund).parent().find(".com-msg").css("display","none");$(self.op.valLoanBussness).removeClass("int-err");$(self.op.valLoanBussness).parent().find(".com-msg").css("display","none")}}}}}}return intResult};XF.View.Calculator.prototype.calculate=function(){var self=this;var rates=XF.View.Calculator.rate;var intLoanBussiness=0;var intLoanFund=0;var intRateBussiness=0;var intRateFund=0;var intMonths=$(self.op.valLoanMonth).val();var floatMonthlyRepayBuss=0;var floatMonthlyRepayFund=0;var floatRateFund=rates.fund["rate"]["6"];var floatRateBussiness=eval("rates['commerce']['2']['rate']['6']");if(intMonths<=5*12){floatRateFund=rates.fund["rate"]["1"];floatRateBussiness=eval("rates['commerce']['2']['rate']['4']")}if(intMonths<=1*12){floatRateBussiness=eval("rates['commerce']['2']['rate']['1']")}var floatMonthlyRateFund=floatRateFund/12;var floatMonthlyRateBussiness=floatRateBussiness/12;switch($(self.op.valLoanType).val()){case"1":intLoanFund=0;intLoanBussiness=self.loanPrice;break;case"2":intLoanFund=self.loanPrice;intLoanBussiness=0;break;case"3":intLoanFund=$(self.op.valLoanFund).val();intLoanBussiness=$(self.op.valLoanBussness).val();break}floatMonthlyRepayFund=10000*intLoanFund*floatMonthlyRateFund*[Math.pow((1+floatMonthlyRateFund),intMonths)]/[Math.pow((1+floatMonthlyRateFund),intMonths)-1];floatMonthlyRepayBuss=10000*intLoanBussiness*floatMonthlyRateBussiness*[Math.pow((1+floatMonthlyRateBussiness),intMonths)]/[Math.pow((1+floatMonthlyRateBussiness),intMonths)-1];var arrResult={intMonthlyRepay:Math.round(floatMonthlyRepayFund+floatMonthlyRepayBuss),intFirstPay:Math.round((self.totalPrice-self.loanPrice)),intLoanPrice:self.loanPrice,floatInterest:parseFloat(((floatMonthlyRepayFund+floatMonthlyRepayBuss)*intMonths/10000-self.loanPrice).toFixed(1)),intFirstPayRatio:10-$(self.op.valLoanRatio).val()/10,intLoanRatio:$(self.op.valLoanRatio).val()/10,floatRateFund:(floatRateFund*100).toFixed(2),floatRateBussiness:(floatRateBussiness*100).toFixed(2)};this.render_result(arrResult)};XF.View.Calculator.prototype.render_result=function(objResult){var self=this;$(self.op.subContentChart).parent().find(".price").html(objResult.intMonthlyRepay);$(self.op.subContentChart).parent().find(".legend-pay").find("span").html("参考首付："+objResult.intFirstPay+"万（"+objResult.intFirstPayRatio+"成）");$(self.op.subContentChart).parent().find(".legend-pay").find("a").text("首付够不？点这里");$(self.op.subContentChart).parent().find(".legend-price").find("span").html("贷款金额："+objResult.intLoanPrice+"万（"+objResult.intLoanRatio+"成）");if(XF.View.Calculator.is_commercial==1){$(self.op.subContentChart).parent().find(".legend-rate").find("span").html("支付利息："+objResult.floatInterest+"万<em><br />（利率商业性"+objResult.floatRateBussiness+"%）</em>")}else{$(self.op.subContentChart).parent().find(".legend-rate").find("span").html("支付利息："+objResult.floatInterest+"万<em><br />（利率公积金"+objResult.floatRateFund+"%，商业性"+objResult.floatRateBussiness+"%）</em>")}var arrPieData=[{name:"参考首付",y:objResult.intFirstPay,events:{mouseOver:function(){$(".legend-pay").addClass("curr")},mouseOut:function(){$(".legend-pay").removeClass("curr")}}},{name:"贷款金额",y:objResult.intLoanPrice,events:{mouseOver:function(){$(".legend-price").addClass("curr")},mouseOut:function(){$(".legend-price").removeClass("curr")}}},{name:"支付利息",y:objResult.floatInterest,events:{mouseOver:function(){$(".legend-rate").addClass("curr")},mouseOut:function(){$(".legend-rate").removeClass("curr")}}}];$(self.op.subContentChart).drawPie({colors:["#2F69BF","#A2BF2F","#BF5A2F"],databox:[{data:arrPieData,innerSize:"47%"}]});if(objResult.intFirstPay==0){$(self.op.subContentChart).html("")}}})(jQuery);(function(a){a(".calculator-mod").find(".tools-item5 input.int-text").on("keyup.calcu",function(){a(this).val(a(this).val().replace(/[^0-9]/,""))})})(jQuery);(function($){XF.nameSpace("XF.View.Calculator");XF.nameSpace("XF.Soj.Calculator.param");XF.View.Calculator=function(op){var self=this;self.totalPrice=0;self.loanPrice=0;self.op=$.extend({},XF.View.Calculator._default_settings,op);self.initialize()};XF.View.Calculator._default_settings={valHouseType:"",lblTotalPrice:"",valLoanRatio:"",valLoanType:"",valLoanMonth:"",valLoanFund:"",valLoanBussness:"",lblScaleTotalPrice:"",subContentSclae:"",subContentChart:"",intUnitPrice:0,btnStartup:"",intCalType:1};XF.View.Calculator.prototype.initialize=function(){var self=this,op=self.op;self.init_form(op)};XF.View.Calculator.prototype.init_form=function(option){var self=this;var objSelect=new XF.Select({selectST:".calculator-mod .xf-select"});$(objSelect).on("change",function(evt,input){switch("#"+input.attr("id")){case option.valHouseType:case option.valLoanRatio:self.update_totalprice();break;case option.valLoanType:if(input.val()==3){$(option.subContentSclae).show()}else{$(option.subContentSclae).hide()}break;default:}});self.update_totalprice();$(option.btnStartup).click(function(){if(self.check_data()==true){self.calculate();var data="{from:calculator}";var op=XF.Soj.Calculator.param;XF.Soj.send(data,op)}});if(self.check_data()==true){self.calculate()}};XF.View.Calculator.prototype.isNumber=function(s){var regu=/^(\d*\.)?\d+$/;var re=new RegExp(regu);return re.test(s)};XF.View.Calculator.prototype.update_totalprice=function(){var self=this;var houseTypeData=$(self.op.valHouseType).val().split("_");switch(houseTypeData[0]){case"1":self.op.intUnitPrice=self.op.intUnitPrice1;break;case"2":self.op.intUnitPrice=self.op.intUnitPrice2;break;case"3":self.op.intUnitPrice=self.op.intUnitPrice3;break;case"4":self.op.intUnitPrice=self.op.intUnitPrice4;break;default:self.op.intUnitPrice=0;break}self.area=houseTypeData[1];self.totalPrice=Math.round(self.area*self.op.intUnitPrice/10000);self.loanPrice=Math.round(self.totalPrice*$(self.op.valLoanRatio).val()/100);var strTotalPrice="<p><strong>"+self.totalPrice+"</strong>万元<span>（均价<em>"+self.op.intUnitPrice+"</em>元/m² × 面积"+self.area+"m²）</span></p>";var strLoanPrice="（贷款总额"+self.loanPrice+"万）";$(self.op.lblTotalPrice).html(strTotalPrice);$(self.op.lblScaleTotalPrice).html(strLoanPrice)};XF.View.Calculator.prototype.check_data=function(bolDispErr){var self=this,intResult=true;if($(self.op.valHouseType).val()<=0){intResult=false}if($(self.op.valLoanType).val()==3){var FunVal=$(self.op.valLoanFund).val().replace(/(^\s*)|(\s*$)/g,"");var BussnessVal=$(self.op.valLoanBussness).val().replace(/(^\s*)|(\s*$)/g,"");if(FunVal!=""&&!self.isNumber(FunVal)){$(self.op.valLoanFund).addClass("int-err");$(self.op.valLoanFund).parent().find(".com-msg").css("display","inline-block").find("span").text("金额错误!");$(self.op.valLoanBussness).removeClass("int-err");$(self.op.valLoanBussness).parent().find(".com-msg").css("display","none");return false}if(BussnessVal!=""&&!self.isNumber(BussnessVal)){$(self.op.valLoanBussness).addClass("int-err");$(self.op.valLoanBussness).parent().find(".com-msg").css("display","inline-block").text("金额错误!");$(self.op.valLoanFund).removeClass("int-err");$(self.op.valLoanFund).parent().find(".com-msg").css("display","none");return false}if(FunVal==""&&BussnessVal==""){$(self.op.valLoanFund).addClass("int-err");$(self.op.valLoanFund).parent().find(".com-msg").css("display","inline-block").find("span").text("不能为空！");$(self.op.valLoanBussness).addClass("int-err");$(self.op.valLoanBussness).parent().find(".com-msg").css("display","inline-block").find("span").text("不能为空！");intResult=false}else{if(FunVal!=""&&BussnessVal!=""){if(parseFloat(FunVal)+parseFloat(BussnessVal)!=self.loanPrice){$(self.op.valLoanFund).addClass("int-err");$(self.op.valLoanFund).parent().find(".com-msg").css("display","inline-block").find("span").text("总额错误！");$(self.op.valLoanBussness).addClass("int-err");intResult=false}else{$(self.op.valLoanFund).removeClass("int-err");$(self.op.valLoanFund).parent().find(".com-msg").css("display","none");$(self.op.valLoanBussness).removeClass("int-err");$(self.op.valLoanBussness).parent().find(".com-msg").css("display","none")}}else{if(FunVal!=""&&BussnessVal==""){if(self.loanPrice-parseFloat(FunVal)<0){$(self.op.valLoanFund).addClass("int-err");$(self.op.valLoanFund).parent().find(".com-msg").css("display","inline-block").find("span").text("金额错误!");$(self.op.valLoanBussness).addClass("int-err");intResult=false}else{$(self.op.valLoanFund).val(parseFloat(FunVal).toFixed(0));$(self.op.valLoanBussness).val((self.loanPrice-parseFloat(FunVal)).toFixed(0));$(self.op.valLoanFund).removeClass("int-err");$(self.op.valLoanFund).parent().find(".com-msg").css("display","none");$(self.op.valLoanBussness).removeClass("int-err");$(self.op.valLoanBussness).parent().find(".com-msg").css("display","none")}}else{if(BussnessVal!=""&&FunVal==""){if(self.loanPrice-parseFloat(BussnessVal)<0){$(self.op.valLoanBussness).addClass("int-err");$(self.op.valLoanBussness).parent().find(".com-msg").css("display","inline-block").text("金额错误!");$(self.op.valLoanFund).addClass("int-err");intResult=false}else{$(self.op.valLoanBussness).val(parseFloat(BussnessVal).toFixed(0));$(self.op.valLoanFund).val((self.loanPrice-parseFloat(BussnessVal).toFixed(0)).toFixed(0));$(self.op.valLoanFund).removeClass("int-err");$(self.op.valLoanFund).parent().find(".com-msg").css("display","none");$(self.op.valLoanBussness).removeClass("int-err");$(self.op.valLoanBussness).parent().find(".com-msg").css("display","none")}}}}}}return intResult};XF.View.Calculator.prototype.calculate=function(){var self=this;var rates=XF.View.Calculator.rate;var intLoanBussiness=0;var intLoanFund=0;var intRateBussiness=0;var intRateFund=0;var intMonths=$(self.op.valLoanMonth).val();var floatMonthlyRepayBuss=0;var floatMonthlyRepayFund=0;var floatRateFund=rates.fund["rate"]["6"];var floatRateBussiness=eval("rates['commerce']['2']['rate']['6']");if(intMonths<=5*12){floatRateFund=rates.fund["rate"]["1"];floatRateBussiness=eval("rates['commerce']['2']['rate']['4']")}if(intMonths<=1*12){floatRateBussiness=eval("rates['commerce']['2']['rate']['1']")}var floatMonthlyRateFund=floatRateFund/12;var floatMonthlyRateBussiness=floatRateBussiness/12;switch($(self.op.valLoanType).val()){case"1":intLoanFund=0;intLoanBussiness=self.loanPrice;break;case"2":intLoanFund=self.loanPrice;intLoanBussiness=0;break;case"3":intLoanFund=$(self.op.valLoanFund).val();intLoanBussiness=$(self.op.valLoanBussness).val();break}floatMonthlyRepayFund=10000*intLoanFund*floatMonthlyRateFund*[Math.pow((1+floatMonthlyRateFund),intMonths)]/[Math.pow((1+floatMonthlyRateFund),intMonths)-1];floatMonthlyRepayBuss=10000*intLoanBussiness*floatMonthlyRateBussiness*[Math.pow((1+floatMonthlyRateBussiness),intMonths)]/[Math.pow((1+floatMonthlyRateBussiness),intMonths)-1];var arrResult={intMonthlyRepay:Math.round(floatMonthlyRepayFund+floatMonthlyRepayBuss),intFirstPay:Math.round((self.totalPrice-self.loanPrice)),intLoanPrice:self.loanPrice,floatInterest:parseFloat(((floatMonthlyRepayFund+floatMonthlyRepayBuss)*intMonths/10000-self.loanPrice).toFixed(1)),intFirstPayRatio:10-$(self.op.valLoanRatio).val()/10,intLoanRatio:$(self.op.valLoanRatio).val()/10,floatRateFund:(floatRateFund*100).toFixed(2),floatRateBussiness:(floatRateBussiness*100).toFixed(2)};this.render_result(arrResult)};XF.View.Calculator.prototype.render_result=function(objResult){var self=this;$(self.op.subContentChart).parent().find(".price").html(objResult.intMonthlyRepay);$(self.op.subContentChart).parent().find(".legend-pay").find("span").html("参考首付："+objResult.intFirstPay+"万（"+objResult.intFirstPayRatio+"成）");$(self.op.subContentChart).parent().find(".legend-pay").find("a").text("首付够不？点这里");$(self.op.subContentChart).parent().find(".legend-price").find("span").html("贷款金额："+objResult.intLoanPrice+"万（"+objResult.intLoanRatio+"成）");if(XF.View.Calculator.is_commercial==1){$(self.op.subContentChart).parent().find(".legend-rate").find("span").html("支付利息："+objResult.floatInterest+"万<em><br />（利率商业性"+objResult.floatRateBussiness+"%）</em>")}else{$(self.op.subContentChart).parent().find(".legend-rate").find("span").html("支付利息："+objResult.floatInterest+"万<em><br />（利率公积金"+objResult.floatRateFund+"%，商业性"+objResult.floatRateBussiness+"%）</em>")}var arrPieData=[{name:"参考首付",y:objResult.intFirstPay,events:{mouseOver:function(){$(".legend-pay").addClass("curr")},mouseOut:function(){$(".legend-pay").removeClass("curr")}}},{name:"贷款金额",y:objResult.intLoanPrice,events:{mouseOver:function(){$(".legend-price").addClass("curr")},mouseOut:function(){$(".legend-price").removeClass("curr")}}},{name:"支付利息",y:objResult.floatInterest,events:{mouseOver:function(){$(".legend-rate").addClass("curr")},mouseOut:function(){$(".legend-rate").removeClass("curr")}}}];$(self.op.subContentChart).drawPie({colors:["#2F69BF","#A2BF2F","#BF5A2F"],databox:[{data:arrPieData,innerSize:"47%"}]});if(objResult.intFirstPay==0){$(self.op.subContentChart).html("")}}})(jQuery);(function(a){a(".calculator-mod").find(".tools-item5 input.int-text").on("keyup.calcu",function(){a(this).val(a(this).val().replace(/[^0-9]/,""))})})(jQuery);(function(d){function a(h,g,f){h.each(function(j){var l=d(this),k=g.eq(j);l.on(f,function(){g.not(k).hide();k.show()})})}var e=d(".info-item-mod"),c=e.find(".item-hd .area-item"),b=e.find(".item-bd .item");d(b).first().show();a(c,b,"mouseenter")})(jQuery);(function(d){var g=d("#j-btn-mfth"),h=d("#j-btn-ljth"),l=d("#j-btn-yyhd");var a=d("#j-btn-mfth2"),b=d("#j-btn-ljth2"),m=d("#j-btn-yyhd2");var o=d("#j-btn-ljth-layer"),f=d("#j-btn-ljyy-layer");var k=APF.Utils.getCookie("xf_400_free");var n=d("#j-freecall").appendTo("body");var j=d("#j-triggerlayer-b");if(!j.length){j=d("#j-triggerlayer")}d(window).on("scroll.call",function(){c()});c();function c(){if(!j.length){return}var p=d(window).scrollTop(),q=j.offset().top;p>q?n.show():n.hide()}var e=new Date().getHours();if(e>=8&&e<19){if(k){h.addClass("make-call2").add(b.addClass("make-call2")).show()}else{g.addClass("make-freecall2").add(a.addClass("make-freecall2")).show()}}else{l.addClass("order-callback2").add(m.addClass("order-callback2")).show()}})(jQuery);(function(e){e.ajax({type:"POST",url:"/aifang/web/ajax/LsRc/",data:{},dataType:"json",success:function(g){}});var f=e(".hot-reviews");f.on("click.prasie",".praise-link",function(){var h=e(this);var k=e(this).attr("dianping");var j=e(this).find("em");var g=parseInt(j.text());XF.Soj.send("{from:commview_dp_zan}",XF.Soj.param);if(k){e.ajax({type:"POST",url:"/aifang/web/ajax/Ugclove/",data:{type:"add_love",loupan_id:XF.Vars.loupanId,guid:XF.Vars.guid,dianping_id:k},dataType:"json",success:function(l){if(l.result==1){h.addClass("praise-link-hover");h.removeClass("praise-link");j.text(g+1)}else{h.removeClass("praise-link-hover")}}})}});f.on("click.tram",".tram-link",function(){var h=e(this);var j=e(this).attr("diancai");var k=e(this).find("em");var g=parseInt(k.text());XF.Soj.send("{from:commview_dp_cai}",XF.Soj.param);if(j){e.ajax({type:"POST",url:"/aifang/web/ajax/UgcReply/",data:{type:"add_step",loupan_id:XF.Vars.loupanId,dianping_id:j},dataType:"json",success:function(l){if(l.result==1){h.addClass("tram-link-hover");h.removeClass("tram-link");k.text(g+1)}else{h.removeClass("tram-link-hover")}}})}});var c=e(".user-reviews .publish-mod").find(".js-wantdp-btn");if(c.length){c.on("click.mycomment",function(){XF.Soj.send("{from:commview_dp_botton}",XF.Soj.param)})}var a=e(".hot-comments-lp");var b=a.find("li");var d=b.length;if(a.length){b.on({mouseenter:function(){var g=e(this).parents("#j-user-coment").next().find(".hot-comments-line");var h=b.index(e(this));e(this).addClass("item-hover");g.addClass("dim-bghover");if(d==1){e(this).parents(".mod").addClass("dim-bghover")}if(d==2&&h==1){e(this).parents(".mod").addClass("dim-bghover");b.eq(0).addClass("clear-bghover")}},mouseleave:function(){var g=e(this).parents("#j-user-coment").next().find(".hot-comments-line");var h=b.index(e(this));e(this).removeClass("item-hover");g.removeClass("dim-bghover");if(d==1){e(this).parents(".mod").removeClass("dim-bghover")}if(d==2&&h==1){e(this).parents(".mod").removeClass("dim-bghover");b.eq(0).removeClass("clear-bghover")}},click:function(){var g=e.trim(e(this).data("src"));g&&XF.WindowsOpen.redirect(g)}})}})(jQuery);(function(b){XF.nameSpace("XF.User.Comments");var c={};c=XF.User.Comments;c.exposureEntry=function(d){XF.Soj.paramExp=b.extend({},XF.Soj.param,{Site:"anjuke-exposure-npv"});XF.Soj.send("{exposure:"+d+"}",XF.Soj.paramExp)};var a=[];c.isCache=function(g){var d=a.length;var h=false;for(var f=0;f<=d+1;f++){if(a[f]==g){h=false;break}else{h=true}}return h};c.isExposure=function(d){if(c.isCache(d)){c.exposureEntry(d);a.push(d)}};c.handleScroll=function(){var d=b(".user-reviews");if(d.length){b(window).on("scroll.userComments",function(){var h=b(window).scrollTop();var e=d.offset().top;var f=d.height();var g=b(window).height();if(h+g>e+f){c.isExposure("Exp_Xinfang_commview_dp_bottom")}})}};c.handleScroll();c.isLoginComments=function(){var e=b(".publish-mod").find(".tips-text");var d=APF.Utils.getCookie("aQQ_ajkauthinfos");if(!d){e.text("需要登录才能点评哦！")}};c.isLoginComments()})(jQuery);(function(h){XF.nameSpace("XF.Activity");if(window.need_mobile_code){return}var g=h(".modal-latest-bd");var d=new XF.Modal({modalClass:"modal-custom",title:"最新活动",bd:g,width:"560"});var a=h(".modal-latest-status");var b=new XF.Modal({modalClass:"modal-custom",title:"最新活动",bd:a,width:"560"});var f={graphBtn:".graph-act .btn",generalBtn:".general-act .btn"};var c={inputDom:".latest-inpbox .int-text",errorMsg:".modal-latest-bd .error-msg",btnClick:".modal-latest-bd .latest-btn .btn",succTimer:".modal-latest-status .timer-data",is_post:true};var e;h(f.graphBtn).on("click.grapbtn",function(){e=h(this).parents(".graph-act").attr("activity_id");h(".modal-latest-bd").find(".rules-mod").html(XF.Activity.Data[e]);XF.Soj.param=h.extend({},XF.Soj.param,{Site:"anjuke-npv"});XF.Soj.send("{from:loupan_index_hd1}",XF.Soj.param);d.open();XF.Activity.resetInputData();XF.Activity.popActivityBtn(e)});h(f.generalBtn).on("click.generalbtn",function(){e=h(this).parents(".general-act").attr("activity_id");h(".modal-latest-bd").find(".rules-mod").html(XF.Activity.Data[e]);XF.Soj.param=h.extend({},XF.Soj.param,{Site:"anjuke-npv"});XF.Soj.send("{from:loupan_index_hd2}",XF.Soj.param);d.open();h(c.btnClick).addClass("first-act");XF.Activity.resetInputData();XF.Activity.popActivityBtn(e)});XF.Activity.popActivityBtn=function(j){h(c.btnClick).off("click.graphAct");h(c.btnClick).on("click.graphAct",function(){var n=h.trim(h(c.inputDom).val());var l=h(c.inputDom);var m=h(c.errorMsg).find("p");var k=m.find("em");n=n=="请输入您的手机号码"?"":n;n?k.text("手机格式错误!"):k.text("手机号码不能为空!");actData={action:"join",selfhui:j,phone:n};if(XF.Validate.phoneMobile(n)){m.hide();l.removeClass("int-err");if(c.is_post){c.is_post=false;h.post("/selfhui/ajax/join/",actData,function(o){if(!o.status){m.show();k.text(o.msg);l.addClass("int-err")}else{d.close();h(c.succTimer).html(XF.Activity.timerData[j]);b.open()}c.is_post=true},"json")}}else{m.show();l.addClass("int-err")}})};XF.Activity.resetInputData=function(){h(c.inputDom).val("请输入您的手机号码");h(c.errorMsg).find("p").hide();h(c.inputDom).removeClass("int-err")}})(jQuery);(function(a){if(window.need_mobile_code){return}if(!a(".graph-act").length){a(".general-act").css({border:"none"})}})(jQuery);(function(j){XF.nameSpace("XF.Activity");if(!window.need_mobile_code){return}var c=j(".modal-latest-bd-v2");var p=new XF.Modal({modalClass:"modal-custom",title:"最新活动",bd:c,width:"560"});var d=j(".modal-latest-status");var l=new XF.Modal({modalClass:"modal-custom",title:"最新活动",bd:d,width:"560"});var m={graphBtn:".graph-act .btn",generalBtn:".general-act .btn"};var k={inputDom:".latest-inpbox .int-text",errorMsg:".modal-latest-bd-v2 .error-msg",btnClick:".modal-latest-bd-v2 .latest-btn .btn",succTimer:".modal-latest-status .timer-data",is_post:true};var q;var e={phone:j(".modal-latest-bd-v2 .c-phone"),imgCode:j(".modal-latest-bd-v2 .img-code-int"),smsCode:j(".modal-latest-bd-v2 .sms-code-int"),msgBox:j(".modal-latest-bd-v2 .msg-box"),msgText:j(".modal-latest-bd-v2 .msg-box span"),isShow:j(".modal-latest-bd-v2 .j-is-show"),refreshBtn:j(".modal-latest-bd-v2 .refresh-btn"),verfiyBtn:j(".modal-latest-bd-v2 .send-sms-btn")};var a=[],f={phone:{defaults:"请输入您的手机号码",empty:"手机号码不能为空！",format:"请正确输入手机号！"},code:{defaults:"请输入图片码",empty:"图片码不能为空",format:"图片码错误"},smscode:{defaults:"请输入短信验证",empty:"短信验证不能为空",format:"短信验证码错误"}};a.phone=function(){var v=e.phone,u=j.trim(v.val()),s=e.msgBox.eq(0),t=e.msgText.eq(0);u=u==f.phone.defaults?"":u;if(u!=""&&!XF.Validate.phoneMobile(u)){s.show();v.addClass("int-err");t.html(f.phone.format);return false}else{if(u==""){s.show();v.addClass("int-err");t.html(f.phone.empty);return false}else{v.removeClass("int-err");s.hide();return true}}};a.imgCode=function(){var v=e.imgCode,u=j.trim(v.val()),s=e.msgBox.eq(1),t=e.msgText.eq(1);u=u==f.code.defaults?"":u;if(u!=""&&u.length!=4){s.show();v.addClass("int-err");t.html(f.code.format);return false}else{if(u==""){s.show();v.addClass("int-err");t.html(f.code.empty);return false}else{v.removeClass("int-err");s.hide();return true}}};a.smsCode=function(){var v=e.smsCode,u=j.trim(v.val()),s=e.msgBox.eq(2),t=e.msgText.eq(2);u=u==f.smscode.defaults?"":u;if(u!=""&&!XF.Validate.smsCode(u)){s.show();v.addClass("int-err");t.html(f.smscode.format);return false}else{if(u==""){s.show();v.addClass("int-err");t.html(f.smscode.empty);return false}else{v.removeClass("int-err");s.hide();return true}}};a.isShowCode=function(){if(e.isShow.is(":visible")){return a.imgCode()}else{return true}};function n(){var u=j.now(),s,t=e.refreshBtn.prev();s=t.attr("src").substr(0,t.attr("src").length-13)+u;t.attr("src",s)}function r(v,s,u){var t={phone:s,guid:XF.Vars.guid,type:13};if(e.isShow.is(":visible")){t.imagecode=j.trim(e.imgCode.val())}j.ajax({url:"/vcode/mobilecode/",type:"post",dataType:"json",data:t,success:function(x){var w,z,y,A;w=e.msgBox.eq(0),z=e.msgText.eq(0),y=e.msgBox.eq(1),A=e.msgText.eq(1);if(x.rst>0){b(v,u);w.hide();y.hide()}else{if(x.rst==-3){e.isShow.show();y.show();e.imgCode.addClass("int-err");A.html(x.msg)}else{if(e.isShow.is(":visible")){y.show();e.imgCode.addClass("int-err");A.html(x.msg)}else{w.show();msg.html(x.msg)}}}}})}function b(u,t){if(t==0){u.removeAttr("disabled");u.removeClass("f-getcode-dis");u.text("发送短信验证码");t=t;o()}else{u.attr("disabled","disabled");u.addClass("f-getcode-dis");u.text(t+"秒后重新发送");u.off("click.xfsend");t--;var s=setTimeout(function(){b(u,t)},1000)}}e.refreshBtn.on("click.xfrefresh",function(){n()});function o(){e.verfiyBtn.on("click.xfsend",function(){var s=j.trim(e.phone.val());if(a.phone()&&a.isShowCode()){r(j(this),s,60)}})}o();function h(){j.post("/vcode/image/",{},function(s){if(s.status==1){e.isShow.show()}else{e.isShow.hide()}},"json")}function g(){e.imgCode.attr("placeholder",f.code.defaults);e.imgCode.val("");e.imgCode.removeClass("int-err");e.phone.removeClass("int-err");e.smsCode.attr("placeholder",f.smscode.defaults);e.smsCode.val("");e.smsCode.removeClass("int-err");e.msgBox.hide()}j(m.graphBtn).on("click.grapbtn",function(){q=j(this).parents(".graph-act").attr("activity_id");j(".modal-latest-bd-v2").find(".rules-mod").html(XF.Activity.Data[q]);XF.Soj.param=j.extend({},XF.Soj.param,{Site:"anjuke-npv"});XF.Soj.send("{from:loupan_index_hd1}",XF.Soj.param);p.open();XF.Activity.resetInputData();XF.Activity.popActivityBtn(q);h();n();g()});j(m.generalBtn).on("click.generalbtn",function(){q=j(this).parents(".general-act").attr("activity_id");j(".modal-latest-bd-v2").find(".rules-mod").html(XF.Activity.Data[q]);XF.Soj.param=j.extend({},XF.Soj.param,{Site:"anjuke-npv"});XF.Soj.send("{from:loupan_index_hd2}",XF.Soj.param);p.open();j(k.btnClick).addClass("first-act");XF.Activity.resetInputData();XF.Activity.popActivityBtn(q);h();n();g()});XF.Activity.popActivityBtn=function(s){j(k.btnClick).off("click.graphAct");j(k.btnClick).on("click.graphAct",function(){var w=j.trim(e.phone.val());var u=j(k.inputDom);var v=e.msgBox.eq(2);var t=e.msgText.eq(2);var x={action:"join",selfhui:s,phone:w,type:13,phonecode:j.trim(e.smsCode.val()),loupan_id:XF.Vars.loupan_id};if(a.phone()&&a.isShowCode()&&a.smsCode()){v.hide();u.removeClass("int-err");if(k.is_post){k.is_post=false;j.post("/selfhui/ajax/join/",x,function(y){if(!y.status){v.show();t.text(y.msg);e.smsCode.addClass("int-err")}else{if(y.error_code==9374){e.smsCode.addClass("int-err");e.msgBox.eq(2).show();e.msgText.eq(y.msg)}else{p.close();j(k.succTimer).html(XF.Activity.timerData[s]);l.open()}}k.is_post=true},"json")}}else{v.show();u.addClass("int-err")}})};XF.Activity.resetInputData=function(){j(k.inputDom).val("请输入您的手机号码");j(k.errorMsg).find("p").hide();j(k.inputDom).removeClass("int-err")}})(jQuery);(function(a){if(!window.need_mobile_code){return}if(!a(".graph-act").length){a(".general-act").css({border:"none"})}})(jQuery);$(function(){if(window.need_mobile_code){return}var b=$(".modal-shop-bd");var g=new XF.Modal({modalClass:"modal-custom",title:"商铺现场活动",bd:b,width:"560"});var e=$("#modal-latest-success");var a=new XF.Modal({modalClass:"modal-custom",title:"商铺现场活动",bd:e,width:"560"});var f=$("#modal-latest-fail");var h=new XF.Modal({modalClass:"modal-custom",title:"商铺现场活动",bd:f,width:"560"});var c={inputDom:".shop-inpbox .int-text",errorMsg:".modal-shop-bd .error-msg",btnClick:".modal-shop-bd .shop-btn .btn",succTimer:".modal-shop-status .timer-data",tryBtnClick:".modal-shop-status .try-btn",is_post:true};var j;$(".shop-activity-mod .btn").on("click.grapbtn",function(){j=$(this).parents(".act-item").attr("activity_id");$(".modal-shop-bd").find(".rules-mod").html(XF.ShopActivity.Data[j]);XF.Soj.param=$.extend({},XF.Soj.param,{Site:"anjuke-npv"});XF.Soj.send("{from:loupan_index_spxchd_pc}",XF.Soj.param);g.open();XF.ShopActivity.resetInputData();XF.ShopActivity.popActivityBtn(j)});$(c.tryBtnClick).on("click.trybtn",function(){h.close();g.open()});var d="";if(d==1){XF.ShopActivity.popActivityBtn=function(k){$(c.btnClick).off("click.graphAct");$(c.btnClick).on("click.graphAct",function(){var o=$.trim($(c.inputDom).val());var m=$(c.inputDom);var n=$(c.errorMsg).find("p");var l=n.find("em");o=o=="请输入您的手机号码"?"":o;o?l.text("手机格式错误!"):l.text("手机号码不能为空!");actData={action:"commercial_join",commercial_act_id:k,phone:o,phone_400:phone_400};if(XF.Validate.phoneMobile(o)){n.hide();m.removeClass("int-err");if(c.is_post){c.is_post=false;$.post("/loupan/ajax/commercialjoin/",actData,function(p){if(!p.status){if(p.err_code>=5){g.close();h.open()}else{n.show();l.text(p.err_msg);m.addClass("int-err")}}else{g.close();$(c.succTimer).html(XF.ShopActivity.timerData[k]);a.open()}c.is_post=true},"json")}}else{n.show();m.addClass("int-err")}})};XF.ShopActivity.resetInputData=function(){$(c.inputDom).val("请输入您的手机号码");$(c.errorMsg).find("p").hide();$(c.inputDom).removeClass("int-err")}}$("input[name=phone]").blur(function(){var k=$(this).val();var o=$(c.errorMsg).find("p");var m=$(c.inputDom);var l=o.find("em");if(XF.Validate.phoneMobile(k)){var n={action:"phone_check",commercial_act_id:j,phone:k};$.post("/loupan/ajax/commercialjoin/",n,function(q){if(!q.status){o.show();l.text(q.err_msg);m.addClass("int-err")}else{o.hide();m.removeClass("int-err")}},"json")}else{if(k.length==0){var p="手机号码不能为空!"}else{var p="手机号码格式错误!"}o.show();l.text(p);m.addClass("int-err")}})});$(function(){if(!window.need_mobile_code){return}var g=$(".modal-shop-bd-v2");var n=new XF.Modal({modalClass:"modal-custom",title:"商铺现场活动",bd:g,width:"560"});var k=$("#modal-latest-success");var e=new XF.Modal({modalClass:"modal-custom",title:"商铺现场活动",bd:k,width:"560"});var m=$("#modal-latest-fail");var o=new XF.Modal({modalClass:"modal-custom",title:"商铺现场活动",bd:m,width:"560"});var h={btnClick:".modal-shop-bd-v2 .shop-btn .btn",succTimer:".modal-shop-status .timer-data",tryBtnClick:".modal-shop-status .try-btn",is_post:true};var c={phone:$(".modal-shop-bd-v2 .c-phone"),imgCode:$(".modal-shop-bd-v2 .img-code-int"),smsCode:$(".modal-shop-bd-v2 .sms-code-int"),msgBox:$(".modal-shop-bd-v2 .msg-box"),msgText:$(".modal-shop-bd-v2 .msg-box span"),isShow:$(".modal-shop-bd-v2 .j-is-show"),refreshBtn:$(".modal-shop-bd-v2 .refresh-btn"),verfiyBtn:$(".modal-shop-bd-v2 .send-sms-btn")};var a=[],d={phone:{defaults:"请输入您的手机号码",empty:"手机号码不能为空！",format:"请正确输入手机号！"},code:{defaults:"请输入图片码",empty:"图片码不能为空",format:"图片码错误"},smscode:{defaults:"请输入短信验证码",empty:"短信验证码不能为空",format:"短信验证码错误"}};var p;function f(){c.imgCode.attr("placeholder",d.code.defaults);c.imgCode.val("");c.imgCode.removeClass("int-err");c.phone.removeClass("int-err");c.smsCode.attr("placeholder",d.smscode.defaults);c.smsCode.val("");c.smsCode.removeClass("int-err");c.msgBox.hide()}$(".shop-activity-mod .btn").on("click.grapbtn",function(){p=$(this).parents(".act-item").attr("activity_id");$(".modal-shop-bd-v2").find(".rules-mod").html(XF.ShopActivity.Data[p]);XF.Soj.param=$.extend({},XF.Soj.param,{Site:"anjuke-npv"});XF.Soj.send("{from:loupan_index_spxchd_pc}",XF.Soj.param);n.open();XF.ShopActivity.resetInputData();XF.ShopActivity.popActivityBtn(p);$.post("/vcode/image/",{},function(r){if(r.status==1){c.isShow.show()}else{c.isShow.hide()}},"json");j();f()});$(h.tryBtnClick).on("click.trybtn",function(){o.close();n.open()});a.phone=function(){var u=c.phone,t=$.trim(u.val()),r=c.msgBox.eq(0),s=c.msgText.eq(0);t=t==d.phone.defaults?"":t;if(t!=""&&!XF.Validate.phoneMobile(t)){r.show();u.addClass("int-err");s.html(d.phone.format);return false}else{if(t==""){r.show();u.addClass("int-err");s.html(d.phone.empty);return false}else{u.removeClass("int-err");r.hide();return true}}};a.imgCode=function(){var u=c.imgCode,t=$.trim(u.val()),r=c.msgBox.eq(1),s=c.msgText.eq(1);t=t==d.code.defaults?"":t;if(t!=""&&t.length!=4){r.show();u.addClass("int-err");s.html(d.code.format);return false}else{if(t==""){r.show();u.addClass("int-err");s.html(d.code.empty);return false}else{u.removeClass("int-err");r.hide();return true}}};a.smsCode=function(){var u=c.smsCode,t=$.trim(u.val()),r=c.msgBox.eq(2),s=c.msgText.eq(2);t=t==d.smscode.defaults?"":t;if(t!=""&&!XF.Validate.smsCode(t)){r.show();u.addClass("int-err");s.html(d.smscode.format);return false}else{if(t==""){r.show();u.addClass("int-err");s.html(d.smscode.empty);return false}else{u.removeClass("int-err");r.hide();return true}}};a.isShowCode=function(){if(c.isShow.is(":visible")){return a.imgCode()}else{return true}};function j(){var t=$.now(),r,s=c.refreshBtn.prev();r=s.attr("src").substr(0,s.attr("src").length-13)+t;s.attr("src",r)}function q(u,r,t){var s={phone:r,guid:XF.Vars.guid,type:14};if(c.isShow.is(":visible")){s.imagecode=$.trim(c.imgCode.val())}$.ajax({url:"/vcode/mobilecode/",type:"post",dataType:"json",data:s,success:function(w){var v,y,x,z;v=c.msgBox.eq(0),y=c.msgText.eq(0),x=c.msgBox.eq(1),z=c.msgText.eq(1);if(w.rst>0){b(u,t);v.hide();x.hide()}else{if(w.rst==-3){c.isShow.show();x.show();c.imgCode.addClass("int-err");z.html(w.msg)}else{if(c.isShow.is(":visible")){x.show();c.imgCode.addClass("int-err");z.html(w.msg)}else{v.show();msg.html(w.msg)}}}}})}function b(t,s){if(s==0){t.removeAttr("disabled");t.removeClass("f-getcode-dis");t.text("发送短信验证码");s=s;l()}else{t.attr("disabled","disabled");t.addClass("f-getcode-dis");t.text(s+"秒后重新发送");t.off("click.xfsend");s--;var r=setTimeout(function(){b(t,s)},1000)}}c.refreshBtn.on("click.xfrefresh",function(){j()});function l(){c.verfiyBtn.on("click.xfsend",function(){var r=$.trim(c.phone.val());if(a.phone()&&a.isShowCode()){q($(this),r,60)}})}l();if(XF.Vars.is_show==1){XF.ShopActivity.popActivityBtn=function(r){$(h.btnClick).off("click.graphAct");$(h.btnClick).on("click.graphAct",function(){var v=$.trim(c.phone.val());var s=$.trim(c.smsCode.val());var u=c.msgBox.eq(0);var t=c.msgText.eq(0);actData={action:"commercial_join",commercial_act_id:r,phone:v,phone_400:phone_400,code:s,loupan_id:XF.Vars.loupan_id,type:14};if(a.phone()&&a.isShowCode()&&a.smsCode()){u.hide();c.phone.removeClass("int-err");if(h.is_post){h.is_post=false;$.post("/loupan/ajax/commercialjoin/",actData,function(w){if(!w.status){if(w.err_code>=5){n.close();o.open()}else{u.show();t.text(w.err_msg);c.phone.addClass("int-err")}}else{n.close();$(h.succTimer).html(XF.ShopActivity.timerData[r]);e.open()}h.is_post=true},"json")}}})};XF.ShopActivity.resetInputData=function(){c.phone.val("请输入您的手机号码");c.msgBox.eq(0).hide();c.phone.removeClass("int-err")}}});XF.nameSpace("XF.ViewPop");(function(b,a){if(window.need_mobile_code){return}a.Bespoken=function(d){var c=this;c.op=b.extend({bspokenBd:"",bespokenSuccessBd:""},d||{});c.bspokenBd=b(c.op.bspokenBd);c.bespokenSuccessBd=b(c.op.bespokenSuccessBd);c.modalBespoken;c.modalBespokenSucc;c.modalBespokenError;c.timeDelay;c.dom={singleBtn:"#j-btn-bespoken,#j-btn-kft",multiBtn:".consult-list .consult-btn",multiSpBtn:".consult-list .spconsult-btn"};c.changeData={titieText:".bespoken-modal .hd .title"};c.popBtn={bespokenBtn:"#j-bespoken-pop",identifyBtn:"#j-identify-pop"};c.postData={consultData:{loupan_id:"",username:"",mobile:"",consultant_id:"",type:"",is_post:true},postUrl:"/ajax/appoint?action=signup"};c.codeData={consultData:{mobile:""},codeUrl:"/ajax/appoint?action=send_code"};c.verifyData={phoneUrl:"/ajax/appoint?action=verify_signuped"};c.formData={chinename:".bespoken-mod .name-infs .int-text",phone:".bespoken-mod .phone-infs .int-text",vercode:".bespoken-mod .verify-infs .int-text"};c.nameError=b(".bespoken-mod .name-error");c.nameErrorText=c.nameError.find(".error-txt");c.phoneError=b(".bespoken-mod .phone-error");c.phoneErrorText=c.phoneError.find(".error-txt");c.codeError=b(".bespoken-mod .verify-error");c.codeErrorText=c.codeError.find(".error-txt");c.isTimerOff=true;c.codePramSoj;c.init()};a.Bespoken.prototype.init=function(){var c=this;c.modalBespoken=new XF.Modal({modalClass:"modal-custom bespoken-modal",title:"预约看房",bd:c.bspokenBd,width:"560"});c.modalBespokenSucc=new XF.Modal({modalClass:"modal-custom bespoken-modal",title:"预约看房",bd:c.bespokenSuccessBd,width:"560"});c.addEventHandle()};a.Bespoken.prototype.addEventHandle=function(){var c=this;if(b(c.dom.singleBtn).length){c.BindbespokenHouseClick()}if(b(c.dom.multiBtn).length){c.BindbespokenConsultantClick()}if(b(c.dom.multiSpBtn).length){c.BindbespokenConsultantClick()}if(b(c.popBtn.identifyBtn).length){c.popVerifyClickEvent()}if(b(c.popBtn.bespokenBtn).length){c.popBespokenClickEvent()}if(b(c.formData.chinename).length){b(c.formData.chinename).on("blur.verify-name",function(){c.validateName()})}if(b(c.formData.phone).length){b(c.formData.phone).on("blur.verify-phone",function(){c.phoneBlurCallBack()})}};a.Bespoken.prototype.phoneBlurCallBack=function(d){var c=this;c.codeData.consultData.mobile=b.trim(b(c.formData.phone).val());c.codeData.consultData.loupan_id=XF.Vars.loupan_id;c.codeData.consultData.type=c.postData.consultData.type;if(c.validatePhone()){b.post(c.verifyData.phoneUrl,c.codeData.consultData,function(e){if(e.status!=0){c.phoneError.show();c.phoneErrorText.text(e.info);c.isTimerOff=false}else{c.phoneError.hide();c.isTimerOff=true;if(typeof d=="function"){d()}}},"json")}};a.Bespoken.prototype.BindbespokenHouseClick=function(){var c=this;b(c.dom.singleBtn).on("click.bespoken-btn",function(){XF.Soj.param=b.extend({},XF.Soj.param,{Site:"anjuke-npv"});XF.Soj.send("{from:loupan_index_first_yykf}",XF.Soj.param);c.modalBespoken.open();c.resetInputValue();b(c.changeData.titieText).html("预约看房");c.postData.consultData.type=5;c.postData.consultData.consultant_id=0;c.codeData.consultData.consultant_id=0;c.codePramSoj="loupan_index_first_yykf_yzm"})};a.Bespoken.prototype.BindbespokenConsultantClick=function(){var c=this;var d;var e={"0":"loupan_index_zygw_wz1_yzm1","1":"loupan_index_zygw_wz1_yzm2","2":"loupan_index_zygw_wz1_yzm3","3":"loupan_index_zygw_wz1_yzm4"};var f={"0":"loupan_index_zygw_wz1","1":"loupan_index_zygw_wz2","2":"loupan_index_zygw_wz3","3":"loupan_index_zygw_wz4"};var g={"0":"loupan_index_zygw_wz1_sp_pc","1":"loupan_index_zygw_wz2_sp_pc","2":"loupan_index_zygw_wz3_sp_pc","3":"loupan_index_zygw_wz4_sp_pc"};b(c.dom.multiBtn).on("click.consult-btn",function(){d=b(c.dom.multiBtn).index(b(this));XF.Soj.param=b.extend({},XF.Soj.param,{Site:"anjuke-npv"});XF.Soj.send("{from:"+f[d]+"}",XF.Soj.param);c.modalBespoken.open();c.resetInputValue();b(c.changeData.titieText).html("预约金牌置业顾问");c.postData.consultData.consultant_id=b(this).parents(".consult-info").attr("consultant_id");c.codeData.consultData.consultant_id=b(this).parents(".consult-info").attr("consultant_id");c.postData.consultData.type=b(this).parents(".consult-info").attr("type");c.codePramSoj=e[d]});b(c.dom.multiSpBtn).on("click.consultSp-btn",function(){d=b(c.dom.multiSpBtn).index(b(this));XF.Soj.param=b.extend({},XF.Soj.param,{Site:"anjuke-npv"});XF.Soj.send("{from:"+g[d]+"}",XF.Soj.param);c.modalBespoken.open();c.resetInputValue();b(c.changeData.titieText).html("预约金牌置业顾问");c.postData.consultData.consultant_id=b(this).parents(".consult-info").attr("consultant_id");c.codeData.consultData.consultant_id=b(this).parents(".consult-info").attr("consultant_id");c.postData.consultData.type=b(this).parents(".consult-info").attr("type");c.codePramSoj=e[d]})};a.Bespoken.prototype.popBespokenClickEvent=function(){var c=this;b(c.popBtn.bespokenBtn).on("click.bespoken",function(){if(c.validatePhone()){c.postData.consultData.mobile=b.trim(b(c.formData.phone).val());c.postData.consultData.loupan_id=XF.Vars.loupan_id;var d=b(c.formData.phone);if(c.postData.consultData.is_post){c.postData.consultData.is_post=false;b.post(c.postData.postUrl,c.postData.consultData,function(e){if(e.status==0){d.removeClass("int-err");c.modalBespoken.close();c.modalBespokenSucc.open()}else{if(e.status==704||e.status==703||e.status==702){c.codeError.show();c.codeErrorText.text(e.info)}else{if(e.status==601||e.status==600||e.status==201){c.nameError.show();c.nameErrorText.text(e.info)}else{if(e.status==400||e.status==305||e.status==303||e.status==304){c.phoneError.show();c.phoneErrorText.text(e.info);d.addClass("int-err")}}}}c.postData.consultData.is_post=true},"json")}}})};a.Bespoken.prototype.popVerifyClickEvent=function(d){var c=this;b(c.popBtn.identifyBtn).on("click.verifybtn",function(){var e=b(this);if(!e.hasClass("disabled")){XF.Soj.param=b.extend({},XF.Soj.param,{Site:"anjuke-npv"});XF.Soj.send("{from:"+c.codePramSoj+"}",XF.Soj.param);if(c.validatePhone()){c.phoneBlurCallBack(function(){c.codeData.consultData.mobile=b.trim(b(c.formData.phone).val());b.post(c.codeData.codeUrl,c.codeData.consultData,function(f){if(f.status==0){c.verfiyCountdown(e,60)}else{c.codeError.show();c.codeErrorText.text(f.info)}},"json")})}}})};a.Bespoken.prototype.validateName=function(){var d=this;var c=b.trim(b(d.formData.chinename).val());function e(g){var f=/^[\u4E00-\u9FA5]{2,4}$/;return f.test(g)}c=c=="请输入您的姓名"?"":c;if(c&&!e(c)){d.nameError.show();d.nameErrorText.text("姓名为2-4个中文");return false}else{if(c==""){d.nameError.show();d.nameErrorText.text("姓名不能为空");return false}else{d.nameError.hide();return true}}};a.Bespoken.prototype.validatePhone=function(){var c=this;var d=b(c.formData.phone);var e=b.trim(d.val());e=e=="请输入您的手机号码"?"":e;if(e&&!XF.Validate.phoneMobile(e)){c.phoneError.show();c.phoneErrorText.text("手机格式错误");d.addClass("int-err");return false}else{if(e==""){c.phoneError.show();c.phoneErrorText.text("手机号码不能为空");d.addClass("int-err");return false}else{c.phoneError.hide();d.removeClass("int-err");return true}}};a.Bespoken.prototype.validateCode=function(){var c=this;var e=b.trim(b(c.formData.vercode).val());function d(f){return/^\d{6}$/.test(f)}e=e=="短信验证码"?"":e;if(e&&!d(e)){c.codeError.show();c.codeErrorText.text("验证码有误，请核对");return false}else{if(e==""){c.codeError.show();c.codeErrorText.text("验证码不能为空");return false}else{c.codeError.hide();return true}}};a.Bespoken.prototype.resetInputValue=function(){var c=this;var d=b(c.formData.phone);b(c.formData.chinename).val("请输入您的姓名");d.val("请输入您的手机号码");b(c.formData.vercode).val("短信验证码");c.nameError.hide();c.phoneError.hide();c.codeError.hide();d.removeClass("int-err");clearTimeout(c.timeDelay);b(c.popBtn.identifyBtn).text("获取验证码")};a.Bespoken.prototype.verfiyCountdown=function(e,d){var c=this;if(d==0){e.removeClass("disabled");e.text("重新获取验证码");d=d;c.isTimerOff=true}else{e.addClass("disabled");c.isTimerOff=false;e.text(d+"秒后重新获取");d--;c.timeDelay=setTimeout(function(){c.verfiyCountdown(e,d)},1000)}}})(jQuery,XF.ViewPop);(function(b){if(window.need_mobile_code){return}var a=new XF.ViewPop.Bespoken({bspokenBd:".madel-bespoken-bd",bespokenSuccessBd:".modal-bespoken-status"})})(jQuery);XF.nameSpace("XF.ViewPop");(function(b,a){if(!window.need_mobile_code){return}a.Bespoken=function(d){var c=this;c.op=b.extend({bspokenBd:"",bespokenSuccessBd:""},d||{});c.bspokenBd=b(c.op.bspokenBd);c.bespokenSuccessBd=b(c.op.bespokenSuccessBd);c.modalBespoken;c.modalBespokenSucc;c.modalBespokenError;c.timeDelay;c.dom={singleBtn:"#j-btn-bespoken,#j-btn-kft",multiBtn:".consult-list .consult-btn",multiSpBtn:".consult-list .spconsult-btn"};c.changeData={titieText:".bespoken-modal .hd .title"};c.popBtn={bespokenBtn:"#j-bespoken-pop",identifyBtn:"#j-identify-pop",refreshBtn:".bespoken-mod .refresh-btn"};c.postData={consultData:{loupan_id:"",username:"",mobile:"",consultant_id:"",type:"",is_post:true},postUrl:"/ajax/appoint?action=signup"};c.codeData={consultData:{mobile:""},codeUrl:"/vcode/mobilecode/"};c.verifyData={phoneUrl:"/ajax/appoint?action=verify_signuped"};c.formData={phone:".bespoken-mod .xf-verify-module .c-phone",imgcode:".bespoken-mod .xf-verify-module .img-code-int",vercode:".bespoken-mod .xf-verify-module .sms-code-int"};c.nameError=b(".bespoken-mod .name-error");c.nameErrorText=c.nameError.find(".error-txt");c.phoneError=b(".bespoken-mod .msg-box").eq(0);c.phoneErrorText=c.phoneError.find("span");c.imgcodeError=b(".bespoken-mod .msg-box").eq(1);c.imgcodeErrorText=c.imgcodeError.find("span");c.codeError=b(".bespoken-mod .msg-box").eq(2);c.codeErrorText=c.codeError.find("span");c.isShowImgMod=b(".madel-bespoken-bd-v2 .j-is-show");c.isTimerOff=true;c.codePramSoj;c.init()};a.Bespoken.prototype.init=function(){var c=this;c.modalBespoken=new XF.Modal({modalClass:"modal-custom bespoken-modal",title:"预约看房",bd:c.bspokenBd,width:"560"});c.modalBespokenSucc=new XF.Modal({modalClass:"modal-custom bespoken-modal",title:"预约看房",bd:c.bespokenSuccessBd,width:"560"});c.addEventHandle()};a.Bespoken.prototype.addEventHandle=function(){var c=this;if(b(c.dom.singleBtn).length){c.BindbespokenHouseClick();c.isImgValideCode();c.refreshCodeImg()}if(b(c.dom.multiBtn).length){c.BindbespokenConsultantClick()}if(b(c.dom.multiSpBtn).length){c.BindbespokenConsultantClick()}if(b(c.popBtn.identifyBtn).length){c.popVerifyClickEvent()}if(b(c.popBtn.bespokenBtn).length){c.popBespokenClickEvent()}if(b(c.formData.chinename).length){b(c.formData.chinename).on("blur.verify-name",function(){c.validateName()})}if(b(c.formData.phone).length){b(c.formData.phone).on("blur.verify-phone",function(){c.phoneBlurCallBack()})}if(b(c.popBtn.refreshBtn).length){b(c.popBtn.refreshBtn).on("click.refresh",function(){c.refreshCodeImg()})}};a.Bespoken.prototype.phoneBlurCallBack=function(d){var c=this;c.codeData.consultData.mobile=b.trim(b(c.formData.phone).val());c.codeData.consultData.loupan_id=XF.Vars.loupan_id;c.codeData.consultData.type=c.postData.consultData.type;if(c.validatePhone()){b.post(c.verifyData.phoneUrl,c.codeData.consultData,function(e){if(e.status!=0){c.phoneError.show();c.phoneErrorText.text(e.info);c.isTimerOff=false}else{c.phoneError.hide();c.isTimerOff=true;if(typeof d=="function"){d()}}},"json")}};a.Bespoken.prototype.BindbespokenHouseClick=function(){var c=this;b(c.dom.singleBtn).on("click.bespoken-btn",function(){XF.Soj.param=b.extend({},XF.Soj.param,{Site:"anjuke-npv"});XF.Soj.send("{from:loupan_index_first_yykf}",XF.Soj.param);c.modalBespoken.open();c.resetInputValue();b(c.changeData.titieText).html("预约看房");c.postData.consultData.type=5;c.postData.consultData.consultant_id=0;c.codeData.consultData.consultant_id=0;c.codePramSoj="loupan_index_first_yykf_yzm"})};a.Bespoken.prototype.BindbespokenConsultantClick=function(){var c=this;var d;var e={"0":"loupan_index_zygw_wz1_yzm1","1":"loupan_index_zygw_wz1_yzm2","2":"loupan_index_zygw_wz1_yzm3","3":"loupan_index_zygw_wz1_yzm4"};var f={"0":"loupan_index_zygw_wz1","1":"loupan_index_zygw_wz2","2":"loupan_index_zygw_wz3","3":"loupan_index_zygw_wz4"};var g={"0":"loupan_index_zygw_wz1_sp_pc","1":"loupan_index_zygw_wz2_sp_pc","2":"loupan_index_zygw_wz3_sp_pc","3":"loupan_index_zygw_wz4_sp_pc"};b(c.dom.multiBtn).on("click.consult-btn",function(){d=b(c.dom.multiBtn).index(b(this));XF.Soj.param=b.extend({},XF.Soj.param,{Site:"anjuke-npv"});XF.Soj.send("{from:"+f[d]+"}",XF.Soj.param);c.modalBespoken.open();c.resetInputValue();b(c.changeData.titieText).html("预约金牌置业顾问");c.postData.consultData.consultant_id=b(this).parents(".consult-info").attr("consultant_id");c.codeData.consultData.consultant_id=b(this).parents(".consult-info").attr("consultant_id");c.postData.consultData.type=b(this).parents(".consult-info").attr("type");c.codePramSoj=e[d];c.isImgValideCode();c.refreshCodeImg()});b(c.dom.multiSpBtn).on("click.consultSp-btn",function(){d=b(c.dom.multiSpBtn).index(b(this));XF.Soj.param=b.extend({},XF.Soj.param,{Site:"anjuke-npv"});XF.Soj.send("{from:"+g[d]+"}",XF.Soj.param);c.modalBespoken.open();c.resetInputValue();b(c.changeData.titieText).html("预约金牌置业顾问");c.postData.consultData.consultant_id=b(this).parents(".consult-info").attr("consultant_id");c.codeData.consultData.consultant_id=b(this).parents(".consult-info").attr("consultant_id");c.postData.consultData.type=b(this).parents(".consult-info").attr("type");c.codePramSoj=e[d];c.isImgValideCode();c.refreshCodeImg()})};a.Bespoken.prototype.popBespokenClickEvent=function(){var c=this;b(c.popBtn.bespokenBtn).on("click.bespoken",function(){if(c.validatePhone()&&c.isShowImgCode()&&c.validateCode()){c.postData.consultData.mobile=b.trim(b(c.formData.phone).val());c.postData.consultData.loupan_id=XF.Vars.loupan_id;var d=b(c.formData.phone);var e=b.trim(b(c.formData.vercode).val());c.postData.consultData.phonecode=e;if(c.postData.consultData.is_post){c.postData.consultData.is_post=false;b.post(c.postData.postUrl,c.postData.consultData,function(f){if(f.status==0){d.removeClass("int-err");c.modalBespoken.close();c.modalBespokenSucc.open();c.codeError.hide();c.nameError.hide();c.phoneError.hide();b(c.formData.vercode).removeClass("int-err")}else{if(f.status==704||f.status==703||f.status==702){c.codeError.show();c.codeErrorText.text(f.info)}else{if(f.status==601||f.status==600||f.status==201){c.nameError.show();c.nameErrorText.text(f.info)}else{if(f.status==400||f.status==305||f.status==303||f.status==304){c.phoneError.show();c.phoneErrorText.text(f.info);d.addClass("int-err")}else{if(f.status==9374){c.codeError.show();b(c.formData.vercode).addClass("int-err");c.codeErrorText.text(f.info)}}}}}c.postData.consultData.is_post=true},"json")}}})};a.Bespoken.prototype.popVerifyClickEvent=function(d){var c=this;b(c.popBtn.identifyBtn).on("click.verifybtn",function(){var e=b(this);var f=b(c.formData.phone);var g=b.trim(f.val());var h={phone:g};if(b(c.changeData.titieText).html()=="预约金牌置业顾问"){h.type=12}else{h.type=11}if(c.isShowImgMod.is(":visible")){h.imagecode=b.trim(b(c.formData.imgcode).val())}if(!e.hasClass("disabled")){XF.Soj.param=b.extend({},XF.Soj.param,{Site:"anjuke-npv"});XF.Soj.send("{from:"+c.codePramSoj+"}",XF.Soj.param);if(c.validatePhone()&&c.isShowImgCode()){b.post(c.codeData.codeUrl,h,function(j){if(j.rst>0){c.imgcodeError.hide();c.phoneError.hide();c.verfiyCountdown(e,60);b(c.formData.imgcode).removeClass("int-err");b(c.formData.phone).removeClass("int-err")}else{if(j.rst==-3){c.isShowImgMod.show();c.imgcodeError.show();b(c.formData.imgcode).addClass("int-err");c.imgcodeErrorText.text(j.msg)}else{if(c.isShowImgMod.is(":visible")){b(c.formData.imgcode).addClass("int-err");c.imgcodeError.show();c.imgcodeErrorText.text(j.msg)}else{b(c.formData.phone).addClass("int-err");c.phoneError.show();c.phoneErrorText.text(j.msg)}}}},"json")}}})};a.Bespoken.prototype.validateName=function(){var d=this;var c=b.trim(b(d.formData.chinename).val());function e(g){var f=/^[\u4E00-\u9FA5]{2,4}$/;return f.test(g)}c=c=="请输入您的姓名"?"":c;if(c&&!e(c)){d.nameError.show();d.nameErrorText.text("姓名为2-4个中文");return false}else{if(c==""){d.nameError.show();d.nameErrorText.text("姓名不能为空");return false}else{d.nameError.hide();return true}}};a.Bespoken.prototype.validatePhone=function(){var c=this;var d=b(c.formData.phone);var e=b.trim(d.val());e=e=="请输入您的手机号码"?"":e;if(e&&!XF.Validate.phoneMobile(e)){c.phoneError.show();c.phoneErrorText.text("手机格式错误");d.addClass("int-err");return false}else{if(e==""){c.phoneError.show();c.phoneErrorText.text("手机号码不能为空");d.addClass("int-err");return false}else{c.phoneError.hide();d.removeClass("int-err");return true}}};a.Bespoken.prototype.isShowImgCode=function(){var c=this;if(c.isShowImgMod.is(":visible")){return c.validateImgcode()}else{return true}};a.Bespoken.prototype.isImgValideCode=function(){var c=this;b.post("/vcode/image/",{},function(d){if(d.status==1){c.isShowImgMod.show()}else{c.isShowImgMod.hide()}},"json")};a.Bespoken.prototype.validateImgcode=function(){var c=this,d=b.trim(b(c.formData.imgcode).val());d=d=="请输入图片码"?"":d;if(d!=""&&d.length!=4){b(c.formData.imgcode).addClass("int-err");c.imgcodeError.show();c.imgcodeErrorText.text("图片码错误");return false}else{if(d==""){c.imgcodeError.show();b(c.formData.imgcode).addClass("int-err");c.imgcodeErrorText.text("图片码不能为空");return false}else{b(c.formData.imgcode).removeClass("int-err");c.imgcodeError.hide();return true}}};a.Bespoken.prototype.validateCode=function(){var c=this;var d=b.trim(b(c.formData.vercode).val());d=d=="请输入短信验证码"?"":d;if(d&&!XF.Validate.smsCode(d)){c.codeError.show();b(c.formData.vercode).addClass("int-err");c.codeErrorText.text("验证码有误，请核对");return false}else{if(d==""){c.codeError.show();b(c.formData.vercode).addClass("int-err");c.codeErrorText.text("验证码不能为空");return false}else{c.codeError.hide();return true}}};a.Bespoken.prototype.resetInputValue=function(){var c=this;var d=b(c.formData.phone);b(c.formData.vercode).val("请输入短信验证码");c.nameError.hide();c.phoneError.hide();c.codeError.hide();d.removeClass("int-err");clearTimeout(c.timeDelay);b(c.popBtn.identifyBtn).text("发送短信验证码");b(c.formData.imgcode).val("请输入图片码");b(c.formData.imgcode).removeClass("int-err");b(c.formData.vercode).val("请输入短信验证码");b(c.formData.vercode).removeClass("int-err");b(".bespoken-mod .msg-box").hide()};a.Bespoken.prototype.verfiyCountdown=function(e,d){var c=this;if(d==0){e.removeClass("disabled");e.text("重新获取验证码");d=d;c.isTimerOff=true}else{e.addClass("disabled");c.isTimerOff=false;e.text(d+"秒后重新获取");d--;c.timeDelay=setTimeout(function(){c.verfiyCountdown(e,d)},1000)}};a.Bespoken.prototype.refreshCodeImg=function(){var c=this,f=b.now(),d,e=b(c.popBtn.refreshBtn).prev();d=e.attr("src").substr(0,e.attr("src").length-13)+f;e.attr("src",d)}})(jQuery,XF.ViewPop);(function(b){if(!window.need_mobile_code){return}var a=new XF.ViewPop.Bespoken({bspokenBd:".madel-bespoken-bd-v2",bespokenSuccessBd:".modal-bespoken-status"})})(jQuery);(function(d){if(window.need_mobile_code){return}var b=d(".subscribe-mod");var j=d("#subscribe-success");var e=d("#subscribe-fail");var f=b.find(":checkbox");var h=b.find(".cell-phone");var c=b.find(".btn");var a=b.find(".com-msg");var g=b.find(".com-msg").children("span");h.one("focus",function(){d(this).val("")});c.on("click",function(){var m="";var k=true;var l=d.trim(h.val());if(!f.filter(":checked").length){g.html("请选择需要订阅的内容！");k=false}else{if(!l||l=="请输入您的手机号码"){g.html("手机号码不能为空！");k=false}else{if(!XF.Validate.phoneMobile(l)){g.html("请正确输入手机号！");k=false}}}if(!k){h.addClass("int-err");a.show()}else{f.filter(":checked").each(function(){m+=d(this).val()+"|"});h.removeClass("int-err");a.hide();var n=new XF.Subscribe({type:"show",inputVal:l,category:m.substring(0,m.length-1)});n.subAjax();XF.Soj.send("{from:loupan_index_sub}",XF.Soj.param)}})})(jQuery);(function(f){if(window.need_mobile_code){return}var b="免费通话";var a="预约回电";var p="手机号码不能为空";var o="手机号码格式错误";var e="请输入手机号";var d="请输入您的手机号码";var c="选择您方便接听的时间";var h="/aifang/web/loupan/ajax/phoneconnect/";var n="/aifang/web/loupan/ajax/phonereserve/";var m=f("body");var j=f("#free-step-one");var D=f("#free-step-two");var q=f("#free-callback");var l=f("#free-repeat");var z=f("#call-result");var g=f("#newcall-entrance");var x=g.find(".new-cellphone");var A=g.find("#enConfirm");var C=APF.Utils.getCookie("xf_400_free");var u=f("#NewCall_domain").val();var w=new XF.Modal({modalClass:"modal-custom new-call",title:b,bd:j,width:"560",height:"400"});var k=new XF.Modal({modalClass:"modal-custom new-call",title:b,bd:D,width:"560",height:"400"});var t=new XF.Modal({modalClass:"modal-custom new-call",title:b,bd:l,width:"560",height:"400"});var r=new XF.Modal({modalClass:"modal-custom new-call",title:a,bd:q,width:"560",height:"400"});var y=new XF.Modal({modalClass:"modal-custom new-call",title:a,bd:z,width:"560",height:"400"});var B=new Date().getHours();if(B>=8&&B<19){if(C){x.val(C);A.attr("class","make-call1").text("立即通话").css("visibility","visible")}else{A.attr("class","make-freecall1").text("免费通话").css("visibility","visible")}}else{C&&x&&x.val(C);A.attr("class","order-callback1").text("预约回电").css("visibility","visible")}m.on({focus:function(){f(this).addClass("highlight");(f(this).val()==e||f(this).val()==d)&&f(this).val("")},blur:function(){f(this).removeClass("highlight")}},"input.new-cellphone");function v(F){var G=f.trim(F.val()),E=F.parent().find("p.com-msg");if(G==""||G==e||G==d){F.addClass("errorlight");E.show().find("em").text(p);return false}else{if(!XF.Validate.phoneMobile(G)){F.addClass("errorlight");E.show().find("em").text(o);return false}else{C=G;F.removeClass("highlight errorlight");E.hide();return true}}}m.on({click:function(){var E=f(this),I=E.text(),H=g.find(".tip-msg"),G=f.trim(x.val()),F=v(x);if(F){k.open()}else{H.hide()}}},".make-call1,.make-freecall1");m.on({click:function(){k.open()}},".make-call2");m.on({click:function(){w.open()}},".make-freecall2");m.on({click:function(){var E=f(this),H=j.find(".new-cellphone"),G=f.trim(H.val());var F=v(H);if(F){C=G;w.close();k.open()}}},"#free-step-one .do-call");m.on({click:function(){var F=f(".new-call"),E=D.find(".new-cellphone").text();j.find(".new-cellphone").val(E);k.close();w.open()}},"#free-step-two .change-cell");f(k).on("openAfter",function(){D.find(".new-cellphone").text(C);f.post(h,{phone:C,loupan_id:XF.Vars.loupanId,ref:XF.Vars.ref},function(E){APF.Utils.setCookie("xf_400_free",C,"","/",u);if(E.status==1){l.find(".result-tip span").text("您今天已经拨打本楼盘太多次啦！");k.close();t.open()}if(E.status==2){l.find(".result-tip span").text("您今天已经拨打太多次啦！");k.close();t.open()}},"json")});m.on({click:function(){var E=v(x),F=g.find(".tip-msg");if(E){q.find(".new-cellphone").val(C);r.open()}else{F.hide()}}},".order-callback1");m.on({click:function(){var E=f.trim(x.val());C&&q.find(".new-cellphone").val(C);if(XF.Validate.phoneMobile(E)){q.find(".new-cellphone").val(E)}r.open()}},".order-callback2");m.on({click:function(){f(this).find("table").removeClass("show")}},"#free-callback");m.on({click:function(E){E.stopPropagation();f(this).toggleClass("highlight");f(this).next().toggleClass("show")}},"#free-callback .select-data");m.on({mouseenter:function(){var E=f(this),F=E.parents("table");var G=E.parent("tr").children().index(E)+1;E.addClass("td-hover");F.find("tr>:nth-child("+G+")").addClass("row-light");E.parent("tr").children().addClass("row-light")},mouseleave:function(){f(this).removeClass("td-hover");f(this).parents("table").find(".row-light").removeClass("row-light")},click:function(F){F.stopPropagation();var G=f(this),I=G.parents("table"),E=q.find(".select-data");thiscol=G.parent("tr").children().index(G);var H=new Date().getFullYear()+"-"+I.find("thead th:eq("+thiscol+")").text();var J=G.parent("tr").find("th").text();E.html(H+"&nbsp;<strong>"+J+"</strong>");E.removeClass("errorlight highlight");I.removeClass("show")}},"#free-callback td");m.on({click:function(){var M=f(this),K=q.find(".new-cellphone"),N=f.trim(K.val()),E=q.find(".select-data"),H=f.trim(E.text()),J=f("#ref_from").val()=="anjuke"?"anjuke":"site";var F=v(K);if(F){if(H==c){E.addClass("errorlight");return}E.removeClass("errorlight");var L=H.split("-");L[0]=parseInt(L[0],10);L[1]=parseInt(L[1],10);L[2]=parseInt(L[2],10);L[3]=parseInt(L[3],10);if(L[1]<10){L[1]="0"+L[1]}if(L[2]<10){L[2]="0"+L[2]}var G=L[0]+L[1]+L[2];var I;if(L[3]==12){I=1}else{if(L[3]==15){I=2}else{I=3}}f.post(n,{phone:C,loupan_id:XF.Vars.loupanId,reserve_day:G,reserve_range:I,from:J},function(O){APF.Utils.setCookie("xf_400_free",C,"","/",u);if(O.status==1){z.find("span").text("恭喜您预约成功！")}else{if(O.status==-3){z.find("span").text("您已预约过该楼盘！")}}r.close();y.open()},"json")}}},"#free-callback #make-order");m.on({click:function(){f(this).parents(".newcall-entrance").length&&s("fc_mfth_planpage");f(this).parents("#j-freecall").length&&s("fc_mfth_top")}},".make-call1,.make-call2,.make-freecall1,.make-freecall2,.order-callback1,.order-callback2");m.on({click:function(){f(this).is("#do-call")?s("fc_mfth_page2"):s("fc_mfyy_page2")}},"#do-call,#make-order");function s(E){XF.Soj.send("{from:"+E+"}",XF.Soj.param);return true}})(jQuery);(function(x){if(!window.need_mobile_code){return}var w="免费通话";var u="预约回电";var N="手机号码不能为空";var M="手机号码格式错误";var K="请输入手机号";var I="请输入您的手机号码";var H="选择您方便接听的时间";var A="/aifang/web/loupan/ajax/phoneconnect/";var G="/aifang/web/loupan/ajax/phonereserve/";var r=x("body");var e=x("#free-step-one");var s=x("#free-step-two");var y=x("#free-callback");var o=x("#free-repeat");var D=x("#call-result");var t=x("#newcall-entrance");var L=t.find(".new-cellphone");var k=t.find("#enConfirm");var J=APF.Utils.getCookie("xf_400_free");var l=x("#NewCall_domain").val();var n=new XF.Modal({modalClass:"modal-custom",title:w,bd:e,width:"560"});var E=new XF.Modal({modalClass:"modal-custom",title:w,bd:s,width:"560"});var j=new XF.Modal({modalClass:"modal-custom",title:w,bd:o,width:"560",height:"400"});var c=new XF.Modal({modalClass:"modal-custom",title:u,bd:y,width:"560"});var B=new XF.Modal({modalClass:"modal-custom",title:u,bd:D,width:"560",height:"400"});var p={phone:x(".new-call-v2 .c-phone"),imgCode:x(".new-call-v2 .img-code-int"),smsCode:x(".new-call-v2 .sms-code-int"),msgBox:x(".new-call-v2 .msg-box"),msgText:x(".new-call-v2 .msg-box span"),isShow:x(".new-call-v2 .j-is-show"),refreshBtn:x("#free-step-one .refresh-btn"),verfiyBtn:x("#free-step-one .send-sms-btn"),backCallrefreshBtn:x("#free-callback .refresh-btn"),backCallverfiyBtn:x("#free-callback .send-sms-btn")};var z=[],f={phone:{defaults:"请输入您的手机号码",empty:"手机号码不能为空！",format:"请正确输入手机号！"},code:{defaults:"请输入图片码",empty:"图片码不能为空",format:"图片码错误"},smscode:{defaults:"请输入短信验证码",empty:"短信验证不能为空",format:"短信验证码错误"}};function d(){var R=x(".xf-verify-module").find(".c-phone");var P=x(".xf-verify-module").find(".img-code-int");var Q=x(".xf-verify-module").find(".sms-code-int");var O=x(".xf-verify-module").find(".msg-box");R.removeClass("int-err");P.attr("placeholder",f.code.defaults);P.val("");P.removeClass("int-err");Q.attr("placeholder",f.smscode.defaults);Q.val("");Q.removeClass("int-err");O.hide()}z.phone=function(){var R=p.phone,Q=x.trim(R.val()),O=p.msgBox.eq(0),P=p.msgText.eq(0);Q=Q==f.phone.defaults?"":Q;if(Q!=""&&!XF.Validate.phoneMobile(Q)){O.show();R.addClass("int-err");P.html(f.phone.format);return false}else{if(Q==""){O.show();R.addClass("int-err");P.html(f.phone.empty);return false}else{J=Q;R.removeClass("int-err");O.hide();return true}}};z.imgCode=function(){var R=p.imgCode,Q=x.trim(R.val()),O=p.msgBox.eq(1),P=p.msgText.eq(1);Q=Q==f.code.defaults?"":Q;if(Q!=""&&Q.length!=4){O.show();R.addClass("int-err");P.html(f.code.format);return false}else{if(Q==""){O.show();R.addClass("int-err");P.html(f.code.empty);return false}else{R.removeClass("int-err");O.hide();return true}}};z.smsCode=function(){var R=p.smsCode,Q=x.trim(R.val()),O=p.msgBox.eq(2),P=p.msgText.eq(2);Q=Q==f.smscode.defaults?"":Q;if(Q!=""&&!XF.Validate.smsCode(Q)){O.show();R.addClass("int-err");P.html(f.smscode.format);return false}else{if(Q==""){O.show();R.addClass("int-err");P.html(f.smscode.empty);return false}else{R.removeClass("int-err");O.hide();return true}}};z.isShowCode=function(){if(p.isShow.is(":visible")){return z.imgCode()}else{return true}};function h(R){var Q=x.now(),O,P=R.prev();O=P.attr("src").substr(0,P.attr("src").length-13)+Q;P.attr("src",O)}function C(R,O,Q){var P={phone:O,guid:XF.Vars.Guid,type:15};var S;if(p.isShow.is(":visible")){P.imagecode=x.trim(p.imgCode.val())}x.ajax({url:"/vcode/mobilecode/",type:"post",dataType:"json",data:P,success:function(U){var T,W,V,X;T=p.msgBox.eq(0),W=p.msgText.eq(0),V=p.msgBox.eq(1),X=p.msgText.eq(1);if(U.rst>0){q(R,Q);T.hide();V.hide()}else{if(U.rst==-3){p.isShow.show();p.imgCode.addClass("int-err");V.show();X.html(U.msg)}else{if(p.isShow.is(":visible")){V.show();p.imgCode.addClass("int-err");X.html(U.msg)}else{T.show();msg.html(U.msg)}}}}})}function q(Q,P){if(P==0){Q.removeAttr("disabled");Q.removeClass("f-getcode-dis");Q.text("发送短信验证码");P=P;if(Q.hasClass("free-callback-send")){b()}else{a()}}else{Q.attr("disabled","disabled");Q.addClass("f-getcode-dis");Q.text(P+"秒后重新发送");if(Q.hasClass("free-callback-send")){Q.off("click.backxfsend")}else{Q.off("click.xfsend")}P--;var O=setTimeout(function(){q(Q,P)},1000)}}p.refreshBtn.on("click.xfrefresh",function(){h(x(this))});p.backCallrefreshBtn.on("click.backxfrefresh",function(){h(x(this))});function a(){p.verfiyBtn.on("click.xfsend",function(){var O=x.trim(p.phone.val());if(z.phone()&&z.isShowCode()){C(x(this),O,60)}})}a();function b(){p.backCallverfiyBtn.on("click.backxfsend",function(){p.phone=x("#free-callback .c-phone");p.imgCode=x("#free-callback .img-code-int");p.msgBox=x("#free-callback .msg-box");p.msgText=x("#free-callback .msg-box span");p.isShow=x("#free-callback .j-is-show");var O=x.trim(p.phone.val());if(z.phone()&&z.isShowCode()){C(x(this),O,60)}})}b();function F(){x.post("/vcode/image/",{},function(O){if(O.status==1){p.isShow.show()}else{p.isShow.hide()}},"json")}var g=new Date().getHours();if(g>=8&&g<19){if(J){L.val(J);k.attr("class","make-call1").text("立即通话").css("visibility","visible")}else{k.attr("class","make-freecall1").text("免费通话").css("visibility","visible")}}else{J&&L&&L.val(J);k.attr("class","order-callback1").text("预约回电").css("visibility","visible")}r.on({focus:function(){x(this).addClass("highlight");(x(this).val()==K||x(this).val()==I)&&x(this).val("")},blur:function(){x(this).removeClass("highlight")}},"input.new-cellphone");function v(P){var Q=x.trim(P.val()),O=P.parent().find("p.com-msg");if(Q==""||Q==K||Q==I){P.addClass("errorlight");O.show().find("em").text(N);return false}else{if(!XF.Validate.phoneMobile(Q)){P.addClass("errorlight");O.show().find("em").text(M);return false}else{J=Q;P.removeClass("highlight errorlight");O.hide();return true}}}r.on({click:function(){var O=x(this),T=O.text(),S=t.find(".tip-msg"),Q=x.trim(L.val()),P=v(L);var R=x("#free-step-one .refresh-btn");if(P){n.open();p.phone.val(Q)}else{S.hide()}F();h(R);d()}},".make-call1,.make-freecall1");r.on({click:function(){var O=x("#free-step-one .refresh-btn");E.open();F();h(O);d()}},".make-call2");r.on({click:function(){var O=x("#free-step-one .refresh-btn");n.open();F();h(O);d()}},".make-freecall2");r.on({click:function(){var Q=x(this);if(z.phone()&&z.isShowCode()&&z.smsCode()){var U=x.trim(p.phone.val()),P=x.trim(p.smsCode.val()),R=x.trim(p.phone.val()),O=p.msgBox.eq(2),T=p.msgText.eq(2);var S={phone:U,type:15,code:P};x.post("/vcode/checkmobilecode/",S,function(V){if(V.rst>0){O.hide();n.close();E.open()}else{O.show();p.smsCode.addClass("int-err");T.html(V.msg)}},"json")}}},"#free-step-one .do-call");r.on({click:function(){var P=x(".new-call-v2"),O=s.find(".new-cellphone").text();e.find(".new-cellphone").val(O);E.close();n.open()}},"#free-step-two .change-cell");x(E).on("openAfter",function(){s.find(".new-cellphone").text(J);x.post(A,{phone:J,loupan_id:XF.Vars.loupanId,ref:XF.Vars.ref},function(O){APF.Utils.setCookie("xf_400_free",J,"","/",l);if(O.status==1){o.find(".result-tip span").text("您今天已经拨打本楼盘太多次啦！");E.close();j.open()}if(O.status==2){o.find(".result-tip span").text("您今天已经拨打太多次啦！");E.close();j.open()}},"json")});r.on({click:function(){var P=v(L),Q=t.find(".tip-msg");var O=x("#free-callback .refresh-btn");if(P){y.find(".c-phone").val(J);c.open()}else{Q.hide()}p.isShow=x("#free-callback .j-is-show");F();h(O);d()}},".order-callback1");r.on({click:function(){var P=x.trim(L.val());var O=x("#free-callback .refresh-btn");J&&y.find(".c-phone").val(J);if(XF.Validate.phoneMobile(P)){y.find(".c-phone").val(P)}p.isShow=x("#free-callback .j-is-show");F();h(O);d();c.open()}},".order-callback2");r.on({click:function(){x(this).find("table").removeClass("show")}},"#free-callback");r.on({click:function(O){O.stopPropagation();x(this).toggleClass("highlight");x(this).next().toggleClass("show")}},"#free-callback .select-data");r.on({mouseenter:function(){var O=x(this),P=O.parents("table");var Q=O.parent("tr").children().index(O)+1;O.addClass("td-hover");P.find("tr>:nth-child("+Q+")").addClass("row-light");O.parent("tr").children().addClass("row-light")},mouseleave:function(){x(this).removeClass("td-hover");x(this).parents("table").find(".row-light").removeClass("row-light")},click:function(P){P.stopPropagation();var Q=x(this),S=Q.parents("table"),O=y.find(".select-data");thiscol=Q.parent("tr").children().index(Q);var R=new Date().getFullYear()+"-"+S.find("thead th:eq("+thiscol+")").text();var T=Q.parent("tr").find("th").text();O.html(R+"&nbsp;<strong>"+T+"</strong>");O.removeClass("errorlight highlight");S.removeClass("show")}},"#free-callback td");r.on({click:function(){var W=x(this),U=y.find(".new-cellphone"),X=x.trim(p.phone.val()),O=y.find(".select-data"),R=x.trim(O.text()),T=x("#ref_from").val()=="anjuke"?"anjuke":"site";p.phone=x("#free-callback .c-phone");p.imgCode=x("#free-callback .img-code-int");p.smsCode=x("#free-callback .sms-code-int");p.msgBox=x("#free-callback .msg-box");p.msgText=x("#free-callback .msg-box span");p.isShow=x("#free-callback .j-is-show");var P=x.trim(p.smsCode.val());if(z.phone()&&z.isShowCode()&&z.smsCode()){if(R==H){O.addClass("errorlight");return}O.removeClass("errorlight");var V=R.split("-");V[0]=parseInt(V[0],10);V[1]=parseInt(V[1],10);V[2]=parseInt(V[2],10);V[3]=parseInt(V[3],10);if(V[1]<10){V[1]="0"+V[1]}if(V[2]<10){V[2]="0"+V[2]}var Q=V[0].toString()+V[1].toString()+V[2].toString();var S;if(V[3]==12){S=1}else{if(V[3]==15){S=2}else{S=3}}x.post(G,{phone:J,loupan_id:XF.Vars.loupanId,reserve_day:Q,reserve_range:S,from:T,code:P},function(Y){APF.Utils.setCookie("xf_400_free",J,"","/",l);if(Y.status==1){B.open();c.close();D.find("span").text("恭喜您预约成功！");p.msgBox.eq(2).hide();p.smsCode.removeClass("int-err")}else{if(Y.status==-3){p.msgBox.eq(2).hide();p.smsCode.removeClass("int-err");B.open();c.close();D.find("span").text("您已预约过该楼盘！")}else{if(Y.status==9374){p.smsCode.addClass("int-err");p.msgBox.eq(2).show();p.msgText.eq(2).html(Y.msg)}else{if(Y.status==-1){p.msgBox.eq(2).show();p.msgText.eq(2).html(Y.msg)}}}}},"json")}}},"#free-callback #make-order");r.on({click:function(){x(this).parents(".newcall-entrance").length&&m("fc_mfth_planpage");x(this).parents("#j-freecall").length&&m("fc_mfth_top")}},".make-call1,.make-call2,.make-freecall1,.make-freecall2,.order-callback1,.order-callback2");r.on({click:function(){x(this).is("#do-call")?m("fc_mfth_page2"):m("fc_mfyy_page2")}},"#do-call,#make-order");function m(O){XF.Soj.send("{from:"+O+"}",XF.Soj.param);return true}})(jQuery);(function(h){var F="免费通话";var b="预约回电";var a="预约看房";var s="手机号码不能为空";var r="手机号码格式错误";var g="请输入手机号";var f="请输入您的手机号码";var d="选择您方便接听的时间";var v="/aifang/web/loupan/ajax/phoneconnect/";var B="/aifang/web/loupan/ajax/phonereserve/";var p=h("body");var k=h("#yykf-step-one");var z=h("#yykf-step-two");var x=h("#yykf-callback");var o=h("#yykf-repeat");var c=h("#yykf-result");var j=h("#newcall-entrance");var y=j.find(".new-cellphone");var C=j.find("#enConfirm");var E=APF.Utils.getCookie("xf_400_free");var u=h("#NewCall_domain").val();var n=h("#j-btn-yykf");var D=new Date().getHours();if(D>=8&&D<19){if(E){n.addClass("make-call")}else{n.addClass("make-kfcall")}}else{n.addClass("order-fk-callback")}var m=new XF.Modal({modalClass:"modal-custom new-call",title:a,bd:k,width:"560",height:"400"});var A=new XF.Modal({modalClass:"modal-custom new-call",title:a,bd:z,width:"560",height:"400"});var e=new XF.Modal({modalClass:"modal-custom new-call",title:a,bd:o,width:"560",height:"400"});var l=new XF.Modal({modalClass:"modal-custom new-call",title:b,bd:x,width:"560",height:"400"});var q=new XF.Modal({modalClass:"modal-custom new-call",title:b,bd:c,width:"560",height:"400"});p.on({focus:function(){h(this).addClass("highlight");(h(this).val()==g||h(this).val()==f)&&h(this).val("")},blur:function(){h(this).removeClass("highlight")}},"input.new-cellphone");function w(H){var I=h.trim(H.val()),G=H.parent().find("p.com-msg");if(I==""||I==g||I==f){H.addClass("errorlight");G.show().find("em").text(s);return false}else{if(!XF.Validate.phoneMobile(I)){H.addClass("errorlight");G.show().find("em").text(r);return false}else{E=I;H.removeClass("highlight errorlight");G.hide();return true}}}p.on({click:function(){A.open()}},".make-call");p.on({click:function(){m.open()}},".make-kfcall");p.on({click:function(){var G=h(this),J=k.find(".new-cellphone"),I=h.trim(J.val());var H=w(J);if(H){E=I;m.close();A.open()}}},"#yykf-step-one .do-call");p.on({click:function(){var H=h(".new-call"),G=z.find(".new-cellphone").text();k.find(".new-cellphone").val(G);A.close();m.open()}},"#yykf-step-two .change-cell");h(A).on("openAfter",function(){z.find(".new-cellphone").text(E);h.post(v,{phone:E,loupan_id:XF.Vars.loupanId,ref:XF.Vars.ref,biz_type:"yykf"},function(G){APF.Utils.setCookie("xf_400_free",E,"","/",u);if(G.status==1){o.find(".result-tip span").text("您今天已经拨打本楼盘太多次啦！");A.close();e.open()}if(G.status==2){o.find(".result-tip span").text("您今天已经拨打太多次啦！");A.close();e.open()}},"json")});p.on({click:function(){var G=h.trim(y.val());E&&x.find(".new-cellphone").val(E);if(XF.Validate.phoneMobile(G)){x.find(".new-cellphone").val(G)}l.open()}},".order-fk-callback");p.on({click:function(){h(this).find("table").removeClass("show")}},"#yykf-callback");p.on({click:function(G){G.stopPropagation();h(this).toggleClass("highlight");h(this).next().toggleClass("show")}},"#yykf-callback .select-data");p.on({mouseenter:function(){var G=h(this),H=G.parents("table");var I=G.parent("tr").children().index(G)+1;G.addClass("td-hover");H.find("tr>:nth-child("+I+")").addClass("row-light");G.parent("tr").children().addClass("row-light")},mouseleave:function(){h(this).removeClass("td-hover");h(this).parents("table").find(".row-light").removeClass("row-light")},click:function(H){H.stopPropagation();var I=h(this),K=I.parents("table"),G=x.find(".select-data");thiscol=I.parent("tr").children().index(I);var J=new Date().getFullYear()+"-"+K.find("thead th:eq("+thiscol+")").text();var L=I.parent("tr").find("th").text();G.html(J+"&nbsp;<strong>"+L+"</strong>");G.removeClass("errorlight highlight");K.removeClass("show")}},"#yykf-callback td");p.on({click:function(){var O=h(this),M=x.find(".new-cellphone"),P=h.trim(M.val()),G=x.find(".select-data"),J=h.trim(G.text()),L=h("#ref_from").val()=="anjuke"?"anjuke":"site";var H=w(M);if(H){if(J==d){G.addClass("errorlight");return}G.removeClass("errorlight");var N=J.split("-");N[0]=parseInt(N[0],10);N[1]=parseInt(N[1],10);N[2]=parseInt(N[2],10);N[3]=parseInt(N[3],10);if(N[1]<10){N[1]="0"+N[1]}if(N[2]<10){N[2]="0"+N[2]}var I=N[0]+N[1]+N[2];var K;if(N[3]==12){K=1}else{if(N[3]==15){K=2}else{K=3}}h.post(B,{phone:E,loupan_id:XF.Vars.loupanId,reserve_day:I,reserve_range:K,from:L,biz_type:"yykf"},function(Q){APF.Utils.setCookie("xf_400_free",E,"","/",u);if(Q.status==1){c.find("span").text("恭喜您预约成功！")}else{if(Q.status==-3){c.find("span").text("您已预约过该楼盘！")}}l.close();q.open()},"json")}}},"#yykf-callback #make-yyorder");p.on({click:function(){t("fc_yykf_page")}},".make-call,.make-kfcall,.order-fk-callback");p.on({click:function(){h(this).is("#do-yycall")?t("fc_ljyy_page2"):t("fc_ljyy2_page2")}},"#do-yycall,#make-yyorder");function t(G){XF.Soj.send("{from:"+G+"}",XF.Soj.param);return true}})(jQuery);(function(e){var d=e("#jr-switch-banner"),b=d.find(".promo-nav"),a=b.find(".back-color"),c=b.find("a");var f=new XF.Switch({switchST:d,clipST:".clip",conST:".banner-box",itemST:".banner-item",prevST:"#jr-switch-banner .arrow-pre",nextST:"#jr-switch-banner .arrow-next",pnavST:"#jr-switch-banner .promo-nav a",effect:"fade",event:"click",current:"selected",circle:true,auto:true,interval:5000});if(c.length){a.show();a.width(b.width())}else{a.hide()}})(jQuery);$(function(){var b=$("[data-marker]"),e=(function(){var f={};b.each(function(){var g=$(this);f[g.data("marker")]=g});return f})(),d=location.hash.length>0?location.hash.replace(/^#/,""):location.hash;if(d.length>0&&e[d]){var c=e[d].offset().top,a=$("#j-freecall").outerHeight()-0+20;APF.Utils.setScrollTop(c-a)}});(function(a){a(document).ready(function(){a(".to8toIF").attr("src","http://www.to8to.com/huodong/anjukefang/?to8to_from=12_1_1")})})(jQuery);(function(a){a("#IFX_p3013").on({mouseenter:function(){a(this).addClass("item-hover")},mouseleave:function(){a(this).removeClass("item-hover")},click:function(){var b=a.trim(a(this).data("link"));b&&XF.WindowsOpen.redirect(b)}},".item-mod");a("#IFX_p3013").on("click",".item-mod .favor-pos a,.item-mod .infos a",function(b){b.stopPropagation()})})(jQuery);